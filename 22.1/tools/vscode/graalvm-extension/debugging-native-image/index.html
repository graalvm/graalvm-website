<!DOCTYPE html>
<html lang="en">

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta property="og:image" content='/22.1/resources/img/graalvm.png' />
  <meta name="twitter:widgets:border-color" content="#55acee">

  <title>
    
      GraalVM
    
  </title>
  <meta name="description" content="GraalVM is an advanced JDK with ahead-of-time Native Image compilation."/>

  <link rel="icon" id="favicon" href='/22.1/resources/img/favicon/favicon-light/favicon-light.ico'>

  <link rel="manifest" href='/22.1/resources/img/favicon/site.webmanifest'>
  <meta name="msapplication-TileColor" content="#da532c">
  <meta name="theme-color" content="#ffffff">

  <script src='/22.1/resources/lib/jquery/jquery-3.6.1.min.js'></script>
  <link rel="stylesheet" href='/22.1/assets/main.css'>
  <script src='/22.1/resources/lib/bootstrap/js/bootstrap.min.js'></script>
  <script src='/22.1/resources/lib/highlight/highlight.pack.js'></script>
  <script src='/22.1/resources/lib/purl/purl.js'></script>
  <script src='/22.1/resources/lib/fiddle/fiddle.js' defer></script>
  <link rel="stylesheet" href='/22.1/resources/styles/fiddle.css'>
  <script async defer src="https://buttons.github.io/buttons.js"></script>
</head>

  <body class="preload">

    <div>
      <header  class="header header--content"  role="banner">

  

  <div class="container-fluid container-fluid--custom-sm">
    <div class="row">
      <div class="col-12 col-sm-12 col-md-12 col-lg-10">
        <div class="d-flex">
          <a href="https://www.graalvm.org/">
            <img src='/22.1/resources/img/logo_header.svg' alt="GraalVM logo">
          </a>  
        </div>
      </div>
    </div>
  </div>
  <div class="">
    <div class="row">
      <div class="docsnote">
        <div class="docsnote__body">
          <div class="docsnote__column">
            <div class="docsnote__card">
              <div class="container">
                <div class="rightside">
                  <img src='/22.1/resources/img/note-icon-docs-light.svg'>
                  <p class="docsnote__subtitle">This documentation is for an old GraalVM version. See the <a href="https://www.graalvm.org/latest/docs/">latest version</a>.</p>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</header>
      <main class="content content--home wrapper" aria-label="Content">
        <div class="container-fluid container-fluid--custom-sm">
  <div class="row">
    <div class="col-12 col-sm-12 col-md-12 col-lg-10 offset-lg-1">
      <br>
      <a href="/22.1/" class="link-back"><i>&#9664;</i>Table of Contents</a>

      <h1 id="debug-native-images-in-vs-code">Debug Native Images in VS Code</h1>

<p>You can debug a native executable generated by GraalVM Native Image from the command line with the GNU Debugger, or from within Visual Studio Code (VS Code) by means of the <a href="https://marketplace.visualstudio.com/items?itemName=oracle-labs-graalvm.graalvm">GraalVM Tools for Java extension</a>.</p>

<p>In this guide you will learn how to debug a Java application compiled into a native executable from VS Code.</p>

<p>To learn how to debug Java from GDB, see the dedicated <a href="/22.1/reference-manual/native-image/DebugInfo/">Native Image Debug Info Feature reference manual</a>.</p>

<h2 id="introduction">Introduction</h2>

<p>You can debug a native image process the same way as debugging a regular Java application: when your native executable is running, the debugger attaches to the application process, the Java source file is opened, letting you debug it. You can perform regular debugging actions like setting breakpoints, creating watches, inspecting the state of your application, etc.
Debugger attachment is enabled by adding a separate configuration, <strong>Native Image: launch</strong>, to the <code>launch.json</code> file.</p>

<blockquote>
  <p>Note: To debug a native image from within VS Code, you must install GraalVM Enterprise.</p>
</blockquote>

<h3 id="prerequisities">Prerequisities</h3>

<ol>
  <li>Linux OS with GDB 10.1</li>
  <li><a href="https://code.visualstudio.com/">VS Code</a></li>
  <li><a href="https://marketplace.visualstudio.com/items?itemName=oracle-labs-graalvm.graalvm-pack">GraalVM Extension Pack for Java</a> installed in VS Code</li>
  <li><a href="https://www.graalvm.org/downloads">GraalVM Enterprise</a>, <a href="/22.1/tools/vscode/graalvm-extension/#graalvm-installation-wizard">set as a default Java runtime environment in VS Code</a></li>
  <li><a href="/22.1/reference-manual/native-image/">Native Image plugin</a> added to GraalVM’s installation</li>
</ol>

<h2 id="create-and-build-the-demo">Create and Build the Demo</h2>

<p>The demo is a simple Java factorial calculator that uses the <a href="https://graalvm.github.io/native-build-tools/latest/index.html">Native Build Tools for GraalVM Native Image</a>, which provides support for building and testing native executables using Apache Maven™ and Gradle.</p>

<p>The Maven <code>pom.xml</code> file is extended with a native profile, which makes building a native executable easier (read more about Maven Profiles <a href="https://maven.apache.org/guides/introduction/introduction-to-profiles.html">here</a>).
To add debug information, the <code>&lt;buildArg&gt;</code> tags are used in the native profile configuration to pass parameters to the <code>native-image</code> build process:</p>

<pre><code class="language-xml"> &lt;buildArg&gt;-g&lt;/buildArg&gt;
 &lt;buildArg&gt;-O0&lt;/buildArg&gt;
</code></pre>

<p>The <code>-g</code> flag instructs <code>native-image</code> to generate debug information in a format the GNU Debugger (GDB) understands.
Then <code>-O0</code> specifies that no compiler optimizations should be performed.
Disabling all optimizations is not required, but in general it makes the debugging experience better.</p>

<ol>
  <li>
    <p>Clone the <a href="https://github.com/graalvm/graalvm-demos">demos repository from GitHub</a> and open the <code>javagdbnative</code> folder in VS Code:</p>

    <pre><code> git clone https://github.com/graalvm/graalvm-demos.git
</code></pre>
  </li>
  <li>
    <p>In VS Code, open <strong>Terminal</strong>, then click <strong>New Terminal</strong>, and run following command:</p>

    <pre><code class="language-shell"> mvn -Pnative -DskipTests package
</code></pre>
    <p>This command compiles and packages a Java application into a runnable JAR file and then uses GraalVM Native Image to generate a native executable from it.
 Once you have your executable with debug symbols generated, the next step is to add the Native Image debugger configuration, <strong>Native Image: launch</strong>, into the <code>launch.json</code> file in VS Code.</p>
  </li>
  <li>
    <p>Select <strong>Run Add Configuration…</strong> and then select <strong>Native Image: Launch</strong> from the list of available configurations. It will add the following code to <code>launch.json</code>:</p>

    <pre><code class="language-JSON"> {
 “type”: “nativeimage”,
 “request”: “launch”,
 “name”: “Launch Native Image”,
 “nativeImagePath”: “${workspaceFolder}/build/native-image/application”
 }
</code></pre>
    <p>The value of the <code>nativeImagePath</code> property has to match the executable name and the location specified in the <code>pom.xml</code>, so change the last line of the configuration to <code>"nativeImagePath": "${workspaceFolder}/target/javagdb"</code>.</p>
  </li>
  <li>
    <p>Add an argument to specify the number that you want to calculate the factorial, for example, <code>“args”: “100”</code>. Your configuration should look like this:</p>
    <pre><code class="language-JSON"> {
 “type”: “nativeimage”,
 “request”: “launch”,
 “name”: “Launch Native Image”,
 “nativeImagePath”: “${workspaceFolder}/target/javagdb”,
 “args”: “100”
 }
</code></pre>
  </li>
</ol>

<h2 id="run-and-debug-the-demo">Run and Debug the Demo</h2>

<p>To run the application in debug mode, first set a breakpoint in the source code.
Then go to the <strong>Run and Debug</strong> activity in the top navigation panel, select <strong>Launch Native Image</strong> and click the green arrow to run this configuration.
VS Code will execute your native executable, attach to the application process, open the Java source file, letting you debug it.
You step over the code, explore local variables, specify expressions to be evaluated, etc.
Everything you can do when debugging a Java application from an IDE.</p>

<p><img src="/22.1/docs/tools/vscode/graalvm/images/debugging_ni_vscode.png" alt="Native Image debugging source code" /></p>

<p>Notice that some code is greyed out in the source file. For example, the method <code>neverCalledMethod()</code>:</p>

<p><img src="/22.1/docs/tools/vscode/graalvm/images/uncalled_method.png" alt="Uncalled method greyed out" /></p>

<p>The <code>native-image</code> builder removes the code that is not used by the application at run time.
This could be some uncalled library or some unreachable methods.
The VS Code extension recognises these elimitations and will grey out both the body of eliminated method and the method call.
The shaded code is not a part of the native executable.</p>

<h3 id="learn-more">Learn More</h3>

<p>Read more about <a href="/22.1/reference-manual/native-image/DebugInfo/">Debug Info Feature in Native Image</a>.</p>

      </div>
  </div>
</div>
      </main>
      <footer class="footer footer__mobile">
  <div class="container-fluid container-fluid--custom-sm">
    <div class="row footer-content">
      <div class="footer__columns">
        <div class="footer__columns-item">
          <h6 class="title-footer" onclick="fadeInAndOut(this)">API Documentation</h6>
          <div class="grow">
            <ul class="footer-list">
              <li class="footer-list__item"><a href="https://www.graalvm.org/sdk/javadoc/">GraalVM SDK Javadoc</a></li>
              <li class="footer-list__item"><a href="https://www.graalvm.org/truffle/javadoc/">GraalVM Truffle Javadoc</a></li>
            </ul>
          </div>
        </div>
        <div class="footer__columns-item">
          <h6 class="title-footer" onclick="fadeInAndOut(this)">Learn More</h6>
          <div class="grow">
            <ul class="footer-list">
              <li class="footer-list__item"><a href="https://github.com/oracle/graal/" target="_blank">Open Source Repository</a></li>
              <li class="footer-list__item"><a href="https://www.graalvm.org/release-notes/" target="_blank">Release notes</a></li>
              <li class="footer-list__item"><a href="https://github.com/graalvm/graalvm-demos/"
                  target="_blank">Demos</a></li>
              <li class="footer-list__item"><a href="https://medium.com/graalvm" target="_blank">Blog</a></li>
            </ul>
          </div>
        </div>
      </div>
    </div>
    <div class="col-12 col-sm-12 col-md-12 col-lg-12">
      <div class="row">
        <div class="col-sm-12">
          <p class="copyright">
            Copyright © 2024, Oracle and/or its affiliates. All rights reserved. Oracle and Java are registered trademarks. Other names may be trademarks of their respective owners.
          </p>
        </div>
      </div>
    </div>
  </div>
</footer>

<script>
  function fadeInAndOut(thz) {
    var elmt = thz.nextElementSibling;//Get the element that is below the button that
    //was just clicked
    if (elmt.clientHeight) {
      elmt.style.height = 0;
    } else {
      var wrapper = elmt.querySelector('ul');
      elmt.style.height = wrapper.clientHeight + "px";
    }
  }
</script>

    </div>

    <div class="overlay"></div>

    <script src='/22.1/resources/js/main.js'></script>
  </body>

</html>
