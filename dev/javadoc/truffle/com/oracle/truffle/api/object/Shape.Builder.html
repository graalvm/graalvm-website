<!DOCTYPE HTML>
<html lang="en">
<head>
<!-- Generated by javadoc (26) -->
<title>Shape.Builder (GraalVM Truffle Java API Reference)</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="declaration: package: com.oracle.truffle.api.object, class: Shape, class: Builder">
<meta name="generator" content="javadoc/ClassWriter">
<link rel="stylesheet" type="text/css" href="../../../../../resource-files/jquery-ui.min.css">
<link rel="stylesheet" type="text/css" href="../../../../../resource-files/stylesheet.css">
<script type="text/javascript" src="../../../../../script-files/script.js"></script>
<script type="text/javascript" src="../../../../../script-files/jquery-3.7.1.min.js"></script>
<script type="text/javascript" src="../../../../../script-files/jquery-ui.min.js"></script>
</head>
<body class="class-declaration-page">
<script type="text/javascript">const pathtoroot = "../../../../../";
loadScripts(document, 'script');</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<header role="banner">
<nav role="navigation">
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="top-nav" id="navbar-top">
<div class="nav-content">
<div class="nav-menu-button"><button id="navbar-toggle-button" aria-controls="navbar-top" aria-expanded="false" aria-label="Toggle navigation links"><span class="nav-bar-toggle-icon">&nbsp;</span><span class="nav-bar-toggle-icon">&nbsp;</span><span class="nav-bar-toggle-icon">&nbsp;</span></button></div>
<div class="skip-nav"><a href="#skip-navbar-top" title="Skip navigation links">Skip navigation links</a></div>
<ul id="navbar-top-firstrow" class="nav-list" title="Navigation">
<li><a href="../../../../../index.html">Overview</a></li>
<li class="nav-bar-cell1-rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../index-all.html">Index</a></li>
<li><a href="../../../../../search.html">Search</a></li>
<li><a href="../../../../../help-doc.html#class">Help</a></li>
</ul>
<div class="about-language"><b>GraalVM Truffle Java API Reference<br>26.0.0-dev</b><br>e06f091d4329e96db73aaa0c9be6e2856bc4afba</div>
</div>
</div>
<div class="sub-nav">
<div class="nav-content">
<ol class="sub-nav-list">
<li><a href="package-summary.html">com.oracle.truffle.api.object</a></li>
<li><a href="Shape.html">Shape</a></li>
<li><a href="Shape.Builder.html" class="current-selection">Builder</a></li>
</ol>
<div class="nav-list-search"><input type="text" id="search-input" disabled placeholder="Search documentation (type /)" aria-label="Search in documentation" autocomplete="off" spellcheck="false"><input type="reset" id="reset-search" disabled value="Reset"></div>
</div>
</div>
<!-- ========= END OF TOP NAVBAR ========= -->
<span class="skip-nav" id="skip-navbar-top"></span></nav>
</header>
<div class="main-grid">
<nav role="navigation" class="toc" aria-label="Table of contents">
<div class="toc-header">Contents&nbsp;<input type="text" class="filter-input" disabled placeholder="Filter contents (type .)" aria-label="Filter table of contents" autocomplete="off" spellcheck="false"><input type="reset" class="reset-filter" disabled tabindex="-1" value="Reset"></div>
<ol class="toc-list" tabindex="-1">
<li><a href="#" tabindex="0">Description</a></li>
<li><a href="#method-summary" tabindex="0">Method Summary</a></li>
<li><a href="#method-detail" tabindex="0">Method Details</a>
<ol class="toc-list">
<li><a href="#layout(java.lang.Class)" tabindex="0">layout(Class)</a></li>
<li><a href="#layout(java.lang.Class,java.lang.invoke.MethodHandles.Lookup)" tabindex="0">layout(Class, MethodHandles.Lookup)</a></li>
<li><a href="#dynamicType(java.lang.Object)" tabindex="0">dynamicType(Object)</a></li>
<li><a href="#shapeFlags(int)" tabindex="0">shapeFlags(int)</a></li>
<li><a href="#shared(boolean)" tabindex="0">shared(boolean)</a></li>
<li><a href="#propertyAssumptions(boolean)" tabindex="0">propertyAssumptions(boolean)</a></li>
<li><a href="#sharedData(java.lang.Object)" tabindex="0">sharedData(Object)</a></li>
<li><a href="#singleContextAssumption(com.oracle.truffle.api.Assumption)" tabindex="0">singleContextAssumption(Assumption)</a></li>
<li><a href="#addConstantProperty(java.lang.Object,java.lang.Object,int)" tabindex="0">addConstantProperty(Object, Object, int)</a></li>
<li><a href="#allowImplicitCastIntToLong(boolean)" tabindex="0">allowImplicitCastIntToLong(boolean)</a></li>
<li><a href="#allowImplicitCastIntToDouble(boolean)" tabindex="0">allowImplicitCastIntToDouble(boolean)</a></li>
<li><a href="#build()" tabindex="0">build()</a></li>
</ol>
</li>
</ol>
<button class="hide-sidebar"><span>Hide sidebar&nbsp;</span><img src="../../../../../resource-files/left.svg" alt="Hide sidebar"></button><button class="show-sidebar"><img src="../../../../../resource-files/right.svg" alt="Show sidebar"><span>&nbsp;Show sidebar</span></button></nav>
<main role="main">
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<h1 title="Class Shape.Builder" class="title">Class Shape.Builder</h1>
</div>
<div class="inheritance" title="Inheritance Tree"><a href="https://docs.oracle.com/en/java/javase/26/docs/api/java.base/java/lang/Object.html" title="class or interface in java.lang" class="external-link">java.lang.Object</a>
<div class="inheritance">com.oracle.truffle.api.object.Shape.Builder</div>
</div>
<section class="class-description" id="class-description">
<dl class="notes">
<dt>Enclosing class:</dt>
<dd><code><a href="Shape.html" title="class in com.oracle.truffle.api.object">Shape</a></code></dd>
</dl>
<hr>
<div class="horizontal-scroll">
<div class="type-signature"><span class="modifiers">public static final class </span><span class="element-name type-name-label">Shape.Builder</span>
<span class="extends-implements">extends <a href="https://docs.oracle.com/en/java/javase/26/docs/api/java.base/java/lang/Object.html" title="class or interface in java.lang" class="external-link">Object</a></span></div>
<div class="block">Builder class to construct initial <a href="Shape.html" title="class in com.oracle.truffle.api.object"><code>Shape</code></a> instances.

The builder instance is not thread-safe and must not be used from multiple threads at the
same time.</div>
<dl class="notes">
<dt>Since:</dt>
<dd>20.2.0</dd>
<dt>See Also:</dt>
<dd>
<ul class="tag-list">
<li><a href="Shape.html#newBuilder()"><code>Shape.newBuilder()</code></a></li>
</ul>
</dd>
</dl>
</div>
</section>
<section class="summary">
<ul class="summary-list">
<!-- ========== METHOD SUMMARY =========== -->
<li>
<section class="method-summary" id="method-summary">
<h2>Method Summary</h2>
<div id="method-summary-table">
<div class="table-tabs" role="tablist" aria-orientation="horizontal"><button id="method-summary-table-tab0" role="tab" aria-selected="true" aria-controls="method-summary-table.tabpanel" tabindex="0" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table', 3)" class="active-table-tab">All Methods</button><button id="method-summary-table-tab2" role="tab" aria-selected="false" aria-controls="method-summary-table.tabpanel" tabindex="-1" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table-tab2', 3)" class="table-tab">Instance Methods</button><button id="method-summary-table-tab4" role="tab" aria-selected="false" aria-controls="method-summary-table.tabpanel" tabindex="-1" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table-tab4', 3)" class="table-tab">Concrete Methods</button><button id="method-summary-table-tab6" role="tab" aria-selected="false" aria-controls="method-summary-table.tabpanel" tabindex="-1" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table-tab6', 3)" class="table-tab">Deprecated Methods</button></div>
<div id="method-summary-table.tabpanel" role="tabpanel" aria-labelledby="method-summary-table-tab0">
<div class="summary-table three-column-summary">
<div class="table-header col-first">Modifier and Type</div>
<div class="table-header col-second">Method</div>
<div class="table-header col-last">Description</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="Shape.Builder.html" title="class in com.oracle.truffle.api.object">Shape.Builder</a></code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#addConstantProperty(java.lang.Object,java.lang.Object,int)" class="member-name-link">addConstantProperty</a><wbr>(<a href="https://docs.oracle.com/en/java/javase/26/docs/api/java.base/java/lang/Object.html" title="class or interface in java.lang" class="external-link">Object</a>&nbsp;key,
 <a href="https://docs.oracle.com/en/java/javase/26/docs/api/java.base/java/lang/Object.html" title="class or interface in java.lang" class="external-link">Object</a>&nbsp;value,
 int&nbsp;flags)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Adds a property with a constant value to the shape.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="Shape.Builder.html" title="class in com.oracle.truffle.api.object">Shape.Builder</a></code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#allowImplicitCastIntToDouble(boolean)" class="member-name-link">allowImplicitCastIntToDouble</a><wbr>(boolean&nbsp;allow)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Allows values to be implicitly cast from int to double in this shape and any derived
shapes.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="Shape.Builder.html" title="class in com.oracle.truffle.api.object">Shape.Builder</a></code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#allowImplicitCastIntToLong(boolean)" class="member-name-link">allowImplicitCastIntToLong</a><wbr>(boolean&nbsp;allow)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Allows values to be implicitly cast from int to long in this shape and any derived
shapes.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="Shape.html" title="class in com.oracle.truffle.api.object">Shape</a></code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#build()" class="member-name-link">build</a>()</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Builds a new shape using the configuration of this builder.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="Shape.Builder.html" title="class in com.oracle.truffle.api.object">Shape.Builder</a></code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#dynamicType(java.lang.Object)" class="member-name-link">dynamicType</a><wbr>(<a href="https://docs.oracle.com/en/java/javase/26/docs/api/java.base/java/lang/Object.html" title="class or interface in java.lang" class="external-link">Object</a>&nbsp;dynamicType)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Sets initial dynamic object type identifier.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4 method-summary-table-tab6"><code><a href="Shape.Builder.html" title="class in com.oracle.truffle.api.object">Shape.Builder</a></code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4 method-summary-table-tab6"><code><a href="#layout(java.lang.Class)" class="member-name-link">layout</a><wbr>(<a href="https://docs.oracle.com/en/java/javase/26/docs/api/java.base/java/lang/Class.html" title="class or interface in java.lang" class="external-link">Class</a>&lt;? extends <a href="DynamicObject.html" title="class in com.oracle.truffle.api.object">DynamicObject</a>&gt;&nbsp;layoutClass)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4 method-summary-table-tab6">
<div class="block"><span class="deprecated-label">Deprecated.</span>
<div class="deprecation-comment">Use <a href="#layout(java.lang.Class,java.lang.invoke.MethodHandles.Lookup)"><code>layout(Class, MethodHandles.Lookup)</code></a> instead.</div>
</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="Shape.Builder.html" title="class in com.oracle.truffle.api.object">Shape.Builder</a></code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#layout(java.lang.Class,java.lang.invoke.MethodHandles.Lookup)" class="member-name-link">layout</a><wbr>(<a href="https://docs.oracle.com/en/java/javase/26/docs/api/java.base/java/lang/Class.html" title="class or interface in java.lang" class="external-link">Class</a>&lt;? extends <a href="DynamicObject.html" title="class in com.oracle.truffle.api.object">DynamicObject</a>&gt;&nbsp;layoutClass,
 <a href="https://docs.oracle.com/en/java/javase/26/docs/api/java.base/java/lang/invoke/MethodHandles.Lookup.html" title="class or interface in java.lang.invoke" class="external-link">MethodHandles.Lookup</a>&nbsp;layoutClassLookup)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Sets a custom object layout class (default: <code><a href="DynamicObject.html" title="class in com.oracle.truffle.api.object"><code>DynamicObject</code></a>.class</code>) and
a corresponding <a href="https://docs.oracle.com/en/java/javase/26/docs/api/java.base/java/lang/invoke/MethodHandles.Lookup.html" title="class or interface in java.lang.invoke" class="external-link"><code>MethodHandles.Lookup</code></a> created by the layout class, or a class in
the same module, that has full privilege access in order to provide access to its fields.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="Shape.Builder.html" title="class in com.oracle.truffle.api.object">Shape.Builder</a></code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#propertyAssumptions(boolean)" class="member-name-link">propertyAssumptions</a><wbr>(boolean&nbsp;enable)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">If <code>true</code>, enables the use of <a href="Shape.html#getPropertyAssumption(java.lang.Object)">property assumptions</a> for this object shape and any derived shapes (default:
<code>false</code>).</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="Shape.Builder.html" title="class in com.oracle.truffle.api.object">Shape.Builder</a></code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#shapeFlags(int)" class="member-name-link">shapeFlags</a><wbr>(int&nbsp;flags)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Sets initial shape flags (default: 0).</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="Shape.Builder.html" title="class in com.oracle.truffle.api.object">Shape.Builder</a></code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#shared(boolean)" class="member-name-link">shared</a><wbr>(boolean&nbsp;isShared)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">If <code>true</code>, makes the object shared (default: <code>false</code>).</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="Shape.Builder.html" title="class in com.oracle.truffle.api.object">Shape.Builder</a></code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#sharedData(java.lang.Object)" class="member-name-link">sharedData</a><wbr>(<a href="https://docs.oracle.com/en/java/javase/26/docs/api/java.base/java/lang/Object.html" title="class or interface in java.lang" class="external-link">Object</a>&nbsp;sharedData)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Sets shared data to be associated with the root shape and any derived shapes (e.g.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="Shape.Builder.html" title="class in com.oracle.truffle.api.object">Shape.Builder</a></code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#singleContextAssumption(com.oracle.truffle.api.Assumption)" class="member-name-link">singleContextAssumption</a><wbr>(<a href="../Assumption.html" title="interface in com.oracle.truffle.api">Assumption</a>&nbsp;assumption)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Sets an assumption that allows specializations on constant object instances with this
shape, as long as the assumption is valid.</div>
</div>
</div>
</div>
</div>
<div class="inherited-list">
<h3 id="methods-inherited-from-class-java.lang.Object">Methods inherited from class&nbsp;<a href="https://docs.oracle.com/en/java/javase/26/docs/api/java.base/java/lang/Object.html#method-summary" title="class or interface in java.lang" class="external-link">Object</a></h3>
<code><a href="https://docs.oracle.com/en/java/javase/26/docs/api/java.base/java/lang/Object.html#clone()" title="class or interface in java.lang" class="external-link">clone</a>, <a href="https://docs.oracle.com/en/java/javase/26/docs/api/java.base/java/lang/Object.html#equals(java.lang.Object)" title="class or interface in java.lang" class="external-link">equals</a>, <a href="https://docs.oracle.com/en/java/javase/26/docs/api/java.base/java/lang/Object.html#finalize()" title="class or interface in java.lang" class="external-link">finalize</a>, <a href="https://docs.oracle.com/en/java/javase/26/docs/api/java.base/java/lang/Object.html#getClass()" title="class or interface in java.lang" class="external-link">getClass</a>, <a href="https://docs.oracle.com/en/java/javase/26/docs/api/java.base/java/lang/Object.html#hashCode()" title="class or interface in java.lang" class="external-link">hashCode</a>, <a href="https://docs.oracle.com/en/java/javase/26/docs/api/java.base/java/lang/Object.html#notify()" title="class or interface in java.lang" class="external-link">notify</a>, <a href="https://docs.oracle.com/en/java/javase/26/docs/api/java.base/java/lang/Object.html#notifyAll()" title="class or interface in java.lang" class="external-link">notifyAll</a>, <a href="https://docs.oracle.com/en/java/javase/26/docs/api/java.base/java/lang/Object.html#toString()" title="class or interface in java.lang" class="external-link">toString</a>, <a href="https://docs.oracle.com/en/java/javase/26/docs/api/java.base/java/lang/Object.html#wait()" title="class or interface in java.lang" class="external-link">wait</a>, <a href="https://docs.oracle.com/en/java/javase/26/docs/api/java.base/java/lang/Object.html#wait(long)" title="class or interface in java.lang" class="external-link">wait</a>, <a href="https://docs.oracle.com/en/java/javase/26/docs/api/java.base/java/lang/Object.html#wait(long,int)" title="class or interface in java.lang" class="external-link">wait</a></code></div>
</section>
</li>
</ul>
</section>
<section class="details">
<ul class="details-list">
<!-- ============ METHOD DETAIL ========== -->
<li>
<section class="method-details" id="method-detail">
<h2>Method Details</h2>
<ul class="member-list">
<li>
<section class="detail" id="layout(java.lang.Class)">
<h3>layout</h3>
<div class="horizontal-scroll">
<div class="member-signature"><span class="annotations"><a href="https://docs.oracle.com/en/java/javase/26/docs/api/java.base/java/lang/Deprecated.html" title="class or interface in java.lang" class="external-link">@Deprecated</a>(<a href="https://docs.oracle.com/en/java/javase/26/docs/api/java.base/java/lang/Deprecated.html#since()" title="class or interface in java.lang" class="external-link">since</a>="24.2")
</span><span class="modifiers">public</span>&nbsp;<span class="return-type"><a href="Shape.Builder.html" title="class in com.oracle.truffle.api.object">Shape.Builder</a></span>&nbsp;<span class="element-name">layout</span><wbr><span class="parameters">(<a href="https://docs.oracle.com/en/java/javase/26/docs/api/java.base/java/lang/Class.html" title="class or interface in java.lang" class="external-link">Class</a>&lt;? extends <a href="DynamicObject.html" title="class in com.oracle.truffle.api.object">DynamicObject</a>&gt;&nbsp;layoutClass)</span></div>
<div class="deprecation-block"><span class="deprecated-label">Deprecated.</span>
<div class="deprecation-comment">Use <a href="#layout(java.lang.Class,java.lang.invoke.MethodHandles.Lookup)"><code>layout(Class, MethodHandles.Lookup)</code></a> instead.</div>
</div>
<div class="block">Sets custom object layout class (default: <a href="DynamicObject.html" title="class in com.oracle.truffle.api.object"><code>DynamicObject</code></a> base class).

Enables the use of dynamic object fields declared in subclasses using the
<code>DynamicField</code> annotation.

<p>
Examples:

<pre>
<code>
public class MyObject extends DynamicObject implements TruffleObject {

    &#64;DynamicField private Object _obj1;
    &#64;DynamicField private Object _obj2;
    &#64;DynamicField private long _long1;
    &#64;DynamicField private long _long2;

    public MyObject(Shape shape) {
        super(shape);
    }
}


Shape myObjShape = Shape.newBuilder().layout(MyObject.class).build();
MyObject obj = new MyObject(myObjShape);
</code>
</pre></div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>layoutClass</code> - custom object layout class</dd>
<dt>Since:</dt>
<dd>20.2.0</dd>
</dl>
</div>
</section>
</li>
<li>
<section class="detail" id="layout(java.lang.Class,java.lang.invoke.MethodHandles.Lookup)">
<h3>layout</h3>
<div class="horizontal-scroll">
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type"><a href="Shape.Builder.html" title="class in com.oracle.truffle.api.object">Shape.Builder</a></span>&nbsp;<span class="element-name">layout</span><wbr><span class="parameters">(<a href="https://docs.oracle.com/en/java/javase/26/docs/api/java.base/java/lang/Class.html" title="class or interface in java.lang" class="external-link">Class</a>&lt;? extends <a href="DynamicObject.html" title="class in com.oracle.truffle.api.object">DynamicObject</a>&gt;&nbsp;layoutClass,
 <a href="https://docs.oracle.com/en/java/javase/26/docs/api/java.base/java/lang/invoke/MethodHandles.Lookup.html" title="class or interface in java.lang.invoke" class="external-link">MethodHandles.Lookup</a>&nbsp;layoutClassLookup)</span></div>
<div class="block">Sets a custom object layout class (default: <code><a href="DynamicObject.html" title="class in com.oracle.truffle.api.object"><code>DynamicObject</code></a>.class</code>) and
a corresponding <a href="https://docs.oracle.com/en/java/javase/26/docs/api/java.base/java/lang/invoke/MethodHandles.Lookup.html" title="class or interface in java.lang.invoke" class="external-link"><code>MethodHandles.Lookup</code></a> created by the layout class, or a class in
the same module, that has full privilege access in order to provide access to its fields.
<p>
Enables the allocation of any additional <code>DynamicField</code>-annotated fields declared
in the <a href="DynamicObject.html" title="class in com.oracle.truffle.api.object"><code>DynamicObject</code></a> layout subclass as storage locations. By default, only
extension array based storage locations in the <a href="DynamicObject.html" title="class in com.oracle.truffle.api.object"><code>DynamicObject</code></a> base class are used.
<p>
Also restricts the shape to a specific <a href="DynamicObject.html" title="class in com.oracle.truffle.api.object"><code>DynamicObject</code></a> subclass and subclasses
thereof, i.e. shapes created for a <a href="DynamicObject.html" title="class in com.oracle.truffle.api.object"><code>DynamicObject</code></a> layout subclass, and any derived
shapes, can only be used to instantiate, and be assigned to, instances of that class
(regardless of whether the class actually contains any dynamic fields).

<p>
Example:

<pre>
<code>
public class MyObject extends DynamicObject implements TruffleObject {

    &#64;DynamicField private Object _obj1;
    &#64;DynamicField private Object _obj2;
    &#64;DynamicField private long _long1;
    &#64;DynamicField private long _long2;

    public MyObject(Shape shape) {
        super(shape);
    }

    static MethodHandles.Lookup lookup() {
        return MethodHandles.lookup();
    }
}


Shape myObjShape = Shape.newBuilder().layout(MyObject.class, MyObject.lookup()).build();
MyObject obj = new MyObject(myObjShape);
</code>
</pre></div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>layoutClass</code> - a <a href="DynamicObject.html" title="class in com.oracle.truffle.api.object"><code>DynamicObject</code></a> layout subclass or the default
           <code><a href="DynamicObject.html" title="class in com.oracle.truffle.api.object"><code>DynamicObject</code></a>.class</code>.</dd>
<dd><code>layoutClassLookup</code> - a <a href="https://docs.oracle.com/en/java/javase/26/docs/api/java.base/java/lang/invoke/MethodHandles.Lookup.html" title="class or interface in java.lang.invoke" class="external-link"><code>MethodHandles.Lookup</code></a> that has full privilege access, created using
           <a href="https://docs.oracle.com/en/java/javase/26/docs/api/java.base/java/lang/invoke/MethodHandles.html#lookup()" title="class or interface in java.lang.invoke" class="external-link"><code>MethodHandles.lookup()</code></a>, either by the layout class itself, or a class
           in the same module. If <code>layoutClass == DynamicObject.class</code>, and
           only then, this parameter is ignored and may be <code>null</code>.</dd>
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/26/docs/api/java.base/java/lang/IllegalArgumentException.html" title="class or interface in java.lang" class="external-link">IllegalArgumentException</a></code> - if <code>layoutClass != DynamicObject.class</code> and
            the lookup does not have <a href="https://docs.oracle.com/en/java/javase/26/docs/api/java.base/java/lang/invoke/MethodHandles.Lookup.html#hasFullPrivilegeAccess()" title="class or interface in java.lang.invoke" class="external-link"><code>full privilege access</code></a> or is not from the layout class or a class within the
            same module as the layout class.</dd>
<dd><code><a href="https://docs.oracle.com/en/java/javase/26/docs/api/java.base/java/lang/NullPointerException.html" title="class or interface in java.lang" class="external-link">NullPointerException</a></code> - if <code>layoutClass == null</code>, or
            <code>lookup == null</code> and
            <code>layoutClass != <a href="DynamicObject.html" title="class in com.oracle.truffle.api.object"><code>DynamicObject</code></a>.class</code>.</dd>
<dt>Since:</dt>
<dd>24.2.0</dd>
</dl>
</div>
</section>
</li>
<li>
<section class="detail" id="dynamicType(java.lang.Object)">
<h3>dynamicType</h3>
<div class="horizontal-scroll">
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type"><a href="Shape.Builder.html" title="class in com.oracle.truffle.api.object">Shape.Builder</a></span>&nbsp;<span class="element-name">dynamicType</span><wbr><span class="parameters">(<a href="https://docs.oracle.com/en/java/javase/26/docs/api/java.base/java/lang/Object.html" title="class or interface in java.lang" class="external-link">Object</a>&nbsp;dynamicType)</span></div>
<div class="block">Sets initial dynamic object type identifier.

See <a href="DynamicObjectLibrary.html#setDynamicType(com.oracle.truffle.api.object.DynamicObject,java.lang.Object)"><code>DynamicObjectLibrary.setDynamicType(DynamicObject, Object)</code></a> for more
information.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>dynamicType</code> - a non-null object type identifier</dd>
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/26/docs/api/java.base/java/lang/NullPointerException.html" title="class or interface in java.lang" class="external-link">NullPointerException</a></code> - if the type is <code>null</code></dd>
<dt>Since:</dt>
<dd>20.2.0</dd>
<dt>See Also:</dt>
<dd>
<ul class="tag-list-long">
<li><a href="DynamicObjectLibrary.html#getDynamicType(com.oracle.truffle.api.object.DynamicObject)"><code>DynamicObjectLibrary.getDynamicType(DynamicObject)</code></a></li>
<li><a href="DynamicObjectLibrary.html#setDynamicType(com.oracle.truffle.api.object.DynamicObject,java.lang.Object)"><code>DynamicObjectLibrary.setDynamicType(DynamicObject, Object)</code></a></li>
</ul>
</dd>
</dl>
</div>
</section>
</li>
<li>
<section class="detail" id="shapeFlags(int)">
<h3>shapeFlags</h3>
<div class="horizontal-scroll">
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type"><a href="Shape.Builder.html" title="class in com.oracle.truffle.api.object">Shape.Builder</a></span>&nbsp;<span class="element-name">shapeFlags</span><wbr><span class="parameters">(int&nbsp;flags)</span></div>
<div class="block">Sets initial shape flags (default: 0). Currently limited to 16 bits.

See <a href="DynamicObjectLibrary.html#setShapeFlags(com.oracle.truffle.api.object.DynamicObject,int)"><code>DynamicObjectLibrary.setShapeFlags(DynamicObject, int)</code></a> for more information.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>flags</code> - an int value in the range from 0 to 65535 (inclusive)</dd>
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/26/docs/api/java.base/java/lang/IllegalArgumentException.html" title="class or interface in java.lang" class="external-link">IllegalArgumentException</a></code> - if the flags value is not in the supported range</dd>
<dt>Since:</dt>
<dd>20.2.0</dd>
<dt>See Also:</dt>
<dd>
<ul class="tag-list-long">
<li><a href="DynamicObjectLibrary.html#getShapeFlags(com.oracle.truffle.api.object.DynamicObject)"><code>DynamicObjectLibrary.getShapeFlags(DynamicObject)</code></a></li>
<li><a href="DynamicObjectLibrary.html#setShapeFlags(com.oracle.truffle.api.object.DynamicObject,int)"><code>DynamicObjectLibrary.setShapeFlags(DynamicObject, int)</code></a></li>
</ul>
</dd>
</dl>
</div>
</section>
</li>
<li>
<section class="detail" id="shared(boolean)">
<h3>shared</h3>
<div class="horizontal-scroll">
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type"><a href="Shape.Builder.html" title="class in com.oracle.truffle.api.object">Shape.Builder</a></span>&nbsp;<span class="element-name">shared</span><wbr><span class="parameters">(boolean&nbsp;isShared)</span></div>
<div class="block">If <code>true</code>, makes the object shared (default: <code>false</code>).</div>
<dl class="notes">
<dt>Since:</dt>
<dd>20.2.0</dd>
<dt>See Also:</dt>
<dd>
<ul class="tag-list-long">
<li><a href="Shape.html#isShared()"><code>Shape.isShared()</code></a></li>
<li><a href="DynamicObjectLibrary.html#isShared(com.oracle.truffle.api.object.DynamicObject)"><code>DynamicObjectLibrary.isShared(DynamicObject)</code></a></li>
<li><a href="DynamicObjectLibrary.html#markShared(com.oracle.truffle.api.object.DynamicObject)"><code>DynamicObjectLibrary.markShared(DynamicObject)</code></a></li>
</ul>
</dd>
</dl>
</div>
</section>
</li>
<li>
<section class="detail" id="propertyAssumptions(boolean)">
<h3>propertyAssumptions</h3>
<div class="horizontal-scroll">
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type"><a href="Shape.Builder.html" title="class in com.oracle.truffle.api.object">Shape.Builder</a></span>&nbsp;<span class="element-name">propertyAssumptions</span><wbr><span class="parameters">(boolean&nbsp;enable)</span></div>
<div class="block">If <code>true</code>, enables the use of <a href="Shape.html#getPropertyAssumption(java.lang.Object)">property assumptions</a> for this object shape and any derived shapes (default:
<code>false</code>). Property assumptions allow speculating on select properties being absent
or stable across shape changes.

<p>
Use of property assumptions can be beneficial in single-context mode for long-lived
objects with stable properties but recurrent shape changes due to properties being added
(e.g. global objects of a context), in which case a shape cache would be unstable while
the property assumption allows for a stable cache.</div>
<dl class="notes">
<dt>Since:</dt>
<dd>20.2.0</dd>
<dt>See Also:</dt>
<dd>
<ul class="tag-list-long">
<li><a href="Shape.html#getPropertyAssumption(java.lang.Object)"><code>Shape.getPropertyAssumption(Object)</code></a></li>
</ul>
</dd>
</dl>
</div>
</section>
</li>
<li>
<section class="detail" id="sharedData(java.lang.Object)">
<h3>sharedData</h3>
<div class="horizontal-scroll">
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type"><a href="Shape.Builder.html" title="class in com.oracle.truffle.api.object">Shape.Builder</a></span>&nbsp;<span class="element-name">sharedData</span><wbr><span class="parameters">(<a href="https://docs.oracle.com/en/java/javase/26/docs/api/java.base/java/lang/Object.html" title="class or interface in java.lang" class="external-link">Object</a>&nbsp;sharedData)</span></div>
<div class="block">Sets shared data to be associated with the root shape and any derived shapes (e.g. a
<code>TruffleLanguage</code> instance). May be null (the default).</div>
<dl class="notes">
<dt>Since:</dt>
<dd>20.2.0</dd>
<dt>See Also:</dt>
<dd>
<ul class="tag-list">
<li><a href="Shape.html#getSharedData()"><code>Shape.getSharedData()</code></a></li>
</ul>
</dd>
</dl>
</div>
</section>
</li>
<li>
<section class="detail" id="singleContextAssumption(com.oracle.truffle.api.Assumption)">
<h3>singleContextAssumption</h3>
<div class="horizontal-scroll">
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type"><a href="Shape.Builder.html" title="class in com.oracle.truffle.api.object">Shape.Builder</a></span>&nbsp;<span class="element-name">singleContextAssumption</span><wbr><span class="parameters">(<a href="../Assumption.html" title="interface in com.oracle.truffle.api">Assumption</a>&nbsp;assumption)</span></div>
<div class="block">Sets an assumption that allows specializations on constant object instances with this
shape, as long as the assumption is valid. The assumption should be valid only if code is
not shared across contexts and invalidated when this is not longer true. The assumption
may be <code>null</code> in which case this feature is disabled (the default).</div>
<dl class="notes">
<dt>Since:</dt>
<dd>20.2.0</dd>
<dt>See Also:</dt>
<dd>
<ul class="tag-list">
<li><a href="#propertyAssumptions(boolean)"><code>propertyAssumptions(boolean)</code></a></li>
</ul>
</dd>
</dl>
</div>
</section>
</li>
<li>
<section class="detail" id="addConstantProperty(java.lang.Object,java.lang.Object,int)">
<h3>addConstantProperty</h3>
<div class="horizontal-scroll">
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type"><a href="Shape.Builder.html" title="class in com.oracle.truffle.api.object">Shape.Builder</a></span>&nbsp;<span class="element-name">addConstantProperty</span><wbr><span class="parameters">(<a href="https://docs.oracle.com/en/java/javase/26/docs/api/java.base/java/lang/Object.html" title="class or interface in java.lang" class="external-link">Object</a>&nbsp;key,
 <a href="https://docs.oracle.com/en/java/javase/26/docs/api/java.base/java/lang/Object.html" title="class or interface in java.lang" class="external-link">Object</a>&nbsp;value,
 int&nbsp;flags)</span></div>
<div class="block">Adds a property with a constant value to the shape. The key must not be <code>null</code> and
must not be equal to any previously added property's key.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>key</code> - the property's key</dd>
<dd><code>value</code> - the property's value</dd>
<dd><code>flags</code> - the property's flags</dd>
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/26/docs/api/java.base/java/lang/NullPointerException.html" title="class or interface in java.lang" class="external-link">NullPointerException</a></code> - if the key is <code>null</code></dd>
<dd><code><a href="https://docs.oracle.com/en/java/javase/26/docs/api/java.base/java/lang/IllegalArgumentException.html" title="class or interface in java.lang" class="external-link">IllegalArgumentException</a></code> - if a property with the key already exists</dd>
<dt>Since:</dt>
<dd>20.2.0</dd>
<dt>See Also:</dt>
<dd>
<ul class="tag-list-long">
<li><a href="DynamicObjectLibrary.html#putConstant(com.oracle.truffle.api.object.DynamicObject,java.lang.Object,java.lang.Object,int)"><code>DynamicObjectLibrary.putConstant(DynamicObject, Object, Object, int)</code></a></li>
</ul>
</dd>
</dl>
</div>
</section>
</li>
<li>
<section class="detail" id="allowImplicitCastIntToLong(boolean)">
<h3>allowImplicitCastIntToLong</h3>
<div class="horizontal-scroll">
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type"><a href="Shape.Builder.html" title="class in com.oracle.truffle.api.object">Shape.Builder</a></span>&nbsp;<span class="element-name">allowImplicitCastIntToLong</span><wbr><span class="parameters">(boolean&nbsp;allow)</span></div>
<div class="block">Allows values to be implicitly cast from int to long in this shape and any derived
shapes.</div>
<dl class="notes">
<dt>Since:</dt>
<dd>20.2.0</dd>
</dl>
</div>
</section>
</li>
<li>
<section class="detail" id="allowImplicitCastIntToDouble(boolean)">
<h3>allowImplicitCastIntToDouble</h3>
<div class="horizontal-scroll">
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type"><a href="Shape.Builder.html" title="class in com.oracle.truffle.api.object">Shape.Builder</a></span>&nbsp;<span class="element-name">allowImplicitCastIntToDouble</span><wbr><span class="parameters">(boolean&nbsp;allow)</span></div>
<div class="block">Allows values to be implicitly cast from int to double in this shape and any derived
shapes.</div>
<dl class="notes">
<dt>Since:</dt>
<dd>20.2.0</dd>
</dl>
</div>
</section>
</li>
<li>
<section class="detail" id="build()">
<h3>build</h3>
<div class="horizontal-scroll">
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type"><a href="Shape.html" title="class in com.oracle.truffle.api.object">Shape</a></span>&nbsp;<span class="element-name">build</span>()</div>
<div class="block">Builds a new shape using the configuration of this builder.</div>
<dl class="notes">
<dt>Since:</dt>
<dd>20.2.0</dd>
</dl>
</div>
</section>
</li>
</ul>
</section>
</li>
</ul>
</section>
<!-- ========= END OF CLASS DATA ========= -->
<footer role="contentinfo">
<hr>
<p class="legal-copy"><small><center>Copyright &copy; 2012, 2025, Oracle and/or its affiliates. All rights reserved.</center></small></p>
</footer>
</main>
</div>
</body>
</html>
