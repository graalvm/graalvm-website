<!DOCTYPE HTML>
<html lang="en">
<head>
<!-- Generated by javadoc (21) -->
<title>ExecutionListener (GraalVM Truffle Java API Reference)</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="declaration: package: org.graalvm.polyglot.management, class: ExecutionListener">
<meta name="generator" content="javadoc/ClassWriterImpl">
<link rel="stylesheet" type="text/css" href="../../../../stylesheet.css" title="Style">
<link rel="stylesheet" type="text/css" href="../../../../script-dir/jquery-ui.min.css" title="Style">
<script type="text/javascript" src="../../../../script.js"></script>
<script type="text/javascript" src="../../../../script-dir/jquery-3.6.1.min.js"></script>
<script type="text/javascript" src="../../../../script-dir/jquery-ui.min.js"></script>
</head>
<body class="class-declaration-page">
<script type="text/javascript">var pathtoroot = "../../../../";
loadScripts(document, 'script');</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<div class="flex-box">
<header role="banner" class="flex-header">
<nav role="navigation">
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="top-nav" id="navbar-top"><button id="navbar-toggle-button" aria-controls="navbar-top" aria-expanded="false" aria-label="Toggle navigation links"><span class="nav-bar-toggle-icon">&nbsp;</span><span class="nav-bar-toggle-icon">&nbsp;</span><span class="nav-bar-toggle-icon">&nbsp;</span></button>
<div class="skip-nav"><a href="#skip-navbar-top" title="Skip navigation links">Skip navigation links</a></div>
<div class="about-language"><b>GraalVM Truffle Java API Reference<br>24.2.0-dev</b><br>5ba9ba6be9b48db1add0352ed1511a82f8f09531</div>
<ul id="navbar-top-firstrow" class="nav-list" title="Navigation">
<li><a href="../../../../index.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="nav-bar-cell1-rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../index-all.html">Index</a></li>
<li><a href="../../../../help-doc.html#class">Help</a></li>
</ul>
<ul class="sub-nav-list-small">
<li>
<p>Summary:</p>
<ul>
<li><a href="#nested-class-summary">Nested</a></li>
<li>Field</li>
<li>Constr</li>
<li><a href="#method-summary">Method</a></li>
</ul>
</li>
<li>
<p>Detail:</p>
<ul>
<li>Field</li>
<li>Constr</li>
<li><a href="#method-detail">Method</a></li>
</ul>
</li>
</ul>
</div>
<div class="sub-nav">
<div id="navbar-sub-list">
<ul class="sub-nav-list">
<li>Summary:&nbsp;</li>
<li><a href="#nested-class-summary">Nested</a>&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method-summary">Method</a></li>
</ul>
<ul class="sub-nav-list">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method-detail">Method</a></li>
</ul>
</div>
<div class="nav-list-search"><a href="../../../../search.html">SEARCH</a>
<input type="text" id="search-input" disabled placeholder="Search">
<input type="reset" id="reset-button" disabled value="reset">
</div>
</div>
<!-- ========= END OF TOP NAVBAR ========= -->
<span class="skip-nav" id="skip-navbar-top"></span></nav>
</header>
<div class="flex-content">
<main role="main">
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="sub-title"><span class="package-label-in-type">Package</span>&nbsp;<a href="package-summary.html">org.graalvm.polyglot.management</a></div>
<h1 title="Class ExecutionListener" class="title">Class ExecutionListener</h1>
</div>
<div class="inheritance" title="Inheritance Tree"><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html" title="class or interface in java.lang" class="external-link">java.lang.Object</a>
<div class="inheritance">org.graalvm.polyglot.management.ExecutionListener</div>
</div>
<section class="class-description" id="class-description">
<dl class="notes">
<dt>All Implemented Interfaces:</dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/AutoCloseable.html" title="class or interface in java.lang" class="external-link">AutoCloseable</a></code></dd>
</dl>
<hr>
<div class="type-signature"><span class="modifiers">public final class </span><span class="element-name type-name-label">ExecutionListener</span>
<span class="extends-implements">extends <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html" title="class or interface in java.lang" class="external-link">Object</a>
implements <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/AutoCloseable.html" title="class or interface in java.lang" class="external-link">AutoCloseable</a></span></div>
<div class="block">Execution listeners allow to instrument the execution of guest languages. For example, it is
 possible to attach an execution listeners that is invoked for every statement of the guest
 language program, similar to how a debugger would single-step through the program.
 <p>
 The following example prints the characters of every executed statement of simple JavaScript
 loop.

 <code>
 <pre>
 Context context = Context.create("js");
 ExecutionListeners listener = ExecutionListeners.newBuilder()
          .onEnter((e) -&gt; System.out.println(
                  e.getLocation().getCharacters()))
          .statements(true)
          .attach(context.getEngine());
 context.eval("js", "for (var i = 0; i &lt; 2; i++);");
 listener.close();
 </pre>
 </code>

 Prints the following result:

 <pre>
 i = 0
 i &lt; 2
 i++
 i &lt; 2
 i++
 i &lt; 2
 </pre>

 <h3 id="creation-and-closing-heading">Creation and Closing</h3>

 An execution listener builder can be created by first invoking <a href="#newBuilder()"><code>newBuilder()</code></a>. At least
 one event consumer and one filtered source element needs to be enabled. To complete the listener
 attachment <a href="ExecutionListener.Builder.html#attach(org.graalvm.polyglot.Engine)"><code>ExecutionListener.Builder.attach(Engine)</code></a> needs to be invoked. <a href="ExecutionListener.Builder.html#attach(org.graalvm.polyglot.Engine)"><code>Attach</code></a> may be invoked multiple times for one builder.
 <p>
 All execution listeners are automatically closed when the engine <a href="../Engine.html#close()"><code>closed</code></a>.
 To close a listener earlier <a href="#close()"><code>close()</code></a> may be invoked. Execution listeners are
 <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/AutoCloseable.html" title="class or interface in java.lang" class="external-link"><code>AutoCloseable</code></a> and can therefore be used in try-with-resources blocks.

 <h3 id="event-consumers-heading">Event Consumers</h3>

 The following event consumers can be set for an execution listener:
 <ul>
 <li><a href="ExecutionListener.Builder.html#onEnter(java.util.function.Consumer)"><code>OnEnter</code></a>: An event that is notified when an execution of an
 element is entered. This event is consumed before any input values are executed.
 <li><a href="ExecutionListener.Builder.html#onReturn(java.util.function.Consumer)"><code>OnReturn</code></a>: An event that is notified when an execution of
 an element was entered and completed.
 </ul>
 At least one event consumer needs to be set otherwise an <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/IllegalArgumentException.html" title="class or interface in java.lang" class="external-link"><code>IllegalArgumentException</code></a> will be
 thrown by the builder when it is <a href="ExecutionListener.Builder.html#attach(org.graalvm.polyglot.Engine)"><code>attached</code></a>.
 <p>
 Event consumers may throw any Java host exception. Such exceptions will be reported to the
 context as <a href="../PolyglotException.html" title="class in org.graalvm.polyglot"><code>PolyglotException</code></a> instances. The thrown exception may be accessed using
 <a href="../PolyglotException.html#asHostException()"><code>PolyglotException.asHostException()</code></a>.

 <h3 id="event-data-heading">Event Data</h3>

 For every event that is consumed the <a href="ExecutionEvent.html#getLocation()"><code>source location</code></a> and
 <a href="ExecutionEvent.html#getRootName()"><code>root name</code></a> data is available. Other event data will return
 <code>null</code> by default.
 <p>
 The collection of the following event data may be enabled:
 <ul>
 <li><a href="ExecutionListener.Builder.html#collectReturnValue(boolean)"><code>Return values</code></a>: Enables access to
 <a href="ExecutionEvent.html#getReturnValue()"><code>return values</code></a> in <a href="ExecutionListener.Builder.html#onReturn(java.util.function.Consumer)"><code>OnReturn</code></a> events.
 <li><a href="ExecutionListener.Builder.html#collectInputValues(boolean)"><code>Input values</code></a>: Enables access to
 <a href="ExecutionEvent.html#getInputValues()"><code>input values</code></a> in <a href="ExecutionListener.Builder.html#onReturn(java.util.function.Consumer)"><code>OnReturn</code></a> events.
 <li><a href="ExecutionListener.Builder.html#collectExceptions(boolean)"><code>Errors</code></a>: Enables access to
 <a href="ExecutionEvent.html#getException()"><code>errors</code></a> in <a href="ExecutionListener.Builder.html#onReturn(java.util.function.Consumer)"><code>OnReturn</code></a>
 events.
 </ul>
 If additional event data is collected then the peak performance overhead of execution listeners
 is significant. It is not recommended to collect additional event data when running production
 workloads.
 <p>
 Provided event instances may escape the event consumer and remain usable until the engine is
 closed.

 <h3 id="event-filters-heading">Event Filters</h3>

 Execution listeners can be applied to the following source elements:
 <ul>
 <li><a href="ExecutionListener.Builder.html#roots(boolean)"><code>Roots</code></a>: Filter for marked program locations that represent a
 root of a function, method or closure.
 <li><a href="ExecutionListener.Builder.html#statements(boolean)"><code>Statements</code></a>: Filter for marked program locations that
 represent a statement.
 <li><a href="ExecutionListener.Builder.html#expressions(boolean)"><code>Expressions</code></a>: Filter for marked program locations that
 represent an expression.
 </ul>
 At least one source element needs to be enabled otherwise an <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/IllegalArgumentException.html" title="class or interface in java.lang" class="external-link"><code>IllegalArgumentException</code></a>
 will be thrown by the builder when it is <a href="ExecutionListener.Builder.html#attach(org.graalvm.polyglot.Engine)"><code>attached</code></a>. Not all source
 elements may be supported by a language. If the language does not support listening to a source
 element then no events will be triggered.
 <p>
 If multiple source elements are enabled, multiple or one event may be reported per source
 location. If this behavior is not desirable than multiple execution listeners for each source
 element can be created and attached.
 <p>
 By default the execution listener is applied to all <a href="../Source.html" title="class in org.graalvm.polyglot"><code>sources</code></a> that were loaded. A
 <a href="ExecutionListener.Builder.html#sourceFilter(java.util.function.Predicate)"><code>source filter</code></a> may be attached to limit the number of
 sources that will trigger events.

 <h3 id="performance-heading">Performance</h3>

 The peak performance overhead of execution listeners depend on the granularity of the filter.
 Roots can be collected more efficiently than statement or expression events due to their
 frequency. If additional event data is collected then the peak performance overhead of execution
 listeners is significant. It is not recommended to collect additional event data when running
 production workloads.
 <p>
 <a href="ExecutionListener.Builder.html#attach(org.graalvm.polyglot.Engine)"><code>Attaching</code></a> and <a href="#close()"><code>closing</code></a> execution listeners are
 expensive operations and typically require to traverse through all loaded code. Code that was
 previously optimized will be deoptimized in the process. It is most efficient to attach an
 execution listener before any code is executed and let execution listeners automatically close
 with the engine.

 <h3 id="compatibility-heading">Compatibility</h3>

 Event execution order and granularity of events are language specific and may change without
 notice. There are no compatibility guarantees for that provided by the polyglot SDK. Certain
 language implementations may do so. Please see the language implementation documentation for
 further details.

 <h3 id="use-cases-heading">Use-cases</h3>

 Execution listeners are designed as simple API for polyglot embedders to capture cross cutting
 concerns of the execution of programs. For example, it can be used to count all statements
 executed in order to detect potentially malicious code. It is not designed to be an API for
 implementing fully fledged tools. The
 <a href="http://www.graalvm.org/docs/graalvm-as-a-platform/implement-instrument/">Truffle
 instrumentation framework</a> should be used for that purpose instead.</div>
<dl class="notes">
<dt>Since:</dt>
<dd>19.0</dd>
</dl>
</section>
<section class="summary">
<ul class="summary-list">
<!-- ======== NESTED CLASS SUMMARY ======== -->
<li>
<section class="nested-class-summary" id="nested-class-summary">
<h2>Nested Class Summary</h2>
<div class="caption"><span>Nested Classes</span></div>
<div class="summary-table three-column-summary">
<div class="table-header col-first">Modifier and Type</div>
<div class="table-header col-second">Class</div>
<div class="table-header col-last">Description</div>
<div class="col-first even-row-color"><code>final class&nbsp;</code></div>
<div class="col-second even-row-color"><code><a href="ExecutionListener.Builder.html" class="type-name-link" title="class in org.graalvm.polyglot.management">ExecutionListener.Builder</a></code></div>
<div class="col-last even-row-color">
<div class="block">A builder used to construct execution events.</div>
</div>
</div>
</section>
</li>
<!-- ========== METHOD SUMMARY =========== -->
<li>
<section class="method-summary" id="method-summary">
<h2>Method Summary</h2>
<div id="method-summary-table">
<div class="table-tabs" role="tablist" aria-orientation="horizontal"><button id="method-summary-table-tab0" role="tab" aria-selected="true" aria-controls="method-summary-table.tabpanel" tabindex="0" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table', 3)" class="active-table-tab">All Methods</button><button id="method-summary-table-tab1" role="tab" aria-selected="false" aria-controls="method-summary-table.tabpanel" tabindex="-1" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table-tab1', 3)" class="table-tab">Static Methods</button><button id="method-summary-table-tab2" role="tab" aria-selected="false" aria-controls="method-summary-table.tabpanel" tabindex="-1" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table-tab2', 3)" class="table-tab">Instance Methods</button><button id="method-summary-table-tab4" role="tab" aria-selected="false" aria-controls="method-summary-table.tabpanel" tabindex="-1" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table-tab4', 3)" class="table-tab">Concrete Methods</button></div>
<div id="method-summary-table.tabpanel" role="tabpanel">
<div class="summary-table three-column-summary" aria-labelledby="method-summary-table-tab0">
<div class="table-header col-first">Modifier and Type</div>
<div class="table-header col-second">Method</div>
<div class="table-header col-last">Description</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>void</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#close()" class="member-name-link">close</a>()</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Closes and detaches this execution listener from the engine.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code>static <a href="ExecutionListener.Builder.html" title="class in org.graalvm.polyglot.management">ExecutionListener.Builder</a></code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code><a href="#newBuilder()" class="member-name-link">newBuilder</a>()</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4">
<div class="block">Creates a builder that can be used to attach execution listeners.</div>
</div>
</div>
</div>
</div>
<div class="inherited-list">
<h3 id="methods-inherited-from-class-java.lang.Object">Methods inherited from class&nbsp;java.lang.<a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html" title="class or interface in java.lang" class="external-link">Object</a></h3>
<code><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html#clone()" title="class or interface in java.lang" class="external-link">clone</a>, <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html#equals(java.lang.Object)" title="class or interface in java.lang" class="external-link">equals</a>, <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html#finalize()" title="class or interface in java.lang" class="external-link">finalize</a>, <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html#getClass()" title="class or interface in java.lang" class="external-link">getClass</a>, <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html#hashCode()" title="class or interface in java.lang" class="external-link">hashCode</a>, <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html#notify()" title="class or interface in java.lang" class="external-link">notify</a>, <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html#notifyAll()" title="class or interface in java.lang" class="external-link">notifyAll</a>, <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html#toString()" title="class or interface in java.lang" class="external-link">toString</a>, <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html#wait()" title="class or interface in java.lang" class="external-link">wait</a>, <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html#wait(long)" title="class or interface in java.lang" class="external-link">wait</a>, <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html#wait(long,int)" title="class or interface in java.lang" class="external-link">wait</a></code></div>
</section>
</li>
</ul>
</section>
<section class="details">
<ul class="details-list">
<!-- ============ METHOD DETAIL ========== -->
<li>
<section class="method-details" id="method-detail">
<h2>Method Details</h2>
<ul class="member-list">
<li>
<section class="detail" id="close()">
<h3>close</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name">close</span>()</div>
<div class="block">Closes and detaches this execution listener from the engine. After an execution listener was
 closed no further events will be reported.
 <p>
 <a href="ExecutionListener.Builder.html#attach(org.graalvm.polyglot.Engine)"><code>Attaching</code></a> and <a href="#close()"><code>closing</code></a> execution listeners are
 expensive operations and typically require to traverse through all loaded code. Code that was
 previously optimized will be deoptimized in the process. It is most efficient to attach an
 execution listener before any code is executed and let execution listeners automatically
 close with the engine.</div>
<dl class="notes">
<dt>Specified by:</dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/AutoCloseable.html#close()" title="class or interface in java.lang" class="external-link">close</a></code>&nbsp;in interface&nbsp;<code><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/AutoCloseable.html" title="class or interface in java.lang" class="external-link">AutoCloseable</a></code></dd>
<dt>Since:</dt>
<dd>19.0</dd>
<dt>See Also:</dt>
<dd>
<ul class="tag-list-long">
<li><a href="ExecutionListener.Builder.html#attach(org.graalvm.polyglot.Engine)"><code>ExecutionListener.Builder.attach(Engine)</code></a></li>
</ul>
</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="newBuilder()">
<h3>newBuilder</h3>
<div class="member-signature"><span class="modifiers">public static</span>&nbsp;<span class="return-type"><a href="ExecutionListener.Builder.html" title="class in org.graalvm.polyglot.management">ExecutionListener.Builder</a></span>&nbsp;<span class="element-name">newBuilder</span>()</div>
<div class="block">Creates a builder that can be used to attach execution listeners. The returned Builder
 instance is not thread-safe.
 <p>
 A minimal example on how to build and attach a listener:

 <code>
 <pre>
 ExecutionListeners listener = ExecutionListeners.newBuilder()
          .onEnter((e) -&gt; ...)
          .statements(true)
          .attach(context.getEngine());
 </pre>
 </code></div>
<dl class="notes">
<dt>Since:</dt>
<dd>19.0</dd>
<dt>See Also:</dt>
<dd>
<ul class="tag-list">
<li><a href="ExecutionListener.html" title="class in org.graalvm.polyglot.management"><code>ExecutionListener</code></a></li>
</ul>
</dd>
</dl>
</section>
</li>
</ul>
</section>
</li>
</ul>
</section>
<!-- ========= END OF CLASS DATA ========= -->
</main>
<footer role="contentinfo">
<hr>
<p class="legal-copy"><small><center>Copyright &copy; 2012, 2024, Oracle and/or its affiliates. All rights reserved.</center></small></p>
</footer>
</div>
</div>
</body>
</html>
