<!DOCTYPE HTML>
<html lang="en">
<head>
<!-- Generated by javadoc (21) -->
<title>jdk.graal.compiler.graphio (jdk.graal.compiler javadoc)</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="declaration: package: jdk.graal.compiler.graphio">
<meta name="generator" content="javadoc/PackageWriterImpl">
<link rel="stylesheet" type="text/css" href="../../../../stylesheet.css" title="Style">
<link rel="stylesheet" type="text/css" href="../../../../script-dir/jquery-ui.min.css" title="Style">
<script type="text/javascript" src="../../../../script.js"></script>
<script type="text/javascript" src="../../../../script-dir/jquery-3.6.1.min.js"></script>
<script type="text/javascript" src="../../../../script-dir/jquery-ui.min.js"></script>
</head>
<body class="package-declaration-page">
<script type="text/javascript">var pathtoroot = "../../../../";
loadScripts(document, 'script');</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<div class="flex-box">
<header role="banner" class="flex-header">
<nav role="navigation">
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="top-nav" id="navbar-top"><button id="navbar-toggle-button" aria-controls="navbar-top" aria-expanded="false" aria-label="Toggle navigation links"><span class="nav-bar-toggle-icon">&nbsp;</span><span class="nav-bar-toggle-icon">&nbsp;</span><span class="nav-bar-toggle-icon">&nbsp;</span></button>
<div class="skip-nav"><a href="#skip-navbar-top" title="Skip navigation links">Skip navigation links</a></div>
<ul id="navbar-top-firstrow" class="nav-list" title="Navigation">
<li><a href="../../../../index.html">Overview</a></li>
<li class="nav-bar-cell1-rev">Package</li>
<li>Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../index-all.html">Index</a></li>
<li><a href="../../../../help-doc.html#package">Help</a></li>
</ul>
<ul class="sub-nav-list-small">
<li>
<p>Package:</p>
<ul>
<li><a href="#package-description">Description</a></li>
<li>Related Packages</li>
<li><a href="#class-summary">Classes and Interfaces</a></li>
</ul>
</li>
</ul>
</div>
<div class="sub-nav">
<div id="navbar-sub-list">
<ul class="sub-nav-list">
<li>Package:&nbsp;</li>
<li><a href="#package-description">Description</a>&nbsp;|&nbsp;</li>
<li>Related Packages&nbsp;|&nbsp;</li>
<li><a href="#class-summary">Classes and Interfaces</a></li>
</ul>
</div>
<div class="nav-list-search"><a href="../../../../search.html">SEARCH</a>
<input type="text" id="search-input" disabled placeholder="Search">
<input type="reset" id="reset-button" disabled value="reset">
</div>
</div>
<!-- ========= END OF TOP NAVBAR ========= -->
<span class="skip-nav" id="skip-navbar-top"></span></nav>
</header>
<div class="flex-content">
<main role="main">
<div class="header">
<h1 title="Package jdk.graal.compiler.graphio" class="title">Package jdk.graal.compiler.graphio</h1>
</div>
<hr>
<div class="package-signature">package <span class="element-name">jdk.graal.compiler.graphio</span></div>
<section class="package-description" id="package-description">
<div class="block">Send your graphs to <b>IGV</b> via a socket or a file. This package allows one to easily encode
 any graph-like data structure and send it for visualization to <em>OracleLab's Ideal Graph
 Visualizer</em> tool. Assuming you already have your own data structure that contains
 <b>nodes</b> and <b>edges</b> among them, creating a
 <a href="GraphOutput.html" title="class in jdk.graal.compiler.graphio"><code>GraphOutput</code></a> specialized for your data is a matter of
 implementing a single interface:

 
<div class="snippet-container"><button class="copy snippet-copy" aria-label="Copy snippet" onclick="copySnippet(this)"><span data-copied="Copied!">Copy</span><img src="../../../../copy.svg" alt="Copy snippet"></button>
<pre class="snippet"><code class="language-java">class AcmeGraphStructure implements
GraphStructure&lt;AcmeGraph, AcmeNode, AcmeNodeType, AcmePorts&gt; {

    @Override
    public AcmeGraph graph(AcmeGraph currentGraph, Object obj) {
        return obj instanceof AcmeGraph ? (AcmeGraph) obj : null;
    }

    @Override
    public Iterable&lt;? extends AcmeNode&gt; nodes(AcmeGraph graph) {
        return graph.allNodes();
    }

    @Override
    public int nodesCount(AcmeGraph graph) {
        return graph.allNodes().size();
    }

    @Override
    public int nodeId(AcmeNode node) {
        return node.id;
    }

    @Override
    public boolean nodeHasPredecessor(AcmeNode node) {
        return node.id &gt; 0;
    }

    @Override
    public void nodeProperties(
        AcmeGraph graph, AcmeNode node, Map&lt;String, ? super Object&gt; properties
    ) {
        properties.put("id", node.id);
    }

    @Override
    public AcmeNodeType nodeClass(Object obj) {
        return obj instanceof AcmeNodeType ? (AcmeNodeType) obj : null;
    }

    @Override
    public AcmeNode node(Object obj) {
        return obj instanceof AcmeNode ? (AcmeNode) obj : null;
    }

    @Override
    public AcmeNodeType classForNode(AcmeNode node) {
        // we have only one type of nodes
        return AcmeNodeType.STANDARD;
    }


    @Override
    public String nameTemplate(AcmeNodeType nodeClass) {
        return "Acme ({p#id})";
    }

    @Override
    public Object nodeClassType(AcmeNodeType nodeClass) {
        return nodeClass.getClass();
    }

    @Override
    public AcmePorts portInputs(AcmeNodeType nodeClass) {
        return AcmePorts.INPUT;
    }

    @Override
    public AcmePorts portOutputs(AcmeNodeType nodeClass) {
        return AcmePorts.OUTPUT;
    }

    @Override
    public int portSize(AcmePorts port) {
        return port == AcmePorts.OUTPUT ? 1 : 0;
    }

    @Override
    public boolean edgeDirect(AcmePorts port, int index) {
        return false;
    }

    @Override
    public String edgeName(AcmePorts port, int index) {
        return port.name();
    }

    @Override
    public Object edgeType(AcmePorts port, int index) {
        return port;
    }

    @Override
    public Collection&lt;? extends AcmeNode&gt; edgeNodes(
        AcmeGraph graph, AcmeNode node, AcmePorts port, int index
    ) {
        if (port == AcmePorts.OUTPUT) {
            return node.outgoing.targets;
        }
        return null;
    }
}

</code></pre>
</div>


 The <a href="GraphStructure.html" title="interface in jdk.graal.compiler.graphio"><code>GraphStructure</code></a> interface defines the set of operations
 that are needed by the <em>graph protocol</em> to encode a graph into the <b>IGV</b> expected
 format. The graph structure is implemented as a so called
 <a href="http://wiki.apidesign.org/wiki/Singletonizer">singletonizer</a> API pattern: there is no
 need to change your data structures or implement some special interfaces - everything needed is
 provided by implementing the <a href="GraphStructure.html" title="interface in jdk.graal.compiler.graphio"><code>GraphStructure</code></a> operations.
 <p>
 The next step is to turn this graph structure into an instance of
 <a href="GraphOutput.html" title="class in jdk.graal.compiler.graphio"><code>GraphOutput</code></a>. To do so use the associated
 <a href="GraphOutput.Builder.html" title="class in jdk.graal.compiler.graphio"><code>builder</code></a> just like shown in the following
 method:

 
<div class="snippet-container"><button class="copy snippet-copy" aria-label="Copy snippet" onclick="copySnippet(this)"><span data-copied="Copied!">Copy</span><img src="../../../../copy.svg" alt="Copy snippet"></button>
<pre class="snippet"><code class="language-java">static GraphOutput&lt;AcmeGraph, ?&gt; buildOutput(WritableByteChannel channel)
throws IOException {
    return GraphOutput.newBuilder(acmeGraphStructure()).
        // use the latest version; currently 6.0
        protocolVersion(6, 0).
        build(channel);
}
</code></pre>
</div>


 Now you are ready to dump your graph into <b>IGV</b>. Where to obtain the right channel? One
 option is to create a <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/nio/channels/FileChannel.html" title="class or interface in java.nio.channels" class="external-link"><code>FileChannel</code></a> and dump the data into a file
 (preferrably with <code>.bgv</code> extension). The other is to open a socket to port
 <code>4445</code> (the default port <b>IGV</b> listens to) and dump the data there. Here is an
 example:

 
<div class="snippet-container"><button class="copy snippet-copy" aria-label="Copy snippet" onclick="copySnippet(this)"><span data-copied="Copied!">Copy</span><img src="../../../../copy.svg" alt="Copy snippet"></button>
<pre class="snippet"><code class="language-java">static void dump(File toFile) throws IOException {
    try (
        FileChannel ch = new FileOutputStream(toFile).getChannel();
        GraphOutput&lt;AcmeGraph, ?&gt; output = buildOutput(ch);
    ) {
        AcmeNode root = new AcmeNode(0);
        AcmeNode n1 = new AcmeNode(1);
        AcmeNode n2 = new AcmeNode(2);
        AcmeNode n3 = new AcmeNode(3);

        root.linkTo(n1);
        root.linkTo(n2);
        n1.linkTo(n3);
        n2.linkTo(n3);

        AcmeGraph diamondGraph = new AcmeGraph(root);

        output.beginGroup(diamondGraph, "Diamond", "dia", null, 0, null);
        output.print(diamondGraph, null, 0, "Diamond graph #%d", 1);
        output.endGroup();
    }
}
</code></pre>
</div>


 Call the <code>dump</code> method with pointer to file <code>diamond.bgv</code> and then you can open the
 file in <b>IGV</b>. The result will look like this:
 <p>
 <img src="doc-files/diamond.png">
 <p>
 You can verify the behavior directly in the <b>IGV</b> by downloading
 <a href="doc-files/diamond.bgv">diamond.bgv</a> file generated from the above diamond structure
 graph.
 <p>
 The primary <b>IGV</b> focus is on graphs used by the compiler. As such they aren't plain graphs,
 but contain various compiler oriented attributes:
 <ul>
 <li><a href="GraphBlocks.html" title="interface in jdk.graal.compiler.graphio">code blocks</a> information</li>
 <li><a href="GraphElements.html" title="interface in jdk.graal.compiler.graphio">method and fields</a> information</li>
 <li>Advanced support for <a href="GraphTypes.html" title="interface in jdk.graal.compiler.graphio">recognizing
 types</a></li>
 </ul>
 all these additional interfaces (<a href="GraphBlocks.html" title="interface in jdk.graal.compiler.graphio"><code>GraphBlocks</code></a>,
 <a href="GraphElements.html" title="interface in jdk.graal.compiler.graphio"><code>GraphElements</code></a> and
 <a href="GraphTypes.html" title="interface in jdk.graal.compiler.graphio"><code>GraphTypes</code></a>) are optional - they don't have to be provided. As
 such they can be specified via <a href="GraphOutput.Builder.html" title="class in jdk.graal.compiler.graphio"><code>GraphOutput.Builder</code></a> instance
 methods, which may, but need not be called at all. Here is an example:

 
<div class="snippet-container"><button class="copy snippet-copy" aria-label="Copy snippet" onclick="copySnippet(this)"><span data-copied="Copied!">Copy</span><img src="../../../../copy.svg" alt="Copy snippet"></button>
<pre class="snippet"><code class="language-java">static GraphOutput&lt;AcmeGraph, ?&gt; buildAll(WritableByteChannel channel)
throws IOException {
    GraphBlocks&lt;AcmeGraph, AcmeBlocks, AcmeNode&gt; graphBlocks = acmeBlocks();
    GraphElements&lt;AcmeMethod, AcmeField,
        AcmeSignature, AcmeCodePosition&gt; graphElements = acmeElements();
    GraphTypes graphTypes = acmeTypes();

    return GraphOutput.newBuilder(acmeGraphStructure()).
        protocolVersion(6, 0).
        blocks(graphBlocks).
        elements(graphElements).
        types(graphTypes).
        build(channel);
}
</code></pre>
</div>


 All these interfaces follow the
 <a href="http://wiki.apidesign.org/wiki/Singletonizer">singletonizer</a> API pattern again - e.g.
 no need to change your existing data structures, just implement the operations provided by the
 interfaces you pass into the builder. By combining these interfaces together you can get as rich,
 colorful, source linked graphs as the compiler produces to describe its optimizations.</div>
</section>
<section class="summary">
<ul class="summary-list">
<li>
<div id="class-summary">
<div class="table-tabs" role="tablist" aria-orientation="horizontal"><button id="class-summary-tab0" role="tab" aria-selected="true" aria-controls="class-summary.tabpanel" tabindex="0" onkeydown="switchTab(event)" onclick="show('class-summary', 'class-summary', 2)" class="active-table-tab">All Classes and Interfaces</button><button id="class-summary-tab1" role="tab" aria-selected="false" aria-controls="class-summary.tabpanel" tabindex="-1" onkeydown="switchTab(event)" onclick="show('class-summary', 'class-summary-tab1', 2)" class="table-tab">Interfaces</button><button id="class-summary-tab2" role="tab" aria-selected="false" aria-controls="class-summary.tabpanel" tabindex="-1" onkeydown="switchTab(event)" onclick="show('class-summary', 'class-summary-tab2', 2)" class="table-tab">Classes</button></div>
<div id="class-summary.tabpanel" role="tabpanel">
<div class="summary-table two-column-summary" aria-labelledby="class-summary-tab0">
<div class="table-header col-first">Class</div>
<div class="table-header col-last">Description</div>
<div class="col-first even-row-color class-summary class-summary-tab1"><a href="GraphBlocks.html" title="interface in jdk.graal.compiler.graphio">GraphBlocks</a>&lt;G,<wbr>B,<wbr>N&gt;</div>
<div class="col-last even-row-color class-summary class-summary-tab1">
<div class="block">Special support for dealing with blocks.</div>
</div>
<div class="col-first odd-row-color class-summary class-summary-tab1"><a href="GraphElements.html" title="interface in jdk.graal.compiler.graphio">GraphElements</a>&lt;M,<wbr>F,<wbr>S,<wbr>P&gt;</div>
<div class="col-last odd-row-color class-summary class-summary-tab1">
<div class="block">Representation of methods, fields, their signatures and code locations.</div>
</div>
<div class="col-first even-row-color class-summary class-summary-tab1"><a href="GraphLocations.html" title="interface in jdk.graal.compiler.graphio">GraphLocations</a>&lt;M,<wbr>P,<wbr>L&gt;</div>
<div class="col-last even-row-color class-summary class-summary-tab1">
<div class="block">Provides source location information about compiled code.</div>
</div>
<div class="col-first odd-row-color class-summary class-summary-tab2"><a href="GraphOutput.html" title="class in jdk.graal.compiler.graphio">GraphOutput</a>&lt;G,<wbr>M&gt;</div>
<div class="col-last odd-row-color class-summary class-summary-tab2">
<div class="block">Instance of output to dump informations about a compiler compilations.</div>
</div>
<div class="col-first even-row-color class-summary class-summary-tab2"><a href="GraphOutput.Builder.html" title="class in jdk.graal.compiler.graphio">GraphOutput.Builder</a>&lt;G,<wbr>N,<wbr>M&gt;</div>
<div class="col-last even-row-color class-summary class-summary-tab2">
<div class="block">Builder to configure and create an instance of <a href="GraphOutput.html" title="class in jdk.graal.compiler.graphio"><code>GraphOutput</code></a>.</div>
</div>
<div class="col-first odd-row-color class-summary class-summary-tab1"><a href="GraphStructure.html" title="interface in jdk.graal.compiler.graphio">GraphStructure</a>&lt;G,<wbr>N,<wbr>C,<wbr>P&gt;</div>
<div class="col-last odd-row-color class-summary class-summary-tab1">
<div class="block">Interface that defines structure of a compiler graph.</div>
</div>
<div class="col-first even-row-color class-summary class-summary-tab1"><a href="GraphTypes.html" title="interface in jdk.graal.compiler.graphio">GraphTypes</a></div>
<div class="col-last even-row-color class-summary class-summary-tab1">
<div class="block">Special support for dealing with enums.</div>
</div>
</div>
</div>
</div>
</li>
</ul>
</section>
</main>
</div>
</div>
</body>
</html>
