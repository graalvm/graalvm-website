<!DOCTYPE HTML>
<html lang="en">
<head>
<!-- Generated by javadoc (25) -->
<title>GenerateLibrary (GraalVM Truffle Java API Reference)</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="declaration: package: com.oracle.truffle.api.library, annotation type: GenerateLibrary">
<meta name="generator" content="javadoc/ClassWriter">
<link rel="stylesheet" type="text/css" href="../../../../../resource-files/jquery-ui.min.css">
<link rel="stylesheet" type="text/css" href="../../../../../resource-files/stylesheet.css">
<script type="text/javascript" src="../../../../../script-files/script.js"></script>
<script type="text/javascript" src="../../../../../script-files/jquery-3.7.1.min.js"></script>
<script type="text/javascript" src="../../../../../script-files/jquery-ui.min.js"></script>
</head>
<body class="class-declaration-page">
<script type="text/javascript">const pathtoroot = "../../../../../";
loadScripts(document, 'script');</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<header role="banner">
<nav role="navigation">
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="top-nav" id="navbar-top">
<div class="nav-content">
<div class="nav-menu-button"><button id="navbar-toggle-button" aria-controls="navbar-top" aria-expanded="false" aria-label="Toggle navigation links"><span class="nav-bar-toggle-icon">&nbsp;</span><span class="nav-bar-toggle-icon">&nbsp;</span><span class="nav-bar-toggle-icon">&nbsp;</span></button></div>
<div class="skip-nav"><a href="#skip-navbar-top" title="Skip navigation links">Skip navigation links</a></div>
<ul id="navbar-top-firstrow" class="nav-list" title="Navigation">
<li><a href="../../../../../index.html">Overview</a></li>
<li class="nav-bar-cell1-rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../index-all.html">Index</a></li>
<li><a href="../../../../../search.html">Search</a></li>
<li><a href="../../../../../help-doc.html#class">Help</a></li>
</ul>
<div class="about-language"><b>GraalVM Truffle Java API Reference<br>25.1.0-dev</b><br>7dd9538c5867e0121233b95c1cc856df22fd0380</div>
</div>
</div>
<div class="sub-nav">
<div class="nav-content">
<ol class="sub-nav-list">
<li><a href="package-summary.html">com.oracle.truffle.api.library</a></li>
<li><a href="GenerateLibrary.html" class="current-selection">GenerateLibrary</a></li>
</ol>
<div class="nav-list-search"><input type="text" id="search-input" disabled placeholder="Search documentation (type /)" aria-label="Search in documentation" autocomplete="off" spellcheck="false"><input type="reset" id="reset-search" disabled value="Reset"></div>
</div>
</div>
<!-- ========= END OF TOP NAVBAR ========= -->
<span class="skip-nav" id="skip-navbar-top"></span></nav>
</header>
<div class="main-grid">
<nav role="navigation" class="toc" aria-label="Table of contents">
<div class="toc-header">Contents&nbsp;<input type="text" class="filter-input" disabled placeholder="Filter contents (type .)" aria-label="Filter table of contents" autocomplete="off" spellcheck="false"><input type="reset" class="reset-filter" disabled tabindex="-1" value="Reset"></div>
<ol class="toc-list" tabindex="-1">
<li><a href="#" tabindex="0">Description</a></li>
<li><a href="#nested-class-summary" tabindex="0">Nested Class Summary</a></li>
<li><a href="#annotation-interface-optional-element-summary" tabindex="0">Optional Element Summary</a></li>
<li><a href="#annotation-interface-element-detail" tabindex="0">Element Details</a>
<ol class="toc-list">
<li><a href="#assertions()" tabindex="0">assertions</a></li>
<li><a href="#receiverType()" tabindex="0">receiverType</a></li>
<li><a href="#defaultExportLookupEnabled()" tabindex="0">defaultExportLookupEnabled</a></li>
<li><a href="#dynamicDispatchEnabled()" tabindex="0">dynamicDispatchEnabled</a></li>
<li><a href="#pushEncapsulatingNode()" tabindex="0">pushEncapsulatingNode</a></li>
</ol>
</li>
</ol>
<button class="hide-sidebar"><span>Hide sidebar&nbsp;</span><img src="../../../../../resource-files/left.svg" alt="Hide sidebar"></button><button class="show-sidebar"><img src="../../../../../resource-files/right.svg" alt="Show sidebar"><span>&nbsp;Show sidebar</span></button></nav>
<main role="main">
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<h1 title="Annotation Interface GenerateLibrary" class="title">Annotation Interface GenerateLibrary</h1>
</div>
<section class="class-description" id="class-description">
<hr>
<div class="horizontal-scroll">
<div class="type-signature"><span class="annotations"><a href="https://docs.oracle.com/en/java/javase/25/docs/api/java.base/java/lang/annotation/Retention.html" title="class or interface in java.lang.annotation" class="external-link">@Retention</a>(<a href="https://docs.oracle.com/en/java/javase/25/docs/api/java.base/java/lang/annotation/RetentionPolicy.html#RUNTIME" title="class or interface in java.lang.annotation" class="external-link">RUNTIME</a>)
<a href="https://docs.oracle.com/en/java/javase/25/docs/api/java.base/java/lang/annotation/Target.html" title="class or interface in java.lang.annotation" class="external-link">@Target</a>(<a href="https://docs.oracle.com/en/java/javase/25/docs/api/java.base/java/lang/annotation/ElementType.html#TYPE" title="class or interface in java.lang.annotation" class="external-link">TYPE</a>)
</span><span class="modifiers">public @interface </span><span class="element-name type-name-label">GenerateLibrary</span></div>
<div class="block">Libraries are specified with <code>public</code> and <code>abstract</code> Java classes that
extend the <a href="Library.html" title="class in com.oracle.truffle.api.library">Library</a> class and are annotated by <code>@GenerateLibrary</code>. A
library consists of a set of messages, that are specified using public Java methods. The methods
may be abstract or use default implementations. The first parameter of every library message is
the receiver parameter, which must be a non-primitive type and consistent across all messages of
a library. There are no restrictions on the return type or argument types of a message. Every
method that specifies a message must have a name that is unique per library. Final or private
methods will always be ignored by the generator. Parameter type overloading is currently not
supported for messages, therefore every public method must have a unique name per library.
Generic type arguments local to messages are generally supported, but generic type arguments on
the library type are not yet supported.
<p>

<h3 id="basic-usage-heading">Basic Usage</h3>

The following example specifies a basic library for arrays:

<pre>
&#64;GenerateLibrary
public abstract class ArrayLibrary extends Library {

    public boolean isArray(Object receiver) {
        return false;
    }

    public abstract int read(Object receiver, int index);
}
</pre>

Messages that are not implemented and have no default implementation throw an
<a href="https://docs.oracle.com/en/java/javase/25/docs/api/java.base/java/lang/AbstractMethodError.html" title="class or interface in java.lang" class="external-link"><code>AbstractMethodError</code></a>. The <a href="GenerateLibrary.Abstract.html" title="annotation interface in com.oracle.truffle.api.library"><code>GenerateLibrary.Abstract</code></a> annotation can be used, to provide a default
implementation for receiver types but at the same time make the message abstract.
<p>
A library class may also specify <a href="GenerateLibrary.DefaultExport.html" title="annotation interface in com.oracle.truffle.api.library"><code>default exports</code></a> that can be used to
dispatch to receiver types that don't export the library. Since the receiver type for default
exports can be specified explicitly, it can be used to provide a default implementation for
receiver types of third parties or the JDK. For example the Truffle interop library has default
exports for most <a href="https://docs.oracle.com/en/java/javase/25/docs/api/java.base/java/lang/Number.html" title="class or interface in java.lang" class="external-link"><code>Number</code></a> types, <a href="https://docs.oracle.com/en/java/javase/25/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link"><code>String</code></a> and <a href="https://docs.oracle.com/en/java/javase/25/docs/api/java.base/java/lang/Boolean.html" title="class or interface in java.lang" class="external-link"><code>Boolean</code></a> type.
<p>
In order to enable AOT generation for a library annotate the class with <a href="../dsl/GenerateAOT.html" title="annotation interface in com.oracle.truffle.api.dsl"><code>GenerateAOT</code></a> and
enable exports to be used for AOT by setting <a href="ExportLibrary.html#useForAOT()"><code>ExportLibrary.useForAOT()</code></a> to
<code>true</code>.

<h3 id="deprecating-messages-heading">Deprecating Messages</h3>

If a library message gets deprecated using the <a href="https://docs.oracle.com/en/java/javase/25/docs/api/java.base/java/lang/Deprecated.html" title="class or interface in java.lang" class="external-link"><code>Deprecated</code></a> annotation then all exports
will get a deprecation warning. This can be useful to evolve libraries over time in a compatible
way.
<p>
Sometimes it is needed to remove or modify types of parameters as part of evolution. In this case
it is possible to declare multiple overloads of the same library message where all but one method
are annotated with <a href="https://docs.oracle.com/en/java/javase/25/docs/api/java.base/java/lang/Deprecated.html" title="class or interface in java.lang" class="external-link"><code>Deprecated</code></a>. The non-deprecated method must use more generic or the
same parameter types. For example, this allows to evolve message with parameter <a href="https://docs.oracle.com/en/java/javase/25/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link"><code>String</code></a> to
evolve into <a href="https://docs.oracle.com/en/java/javase/25/docs/api/java.base/java/lang/Object.html" title="class or interface in java.lang" class="external-link"><code>Object</code></a>. It is also possible to add or remove parameter types in the
non-deprecated method. These restrictions are necessary in order to ensure that exports of that
message never export the new overload after recompilation unless the parameter types were
updated.</div>
<dl class="notes">
<dt>Since:</dt>
<dd>19.0</dd>
<dt>See Also:</dt>
<dd>
<ul class="tag-list-long">
<li><a href="GenerateLibrary.DefaultExport.html" title="annotation interface in com.oracle.truffle.api.library">to specify default exports.</a></li>
<li><a href="GenerateLibrary.Abstract.html" title="annotation interface in com.oracle.truffle.api.library">to make messages abstract if they have a default implemetnation</a></li>
</ul>
</dd>
</dl>
</div>
</section>
<section class="summary">
<ul class="summary-list">
<!-- ======== NESTED CLASS SUMMARY ======== -->
<li>
<section class="nested-class-summary" id="nested-class-summary">
<h2>Nested Class Summary</h2>
<div class="caption"><span>Nested Classes</span></div>
<div class="summary-table three-column-summary">
<div class="table-header col-first">Modifier and Type</div>
<div class="table-header col-second">Class</div>
<div class="table-header col-last">Description</div>
<div class="col-first even-row-color"><code>static @interface&nbsp;</code></div>
<div class="col-second even-row-color"><code><a href="GenerateLibrary.Abstract.html" class="type-name-link" title="annotation interface in com.oracle.truffle.api.library">GenerateLibrary.Abstract</a></code></div>
<div class="col-last even-row-color">
<div class="block">Makes a library message abstract, but allows to keep a default implementation.</div>
</div>
<div class="col-first odd-row-color"><code>static @interface&nbsp;</code></div>
<div class="col-second odd-row-color"><code><a href="GenerateLibrary.DefaultExport.html" class="type-name-link" title="annotation interface in com.oracle.truffle.api.library">GenerateLibrary.DefaultExport</a></code></div>
<div class="col-last odd-row-color">
<div class="block">Specifies <a href="GenerateLibrary.html" title="annotation interface in com.oracle.truffle.api.library"><code>library</code></a> implementations provided by default as a fallback.</div>
</div>
</div>
</section>
</li>
<!-- =========== ANNOTATION INTERFACE OPTIONAL MEMBER SUMMARY =========== -->
<li>
<section class="member-summary" id="annotation-interface-optional-element-summary">
<h2>Optional Element Summary</h2>
<div class="caption"><span>Optional Elements</span></div>
<div class="summary-table three-column-summary">
<div class="table-header col-first">Modifier and Type</div>
<div class="table-header col-second">Optional Element</div>
<div class="table-header col-last">Description</div>
<div class="col-first even-row-color"><code><a href="https://docs.oracle.com/en/java/javase/25/docs/api/java.base/java/lang/Class.html" title="class or interface in java.lang" class="external-link">Class</a><wbr>&lt;? extends <a href="Library.html" title="class in com.oracle.truffle.api.library">Library</a>&gt;</code></div>
<div class="col-second even-row-color"><code><a href="#assertions()" class="member-name-link">assertions</a></code></div>
<div class="col-last even-row-color">
<div class="block">Specifies an assertion wrapper class that can be used to verify pre and post conditions of a
library.</div>
</div>
<div class="col-first odd-row-color"><code>boolean</code></div>
<div class="col-second odd-row-color"><code><a href="#defaultExportLookupEnabled()" class="member-name-link">defaultExportLookupEnabled</a></code></div>
<div class="col-last odd-row-color">
<div class="block">Allows the library to lookup additional default exports using a service provider interface.</div>
</div>
<div class="col-first even-row-color"><code>boolean</code></div>
<div class="col-second even-row-color"><code><a href="#dynamicDispatchEnabled()" class="member-name-link">dynamicDispatchEnabled</a></code></div>
<div class="col-last even-row-color">
<div class="block">Allows the use of <a href="DynamicDispatchLibrary.html" title="class in com.oracle.truffle.api.library"><code>DynamicDispatchLibrary</code></a> with this library.</div>
</div>
<div class="col-first odd-row-color"><code>boolean</code></div>
<div class="col-second odd-row-color"><code><a href="#pushEncapsulatingNode()" class="member-name-link">pushEncapsulatingNode</a></code></div>
<div class="col-last odd-row-color">
<div class="block">Enables push and pop of the encapsulating node when a library transitions from cached to
uncached.</div>
</div>
<div class="col-first even-row-color"><code><a href="https://docs.oracle.com/en/java/javase/25/docs/api/java.base/java/lang/Class.html" title="class or interface in java.lang" class="external-link">Class</a><wbr>&lt;?&gt;</code></div>
<div class="col-second even-row-color"><code><a href="#receiverType()" class="member-name-link">receiverType</a></code></div>
<div class="col-last even-row-color">
<div class="block">Restricts the receiver type for exports that implement this library.</div>
</div>
</div>
</section>
</li>
</ul>
</section>
<section class="details" id="annotation-interface-element-detail">
<ul class="details-list">
<!-- ============ ANNOTATION INTERFACE MEMBER DETAIL =========== -->
<li>
<section class="member-details">
<h2>Element Details</h2>
<ul class="member-list">
<li>
<section class="detail" id="assertions()">
<h3>assertions</h3>
<div class="horizontal-scroll">
<div class="member-signature"><span class="return-type"><a href="https://docs.oracle.com/en/java/javase/25/docs/api/java.base/java/lang/Class.html" title="class or interface in java.lang" class="external-link">Class</a>&lt;? extends <a href="Library.html" title="class in com.oracle.truffle.api.library">Library</a>&gt;</span>&nbsp;<span class="element-name">assertions</span></div>
<div class="block">Specifies an assertion wrapper class that can be used to verify pre and post conditions of a
library. Assertion wrappers are only inserted when assertions (-ea) are enabled. It is
required that assertion wrappers don't introduce additional side-effects and call the
delegate methods exactly once. If assertions are disabled no library wrapper will be inserted
therefore not performing any checks when library messages are invoked.
<p>

<b>Example Usage:</b>

<pre>
&#64;GenerateLibrary(assertions = ArrayAssertions.class)
public abstract class ArrayLibrary extends Library {

    public boolean isArray(Object receiver) {
        return false;
    }

    public int read(Object receiver, int index) {
        throw new UnsupportedOperationException();
    }

    static class ArrayAssertions extends ArrayLibrary {

        &#64;Child private ArrayLibrary delegate;

        ArrayAssertions(ArrayLibrary delegate) {
            this.delegate = delegate;
        }

        &#64;Override
        public boolean isArray(Object receiver) {
            return delegate.isArray(receiver);
        }

        &#64;Override
        public int read(Object receiver, int index) {
            int result = super.read(receiver, index);
            assert delegate.isArray(receiver) : "if a read was successful the receiver must be an array";
            return result;
        }

        &#64;Override
        public boolean accepts(Object receiver) {
            return delegate.accepts(receiver);
        }
    }
}

</pre></div>
<dl class="notes">
<dt>Since:</dt>
<dd>19.0</dd>
</dl>
<dl class="notes">
<dt>Default:</dt>
<dd><code>com.oracle.truffle.api.library.Library.class</code></dd>
</dl>
</div>
</section>
</li>
<li>
<section class="detail" id="receiverType()">
<h3>receiverType</h3>
<div class="horizontal-scroll">
<div class="member-signature"><span class="return-type"><a href="https://docs.oracle.com/en/java/javase/25/docs/api/java.base/java/lang/Class.html" title="class or interface in java.lang" class="external-link">Class</a>&lt;?&gt;</span>&nbsp;<span class="element-name">receiverType</span></div>
<div class="block">Restricts the receiver type for exports that implement this library. This allows to have
different receiver type in message methods, but require export receiver types to implement or
extend a declared class. Default exports are not affected by this restriction and can
therefore export the library for any receiver type the message methods first parameter is
compatible with.</div>
<dl class="notes">
<dt>Since:</dt>
<dd>19.0</dd>
</dl>
<dl class="notes">
<dt>Default:</dt>
<dd><code>java.lang.Object.class</code></dd>
</dl>
</div>
</section>
</li>
<li>
<section class="detail" id="defaultExportLookupEnabled()">
<h3>defaultExportLookupEnabled</h3>
<div class="horizontal-scroll">
<div class="member-signature"><span class="return-type">boolean</span>&nbsp;<span class="element-name">defaultExportLookupEnabled</span></div>
<div class="block">Allows the library to lookup additional default exports using a service provider interface.
<a href="ExportLibrary.html" title="annotation interface in com.oracle.truffle.api.library"><code>Exports</code></a> for this library with explicit receiver type will automatically
be interpreted as additional default exports. External default exports may specify with the
<a href="ExportLibrary.html#priority()"><code>priority</code></a> whether they are looked up before or after existing
default exports specified for the library. Default exports always have a lower priority than
explicit exports on the receiver type or exports that use dynamic dispatch.</div>
<dl class="notes">
<dt>Since:</dt>
<dd>20.1</dd>
<dt>See Also:</dt>
<dd>
<ul class="tag-list">
<li><a href="ExportLibrary.html#priority()"><code>ExportLibrary.priority()</code></a></li>
</ul>
</dd>
</dl>
<dl class="notes">
<dt>Default:</dt>
<dd><code>false</code></dd>
</dl>
</div>
</section>
</li>
<li>
<section class="detail" id="dynamicDispatchEnabled()">
<h3>dynamicDispatchEnabled</h3>
<div class="horizontal-scroll">
<div class="member-signature"><span class="return-type">boolean</span>&nbsp;<span class="element-name">dynamicDispatchEnabled</span></div>
<div class="block">Allows the use of <a href="DynamicDispatchLibrary.html" title="class in com.oracle.truffle.api.library"><code>DynamicDispatchLibrary</code></a> with this library. By default, dynamic
dispatch is enabled. If this flag is set to <code>false</code> then the
<a href="DynamicDispatchLibrary.html#dispatch(java.lang.Object)"><code>dispatch</code></a> method will not be used for this
library. Only default exports and exports declared with the receiver type will be used
instead for this library.</div>
<dl class="notes">
<dt>Since:</dt>
<dd>20.1</dd>
</dl>
<dl class="notes">
<dt>Default:</dt>
<dd><code>true</code></dd>
</dl>
</div>
</section>
</li>
<li>
<section class="detail" id="pushEncapsulatingNode()">
<h3>pushEncapsulatingNode</h3>
<div class="horizontal-scroll">
<div class="member-signature"><span class="return-type">boolean</span>&nbsp;<span class="element-name">pushEncapsulatingNode</span></div>
<div class="block">Enables push and pop of the encapsulating node when a library transitions from cached to
uncached. The current encapsulating node is needed for correct stack trace location when
library exports perform guest language calls. If a library is known to never need correct
stack trace information, e.g. if all exports are known to not perform guest language calls,
then pushing and popping of encapsulating nodes can be disabled. By default pushing and
popping of encapsulating nodes is enabled.</div>
<dl class="notes">
<dt>Since:</dt>
<dd>20.3</dd>
<dt>See Also:</dt>
<dd>
<ul class="tag-list">
<li><a href="../nodes/EncapsulatingNodeReference.html" title="class in com.oracle.truffle.api.nodes"><code>EncapsulatingNodeReference</code></a></li>
</ul>
</dd>
</dl>
<dl class="notes">
<dt>Default:</dt>
<dd><code>true</code></dd>
</dl>
</div>
</section>
</li>
</ul>
</section>
</li>
</ul>
</section>
<!-- ========= END OF CLASS DATA ========= -->
<footer role="contentinfo">
<hr>
<p class="legal-copy"><small><center>Copyright &copy; 2012, 2025, Oracle and/or its affiliates. All rights reserved.</center></small></p>
</footer>
</main>
</div>
</body>
</html>
