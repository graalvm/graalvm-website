<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc -->
<title>CachedLibrary (GraalVM Truffle Java API Reference)</title>
<link rel="stylesheet" type="text/css" href="../../../../../stylesheet.css" title="Style">
<script type="text/javascript" src="../../../../../script.js"></script>
</head>
<body>
<script type="text/javascript"><!--
    try {
        if (location.href.indexOf('is-external=true') == -1) {
            parent.document.title="CachedLibrary (GraalVM Truffle Java API Reference)";
        }
    }
    catch(err) {
    }
//-->
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar.top">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.top" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.top.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../index-all.html">Index</a></li>
<li><a href="../../../../../help-doc.html">Help</a></li>
</ul>
<div class="aboutLanguage"><b>GraalVM Truffle Java API Reference<br>20.2.0-dev</b><br>8aac8f4686f75b1a02f220e10b81130edc2cd9f2</div>
</div>
<div class="subNav">
<ul class="navList">
<li>Prev&nbsp;Class</li>
<li><a href="../../../../../com/oracle/truffle/api/library/DefaultExportProvider.html" title="interface in com.oracle.truffle.api.library"><span class="typeNameLink">Next&nbsp;Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../../index.html?com/oracle/truffle/api/library/CachedLibrary.html" target="_top">Frames</a></li>
<li><a href="CachedLibrary.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Required&nbsp;|&nbsp;</li>
<li><a href="#annotation.type.optional.element.summary">Optional</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#annotation.type.element.detail">Element</a></li>
</ul>
</div>
<a name="skip.navbar.top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="subTitle">com.oracle.truffle.api.library</div>
<h2 title="Annotation Type CachedLibrary" class="title">Annotation Type CachedLibrary</h2>
</div>
<div class="contentContainer">
<div class="description">
<ul class="blockList">
<li class="blockList">
<hr>
<br>
<pre><a href="http://docs.oracle.com/javase/8/docs/api/java/lang/annotation/Retention.html?is-external=true" title="class or interface in java.lang.annotation">@Retention</a>(<a href="http://docs.oracle.com/javase/8/docs/api/java/lang/annotation/Retention.html?is-external=true#value--" title="class or interface in java.lang.annotation">value</a>=<a href="http://docs.oracle.com/javase/8/docs/api/java/lang/annotation/RetentionPolicy.html?is-external=true#CLASS" title="class or interface in java.lang.annotation">CLASS</a>)
 <a href="http://docs.oracle.com/javase/8/docs/api/java/lang/annotation/Target.html?is-external=true" title="class or interface in java.lang.annotation">@Target</a>(<a href="http://docs.oracle.com/javase/8/docs/api/java/lang/annotation/Target.html?is-external=true#value--" title="class or interface in java.lang.annotation">value</a>=<a href="http://docs.oracle.com/javase/8/docs/api/java/lang/annotation/ElementType.html?is-external=true#PARAMETER" title="class or interface in java.lang.annotation">PARAMETER</a>)
public @interface <span class="memberNameLabel">CachedLibrary</span></pre>
<div class="block">The cached library annotation allows to use <a href="../../../../../com/oracle/truffle/api/library/package-summary.html"><code>Truffle
 Libraries</code></a> conveniently in <a href="../../../../../com/oracle/truffle/api/dsl/Specialization.html" title="annotation in com.oracle.truffle.api.dsl"><code>specializations</code></a> or <a href="../../../../../com/oracle/truffle/api/library/ExportMessage.html" title="annotation in com.oracle.truffle.api.library"><code>exported messages</code></a>. It is designed as the primary way of using libraries. The
 <a href="../../../../../com/oracle/truffle/api/library/CachedLibrary.html" title="annotation in com.oracle.truffle.api.library"><code>CachedLibrary</code></a> annotation may be used for any parameters of methods annotated with
 <a href="../../../../../com/oracle/truffle/api/dsl/Specialization.html" title="annotation in com.oracle.truffle.api.dsl">@Specialization</a> or <a href="../../../../../com/oracle/truffle/api/library/ExportMessage.html" title="annotation in com.oracle.truffle.api.library">@ExportMessage</a>.

 <h3>Using Specialized Libraries</h3>

 A cached library can be specialized for a value that is referred to with the <a href="../../../../../com/oracle/truffle/api/library/CachedLibrary.html#value--"><code>value expression</code></a> attribute. A specialized library implicitly prepends a guard for the
 <a href="../../../../../com/oracle/truffle/api/library/Library.html#accepts-java.lang.Object-"><code>acceptance</code></a> of a library with the provided value expression.
 Adding the acceptance guard leads to multiple specialization instances as it binds to the cached
 library value. The <a href="../../../../../com/oracle/truffle/api/dsl/Specialization.html#limit--"><code>specialization</code></a> or <a href="../../../../../com/oracle/truffle/api/library/ExportMessage.html#limit--"><code>export</code></a> limit attribute must therefore be specified. If this limit overflows then the operation
 will rewrite itself to an <a href="../../../../../com/oracle/truffle/api/library/LibraryFactory.html#getUncached-java.lang.Object-"><code>uncached</code></a> version of the
 library. Multiple specialized libraries may be used per export or specialization. The acceptance
 guards for these libraries will be added in the order of their declaration.
 <p>
 <h4>Usage:</h4>

 <pre>
 &#64;NodeChild
 &#64;NodeChild
 abstract static class ArrayReadNode extends ExpressionNode {
     &#64;Specialization(guards = "arrays.isArray(array)", limit = "2")
     int doDefault(Object array, int index,
                     &#64;CachedLibrary("array") ArrayLibrary arrays) {
         return arrays.read(array, index);
     }
 }
 </pre>

 <p>
 It is recommended to use the plural of the specialized parameter name as naming convention for
 the library parameter name, e.g. a library for an <code>array</code> value is called
 <code>arrays</code>. If multiple libraries are specialized for the same specialized expression it
 is recommended to prepend the library name e.g. <code>interopArrays</code>.

 <h3>Using Dispatched Libraries</h3>
 <p>
 If no specialized value expression can be specified, i.e. if the value is computed as part of the
 operation, then a dispatched version of a library can be used by omitting the <a href="../../../../../com/oracle/truffle/api/library/CachedLibrary.html#value--"><code>value</code></a> attribute and specifying the <a href="../../../../../com/oracle/truffle/api/library/CachedLibrary.html#limit--"><code>CachedLibrary.limit()</code></a> attribute instead. A dispatched library
 builds the specialized value inline cache internally for each invocation of a message instead of
 once per outer specialization or export. An instance of a dispatched library therefore
 <a href="../../../../../com/oracle/truffle/api/library/Library.html#accepts-java.lang.Object-"><code>accepts</code></a> any value as receiver. It is recommended to use the same
 generic library instance for few message invocations of similar values only, could lead to
 duplication of inline cache dispatches in the compiled code. The limit of a dispatched library
 may be set to 0 to directly switch to an uncached version of a library.
 <p>

 <h4>Usage:</h4>

 The following example combines the use of specialized and dispatched libraries. In this example
 the array is read twice. For the first <i>outer</i> read the specializing expression can be used.
 For the second read the specializing expression cannot be used as it depends on the result of the
 outer read. We therefore use a dispatched library for the inner array.

 <pre>
 &#64;NodeChild
 &#64;NodeChild
 &#64;NodeChild
 abstract static class TwoDimReadNode extends ExpressionNode {
     &#64;Specialization(guards = "outerArrays.isArray(array)", limit = "2")
     int doDefault(Object array, int outerIndex, int innerIndex,
                     &#64;CachedLibrary("array") ArrayLibrary outerArrays,
                     &#64;CachedLibrary(limit = "2") ArrayLibrary innerArrays) {
         return innerArrays.read(outerArrays.read(outerIndex), innerIndex);
     }
 }
 </pre></div>
<dl>
<dt><span class="simpleTagLabel">Since:</span></dt>
<dd>19.0</dd>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../../com/oracle/truffle/api/library/LibraryFactory.html" title="class in com.oracle.truffle.api.library"><code>for manually instantiating libraries</code></a>, 
<a href="../../../../../com/oracle/truffle/api/library/package-summary.html"><code>Truffle Library reference documentation</code></a></dd>
</dl>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- =========== ANNOTATION TYPE OPTIONAL MEMBER SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="annotation.type.optional.element.summary">
<!--   -->
</a>
<h3>Optional Element Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Optional Element Summary table, listing optional elements, and an explanation">
<caption><span>Optional Elements</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Optional Element and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code><a href="http://docs.oracle.com/javase/8/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../com/oracle/truffle/api/library/CachedLibrary.html#limit--">limit</a></span></code>
<div class="block">Sets the limit expression when using dispatched libraries.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code><a href="http://docs.oracle.com/javase/8/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../com/oracle/truffle/api/library/CachedLibrary.html#value--">value</a></span></code>
<div class="block">Sets the specialized value expression when using specialized libraries.</div>
</td>
</tr>
</table>
</li>
</ul>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ============ ANNOTATION TYPE MEMBER DETAIL =========== -->
<ul class="blockList">
<li class="blockList"><a name="annotation.type.element.detail">
<!--   -->
</a>
<h3>Element Detail</h3>
<a name="value--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>value</h4>
<pre>public abstract&nbsp;<a href="http://docs.oracle.com/javase/8/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a>&nbsp;value</pre>
<div class="block">Sets the specialized value expression when using specialized libraries. The same syntax
 applies as for <a href="../../../../../com/oracle/truffle/api/dsl/Cached.html" title="annotation in com.oracle.truffle.api.dsl"><code>Cached</code></a> value expressions.</div>
<dl>
<dt><span class="simpleTagLabel">Since:</span></dt>
<dd>19.0</dd>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../../com/oracle/truffle/api/library/CachedLibrary.html" title="annotation in com.oracle.truffle.api.library"><code>for usage examples.</code></a></dd>
</dl>
<dl>
<dt>Default:</dt>
<dd>""</dd>
</dl>
</li>
</ul>
</li>
</ul>
<ul class="blockList">
<li class="blockList"><a name="limit--">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>limit</h4>
<pre>public abstract&nbsp;<a href="http://docs.oracle.com/javase/8/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a>&nbsp;limit</pre>
<div class="block">Sets the limit expression when using dispatched libraries. The limit expression sets the
 number of internally dispatched specialized libraries until an
 <a href="../../../../../com/oracle/truffle/api/library/LibraryFactory.html#getUncached--"><code>uncached</code></a> version of the library will be used.</div>
<dl>
<dt><span class="simpleTagLabel">Since:</span></dt>
<dd>19.0</dd>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../../com/oracle/truffle/api/library/CachedLibrary.html" title="annotation in com.oracle.truffle.api.library"><code>for usage examples.</code></a></dd>
</dl>
<dl>
<dt>Default:</dt>
<dd>""</dd>
</dl>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<!-- ========= END OF CLASS DATA ========= -->
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar.bottom">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.bottom" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.bottom.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../index-all.html">Index</a></li>
<li><a href="../../../../../help-doc.html">Help</a></li>
</ul>
<div class="aboutLanguage"><b>GraalVM Truffle Java API Reference<br>20.2.0-dev</b><br>8aac8f4686f75b1a02f220e10b81130edc2cd9f2</div>
</div>
<div class="subNav">
<ul class="navList">
<li>Prev&nbsp;Class</li>
<li><a href="../../../../../com/oracle/truffle/api/library/DefaultExportProvider.html" title="interface in com.oracle.truffle.api.library"><span class="typeNameLink">Next&nbsp;Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../../index.html?com/oracle/truffle/api/library/CachedLibrary.html" target="_top">Frames</a></li>
<li><a href="CachedLibrary.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Required&nbsp;|&nbsp;</li>
<li><a href="#annotation.type.optional.element.summary">Optional</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#annotation.type.element.detail">Element</a></li>
</ul>
</div>
<a name="skip.navbar.bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
<p class="legalCopy"><small><center>Copyright &copy; 2012, 2020, Oracle and/or its affiliates. All rights reserved.</center></small></p>
</body>
</html>
