<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc -->
<title>InstrumentableNode (GraalVM Truffle Java API Reference)</title>
<link rel="stylesheet" type="text/css" href="../../../../../stylesheet.css" title="Style">
<script type="text/javascript" src="../../../../../script.js"></script>
</head>
<body>
<script type="text/javascript"><!--
    try {
        if (location.href.indexOf('is-external=true') == -1) {
            parent.document.title="InstrumentableNode (GraalVM Truffle Java API Reference)";
        }
    }
    catch(err) {
    }
//-->
var methods = {"i0":6,"i1":17,"i2":18,"i3":18,"i4":18,"i5":6,"i6":18};
var tabs = {65535:["t0","All Methods"],1:["t1","Static Methods"],2:["t2","Instance Methods"],4:["t3","Abstract Methods"],16:["t5","Default Methods"]};
var altColor = "altColor";
var rowColor = "rowColor";
var tableTab = "tableTab";
var activeTableTab = "activeTableTab";
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar.top">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.top" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.top.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../index-all.html">Index</a></li>
<li><a href="../../../../../help-doc.html">Help</a></li>
</ul>
<div class="aboutLanguage"><b>GraalVM Truffle Java API Reference<br>21.3.0-dev</b><br>44d3ba029ef261aefaf3371e8fee9403c5e88ab4</div>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../../com/oracle/truffle/api/instrumentation/GenerateWrapper.OutgoingConverter.html" title="annotation in com.oracle.truffle.api.instrumentation"><span class="typeNameLink">Prev&nbsp;Class</span></a></li>
<li><a href="../../../../../com/oracle/truffle/api/instrumentation/InstrumentableNode.WrapperNode.html" title="interface in com.oracle.truffle.api.instrumentation"><span class="typeNameLink">Next&nbsp;Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../../index.html?com/oracle/truffle/api/instrumentation/InstrumentableNode.html" target="_top">Frames</a></li>
<li><a href="InstrumentableNode.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li><a href="#nested.class.summary">Nested</a>&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a name="skip.navbar.top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="subTitle">com.oracle.truffle.api.instrumentation</div>
<h2 title="Interface InstrumentableNode" class="title">Interface InstrumentableNode</h2>
</div>
<div class="contentContainer">
<div class="description">
<ul class="blockList">
<li class="blockList">
<dl>
<dt>All Superinterfaces:</dt>
<dd><a href="../../../../../com/oracle/truffle/api/nodes/NodeInterface.html" title="interface in com.oracle.truffle.api.nodes">NodeInterface</a></dd>
</dl>
<hr>
<br>
<pre>public interface <span class="typeNameLabel">InstrumentableNode</span>
extends <a href="../../../../../com/oracle/truffle/api/nodes/NodeInterface.html" title="interface in com.oracle.truffle.api.nodes">NodeInterface</a></pre>
<div class="block">Interface implemented by AST <a href="../../../../../com/oracle/truffle/api/nodes/Node.html" title="class in com.oracle.truffle.api.nodes"><code>nodes</code></a> that may be <em>instrumentable</em>: an AST
 location where <a href="../../../../../com/oracle/truffle/api/instrumentation/TruffleInstrument.html" title="class in com.oracle.truffle.api.instrumentation">Truffle
 instruments</a> are permitted to listen to before and after using execution event listeners.
 <p>
 If a node is instrumentable depends on the return value of <a href="../../../../../com/oracle/truffle/api/instrumentation/InstrumentableNode.html#isInstrumentable--"><code>InstrumentableNode.isInstrumentable()</code></a>. All
 instrumentable nodes must also extend <a href="../../../../../com/oracle/truffle/api/nodes/Node.html" title="class in com.oracle.truffle.api.nodes"><code>node</code></a>. All other member methods of this
 interface are only allowed to be invoked if <a href="../../../../../com/oracle/truffle/api/instrumentation/InstrumentableNode.html#isInstrumentable--"><code>InstrumentableNode.isInstrumentable()</code></a> returns <code>true</code>
 .
 <p>
 Every instrumentable node is required to create a wrapper for this instrumentable node in
 <a href="../../../../../com/oracle/truffle/api/instrumentation/InstrumentableNode.html#createWrapper-com.oracle.truffle.api.instrumentation.ProbeNode-"><code>InstrumentableNode.createWrapper(ProbeNode)</code></a>. The instrumentation framework will, when needed during
 execution, <a href="../../../../../com/oracle/truffle/api/nodes/Node.html#replace-T-"><code>replace</code></a> the instrumentable node with a <a href="../../../../../com/oracle/truffle/api/instrumentation/InstrumentableNode.WrapperNode.html" title="interface in com.oracle.truffle.api.instrumentation"><code>wrapper</code></a> and delegate to the original node. After the replacement of an instrumentable node with
 a wrapper we refer to the original node as an instrumented node.
 <p>
 Wrappers can be generated automatically using an annotation processor by annotating the class
 with @<a href="../../../../../com/oracle/truffle/api/instrumentation/GenerateWrapper.html" title="annotation in com.oracle.truffle.api.instrumentation"><code>GenerateWrapper</code></a>. If an instrumentable node subclass has additional declared methods
 than its instrumentable base class that are used by other nodes, then a new wrapper should be
 generated or implemented for the subclass, otherwise the replacement of the wrapper will fail.
 <p>
 Instrumentable nodes may return <code>true</code> to indicate that they were tagged by <a href="../../../../../com/oracle/truffle/api/instrumentation/Tag.html" title="class in com.oracle.truffle.api.instrumentation"><code>tag</code></a>. Tags are used by guest languages to indicate that a <a href="../../../../../com/oracle/truffle/api/nodes/Node.html" title="class in com.oracle.truffle.api.nodes"><code>node</code></a> is a member of a
 certain category of nodes. For example a debugger
 <a href="../../../../../com/oracle/truffle/api/instrumentation/TruffleInstrument.html" title="class in com.oracle.truffle.api.instrumentation"><code>instrument</code></a> might require a guest
 language to tag all nodes as <a href="../../../../../com/oracle/truffle/api/instrumentation/StandardTags.StatementTag.html" title="class in com.oracle.truffle.api.instrumentation"><code>statements</code></a> that should be
 considered as such. See <a href="../../../../../com/oracle/truffle/api/instrumentation/InstrumentableNode.html#hasTag-java.lang.Class-"><code>InstrumentableNode.hasTag(Class)</code></a> for further details on how to use tags.
 <p>
 <b>Example minimal implementation of an instrumentable node:</b>

 <pre>&#064;<a href="../../../../../com/oracle/truffle/api/instrumentation/GenerateWrapper.html" title="annotation in com.oracle.truffle.api.instrumentation"><code>GenerateWrapper</code></a>
<b>abstract</b> <b>static</b> <b>class</b> SimpleNode <b>extends</b> <a href="../../../../../com/oracle/truffle/api/nodes/Node.html" title="class in com.oracle.truffle.api.nodes"><code>Node</code></a>
                <b>implements</b> <a href="../../../../../com/oracle/truffle/api/instrumentation/InstrumentableNode.html" title="interface in com.oracle.truffle.api.instrumentation"><code>InstrumentableNode</code></a> {

    <b>public</b> <b>abstract</b> <a href="http://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang"><code>Object</code></a> execute(<a href="../../../../../com/oracle/truffle/api/frame/VirtualFrame.html" title="interface in com.oracle.truffle.api.frame"><code>VirtualFrame</code></a> frame);

    <b>public</b> <b>boolean</b> isInstrumentable() {
        <b>return</b> <b>true</b>;
    }

    <b>public</b> <a href="../../../../../com/oracle/truffle/api/instrumentation/InstrumentableNode.WrapperNode.html" title="interface in com.oracle.truffle.api.instrumentation"><code>InstrumentableNode.WrapperNode</code></a> createWrapper(<a href="../../../../../com/oracle/truffle/api/instrumentation/ProbeNode.html" title="class in com.oracle.truffle.api.instrumentation"><code>ProbeNode</code></a> probe) {
        <em>// ASTNodeWrapper is generated by &#064;GenerateWrapper</em>
        <b>return</b> <b>new</b> SimpleNodeWrapper(<b>this</b>, probe);
    }
}
</pre>

 <p>
 Example for a typical implementation of an instrumentable node with support for source
 sections:</b>
 <pre>&#064;<a href="../../../../../com/oracle/truffle/api/instrumentation/GenerateWrapper.html" title="annotation in com.oracle.truffle.api.instrumentation"><code>GenerateWrapper</code></a>
<b>abstract</b> <b>static</b> <b>class</b> RecommendedNode <b>extends</b> <a href="../../../../../com/oracle/truffle/api/nodes/Node.html" title="class in com.oracle.truffle.api.nodes"><code>Node</code></a>
                <b>implements</b> <a href="../../../../../com/oracle/truffle/api/instrumentation/InstrumentableNode.html" title="interface in com.oracle.truffle.api.instrumentation"><code>InstrumentableNode</code></a> {

    <b>private</b> <b>static</b> <b>final</b> <b>int</b> NO_SOURCE = -1;

    <b>private</b> <b>int</b> sourceCharIndex = NO_SOURCE;
    <b>private</b> <b>int</b> sourceLength;

    <b>public</b> <b>abstract</b> <a href="http://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang"><code>Object</code></a> execute(<a href="../../../../../com/oracle/truffle/api/frame/VirtualFrame.html" title="interface in com.oracle.truffle.api.frame"><code>VirtualFrame</code></a> frame);

    <em>// invoked by the parser to set the source</em>
    <b>void</b> setSourceSection(<b>int</b> charIndex, <b>int</b> length) {
        <b>assert</b> sourceCharIndex == NO_SOURCE : <em>"source should only be set once"</em>;
        <b>this</b>.sourceCharIndex = charIndex;
        <b>this</b>.sourceLength = length;
    }

    <b>public</b> <b>final</b> <b>boolean</b> isInstrumentable() {
        <em>// all AST nodes with source are instrumentable</em>
        <b>return</b> sourceCharIndex != NO_SOURCE;
    }

    &#064;<a href="http://docs.oracle.com/javase/8/docs/api/java/lang/Override.html?is-external=true" title="class or interface in java.lang"><code>Override</code></a>
    &#064;<a href="../../../../../com/oracle/truffle/api/CompilerDirectives.TruffleBoundary.html" title="annotation in com.oracle.truffle.api"><code>CompilerDirectives.TruffleBoundary</code></a>
    <b>public</b> <b>final</b> <a href="../../../../../com/oracle/truffle/api/source/SourceSection.html" title="class in com.oracle.truffle.api.source"><code>SourceSection</code></a> getSourceSection() {
        <b>if</b> (sourceCharIndex == NO_SOURCE) {
            <em>// AST node without source</em>
            <b>return</b> <b>null</b>;
        }
        <a href="../../../../../com/oracle/truffle/api/nodes/RootNode.html" title="class in com.oracle.truffle.api.nodes"><code>RootNode</code></a> rootNode = getRootNode();
        <b>if</b> (rootNode == <b>null</b>) {
            <em>// not yet adopted yet</em>
            <b>return</b> <b>null</b>;
        }
        <a href="../../../../../com/oracle/truffle/api/source/Source.html" title="class in com.oracle.truffle.api.source"><code>Source</code></a> source = rootNode.getSourceSection().getSource();
        <b>return</b> source.createSection(sourceCharIndex, sourceLength);
    }

    <b>public</b> <a href="../../../../../com/oracle/truffle/api/instrumentation/InstrumentableNode.WrapperNode.html" title="interface in com.oracle.truffle.api.instrumentation"><code>InstrumentableNode.WrapperNode</code></a> createWrapper(<a href="../../../../../com/oracle/truffle/api/instrumentation/ProbeNode.html" title="class in com.oracle.truffle.api.instrumentation"><code>ProbeNode</code></a> probe) {
        <em>// ASTNodeWrapper is generated by &#064;GenerateWrapper</em>
        <b>return</b> <b>new</b> RecommendedNodeWrapper(<b>this</b>, probe);
    }
}
</pre>
 <p></div>
<dl>
<dt><span class="simpleTagLabel">Since:</span></dt>
<dd>0.33</dd>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../../com/oracle/truffle/api/instrumentation/InstrumentableNode.html#isInstrumentable--"><code>to decide whether node is instrumentable.</code></a>, 
<a href="../../../../../com/oracle/truffle/api/instrumentation/InstrumentableNode.html#hasTag-java.lang.Class-"><code>Implement hasTag to decide whether an instrumentable node is tagged with a
      tag.</code></a>, 
<a href="../../../../../com/oracle/truffle/api/instrumentation/GenerateWrapper.html" title="annotation in com.oracle.truffle.api.instrumentation"><code>Use an annotation processor to generate the wrapper class.</code></a>, 
<a href="../../../../../com/oracle/truffle/api/instrumentation/Instrumenter.html#attachExecutionEventListener-com.oracle.truffle.api.instrumentation.SourceSectionFilter-T-"><code>Instrumenter.attachExecutionEventListener(SourceSectionFilter, ExecutionEventListener)</code></a></dd>
</dl>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- ======== NESTED CLASS SUMMARY ======== -->
<ul class="blockList">
<li class="blockList"><a name="nested.class.summary">
<!--   -->
</a>
<h3>Nested Class Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Nested Class Summary table, listing nested classes, and an explanation">
<caption><span>Nested Classes</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Interface and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>static interface&nbsp;</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../com/oracle/truffle/api/instrumentation/InstrumentableNode.WrapperNode.html" title="interface in com.oracle.truffle.api.instrumentation">InstrumentableNode.WrapperNode</a></span></code>
<div class="block">Nodes that the instrumentation framework inserts into guest language ASTs (between
 <a href="../../../../../com/oracle/truffle/api/instrumentation/InstrumentableNode.html" title="interface in com.oracle.truffle.api.instrumentation"><code>instrumentable</code></a> guest language nodes and their parents) for the
 purpose of interposing on execution events and reporting them via the instrumentation
 framework.</div>
</td>
</tr>
</table>
</li>
</ul>
<!-- ========== METHOD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="method.summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Method Summary table, listing methods, and an explanation">
<caption><span id="t0" class="activeTableTab"><span>All Methods</span><span class="tabEnd">&nbsp;</span></span><span id="t1" class="tableTab"><span><a href="javascript:show(1);">Static Methods</a></span><span class="tabEnd">&nbsp;</span></span><span id="t2" class="tableTab"><span><a href="javascript:show(2);">Instance Methods</a></span><span class="tabEnd">&nbsp;</span></span><span id="t3" class="tableTab"><span><a href="javascript:show(4);">Abstract Methods</a></span><span class="tabEnd">&nbsp;</span></span><span id="t5" class="tableTab"><span><a href="javascript:show(16);">Default Methods</a></span><span class="tabEnd">&nbsp;</span></span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Method and Description</th>
</tr>
<tr id="i0" class="altColor">
<td class="colFirst"><code><a href="../../../../../com/oracle/truffle/api/instrumentation/InstrumentableNode.WrapperNode.html" title="interface in com.oracle.truffle.api.instrumentation">InstrumentableNode.WrapperNode</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../com/oracle/truffle/api/instrumentation/InstrumentableNode.html#createWrapper-com.oracle.truffle.api.instrumentation.ProbeNode-">createWrapper</a></span>(<a href="../../../../../com/oracle/truffle/api/instrumentation/ProbeNode.html" title="class in com.oracle.truffle.api.instrumentation">ProbeNode</a>&nbsp;probe)</code>
<div class="block">Returns a new, never adopted, unshared <a href="../../../../../com/oracle/truffle/api/instrumentation/InstrumentableNode.WrapperNode.html" title="interface in com.oracle.truffle.api.instrumentation"><code>wrapper</code></a> node implementation for
 this <a href="../../../../../com/oracle/truffle/api/instrumentation/InstrumentableNode.html" title="interface in com.oracle.truffle.api.instrumentation"><code>instrumentable</code></a> node.</div>
</td>
</tr>
<tr id="i1" class="rowColor">
<td class="colFirst"><code>static <a href="../../../../../com/oracle/truffle/api/nodes/Node.html" title="class in com.oracle.truffle.api.nodes">Node</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../com/oracle/truffle/api/instrumentation/InstrumentableNode.html#findInstrumentableParent-com.oracle.truffle.api.nodes.Node-">findInstrumentableParent</a></span>(<a href="../../../../../com/oracle/truffle/api/nodes/Node.html" title="class in com.oracle.truffle.api.nodes">Node</a>&nbsp;node)</code>
<div class="block">Find the first <a href="../../../../../com/oracle/truffle/api/instrumentation/InstrumentableNode.html#isInstrumentable--"><code>instrumentable</code></a> node on it's parent chain.</div>
</td>
</tr>
<tr id="i2" class="altColor">
<td class="colFirst"><code>default <a href="../../../../../com/oracle/truffle/api/nodes/Node.html" title="class in com.oracle.truffle.api.nodes">Node</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../com/oracle/truffle/api/instrumentation/InstrumentableNode.html#findNearestNodeAt-int-java.util.Set-">findNearestNodeAt</a></span>(int&nbsp;sourceCharIndex,
                 <a href="http://docs.oracle.com/javase/8/docs/api/java/util/Set.html?is-external=true" title="class or interface in java.util">Set</a>&lt;<a href="http://docs.oracle.com/javase/8/docs/api/java/lang/Class.html?is-external=true" title="class or interface in java.lang">Class</a>&lt;? extends <a href="../../../../../com/oracle/truffle/api/instrumentation/Tag.html" title="class in com.oracle.truffle.api.instrumentation">Tag</a>&gt;&gt;&nbsp;tags)</code>
<div class="block">Find the nearest <a href="../../../../../com/oracle/truffle/api/nodes/Node.html" title="class in com.oracle.truffle.api.nodes"><code>node</code></a> to the given source character index according to the guest
 language control flow, that is tagged with some of the given tags.</div>
</td>
</tr>
<tr id="i3" class="rowColor">
<td class="colFirst"><code>default <a href="http://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">Object</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../com/oracle/truffle/api/instrumentation/InstrumentableNode.html#getNodeObject--">getNodeObject</a></span>()</code>
<div class="block">Returns an interop capable object that contains all keys and values of attributes associated
 with this node.</div>
</td>
</tr>
<tr id="i4" class="altColor">
<td class="colFirst"><code>default boolean</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../com/oracle/truffle/api/instrumentation/InstrumentableNode.html#hasTag-java.lang.Class-">hasTag</a></span>(<a href="http://docs.oracle.com/javase/8/docs/api/java/lang/Class.html?is-external=true" title="class or interface in java.lang">Class</a>&lt;? extends <a href="../../../../../com/oracle/truffle/api/instrumentation/Tag.html" title="class in com.oracle.truffle.api.instrumentation">Tag</a>&gt;&nbsp;tag)</code>
<div class="block">Returns <code>true</code> if this node should be considered tagged by a given tag else
 <code>false</code>.</div>
</td>
</tr>
<tr id="i5" class="rowColor">
<td class="colFirst"><code>boolean</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../com/oracle/truffle/api/instrumentation/InstrumentableNode.html#isInstrumentable--">isInstrumentable</a></span>()</code>
<div class="block">Returns <code>true</code> if this node is instrumentable.</div>
</td>
</tr>
<tr id="i6" class="altColor">
<td class="colFirst"><code>default <a href="../../../../../com/oracle/truffle/api/instrumentation/InstrumentableNode.html" title="interface in com.oracle.truffle.api.instrumentation">InstrumentableNode</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../com/oracle/truffle/api/instrumentation/InstrumentableNode.html#materializeInstrumentableNodes-java.util.Set-">materializeInstrumentableNodes</a></span>(<a href="http://docs.oracle.com/javase/8/docs/api/java/util/Set.html?is-external=true" title="class or interface in java.util">Set</a>&lt;<a href="http://docs.oracle.com/javase/8/docs/api/java/lang/Class.html?is-external=true" title="class or interface in java.lang">Class</a>&lt;? extends <a href="../../../../../com/oracle/truffle/api/instrumentation/Tag.html" title="class in com.oracle.truffle.api.instrumentation">Tag</a>&gt;&gt;&nbsp;materializedTags)</code>
<div class="block">Removes optimizations performed in this AST node to restore the syntactic AST structure.</div>
</td>
</tr>
</table>
</li>
</ul>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ============ METHOD DETAIL ========== -->
<ul class="blockList">
<li class="blockList"><a name="method.detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a name="isInstrumentable--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>isInstrumentable</h4>
<pre>boolean&nbsp;isInstrumentable()</pre>
<div class="block">Returns <code>true</code> if this node is instrumentable. Instrumentable nodes are points
 where instrumenters can attach execution events. The return values of instrumentable nodes
 must always be interop capable values.
 <p>
 The implementation of this method must ensure that its result is stable after the parent
 <a href="../../../../../com/oracle/truffle/api/nodes/RootNode.html" title="class in com.oracle.truffle.api.nodes"><code>root node</code></a> was wrapped in a <a href="../../../../../com/oracle/truffle/api/CallTarget.html" title="interface in com.oracle.truffle.api"><code>CallTarget</code></a> using
 <a href="../../../../../com/oracle/truffle/api/TruffleRuntime.html#createCallTarget-com.oracle.truffle.api.nodes.RootNode-"><code>TruffleRuntime.createCallTarget(RootNode)</code></a>. The result is stable if the result of
 calling this method remains always the same.
 <p>
 This method might be called in parallel from multiple threads even if the language is single
 threaded. The method may be invoked without a language context currently being active.</div>
<dl>
<dt><span class="simpleTagLabel">Since:</span></dt>
<dd>0.33</dd>
</dl>
</li>
</ul>
<a name="createWrapper-com.oracle.truffle.api.instrumentation.ProbeNode-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>createWrapper</h4>
<pre><a href="../../../../../com/oracle/truffle/api/instrumentation/InstrumentableNode.WrapperNode.html" title="interface in com.oracle.truffle.api.instrumentation">InstrumentableNode.WrapperNode</a>&nbsp;createWrapper(<a href="../../../../../com/oracle/truffle/api/instrumentation/ProbeNode.html" title="class in com.oracle.truffle.api.instrumentation">ProbeNode</a>&nbsp;probe)</pre>
<div class="block">Returns a new, never adopted, unshared <a href="../../../../../com/oracle/truffle/api/instrumentation/InstrumentableNode.WrapperNode.html" title="interface in com.oracle.truffle.api.instrumentation"><code>wrapper</code></a> node implementation for
 this <a href="../../../../../com/oracle/truffle/api/instrumentation/InstrumentableNode.html" title="interface in com.oracle.truffle.api.instrumentation"><code>instrumentable</code></a> node. The returned wrapper implementation must
 extend the same type that implements <a href="../../../../../com/oracle/truffle/api/instrumentation/InstrumentableNode.html" title="interface in com.oracle.truffle.api.instrumentation"><code>InstrumentableNode</code></a>.
 <p>
 The instrumentation framework will, when needed during execution, <a href="../../../../../com/oracle/truffle/api/nodes/Node.html#replace-T-"><code>replace</code></a> the instrumentable node with a <a href="../../../../../com/oracle/truffle/api/instrumentation/InstrumentableNode.WrapperNode.html" title="interface in com.oracle.truffle.api.instrumentation"><code>wrapper</code></a> and delegate to the
 original node. After the replacement of an instrumentable node with a wrapper we refer to the
 original node as an instrumented node. Wrappers can be generated automatically using an
 annotation processor by annotating the class with @<a href="../../../../../com/oracle/truffle/api/instrumentation/GenerateWrapper.html" title="annotation in com.oracle.truffle.api.instrumentation"><code>GenerateWrapper</code></a>. Please note that
 if an instrumetnable node subclass has additional execute methods then a new wrapper must be
 generated or implemented. Otherwise the <a href="../../../../../com/oracle/truffle/api/nodes/Node.html#replace-T-"><code>replacement</code></a> of the
 instrumentable node with the wrapper will fail if the subtype is used as static type in nodes
 <a href="../../../../../com/oracle/truffle/api/nodes/Node.Child.html" title="annotation in com.oracle.truffle.api.nodes"><code>children</code></a>.
 <p>
 A wrapper forwards the following events concerning the delegate to the given <a href="../../../../../com/oracle/truffle/api/instrumentation/ProbeNode.html" title="class in com.oracle.truffle.api.instrumentation"><code>probe</code></a> for propagation through the instrumentation framework, e.g. to
 <a href="../../../../../com/oracle/truffle/api/instrumentation/ExecutionEventListener.html" title="interface in com.oracle.truffle.api.instrumentation">event listeners</a> bound to this guest language program
 location:
 <ul>
 <li><a href="../../../../../com/oracle/truffle/api/instrumentation/ProbeNode.html#onEnter-com.oracle.truffle.api.frame.VirtualFrame-">onEnter(Frame)</a>:
 an <em>execute</em> method on the delegate is ready to be called;</li>
 <li><a href="../../../../../com/oracle/truffle/api/instrumentation/ProbeNode.html#onReturnValue-com.oracle.truffle.api.frame.VirtualFrame-java.lang.Object-">onReturnValue(Frame,Object)</a>: an <em>execute</em> method on the delegate has just returned a
 (possibly <code>null</code>) value;</li>
 <li><a href="../../../../../com/oracle/truffle/api/instrumentation/ProbeNode.html#onReturnExceptionalOrUnwind-com.oracle.truffle.api.frame.VirtualFrame-java.lang.Throwable-boolean-">onReturnExceptionalOrUnwind(Frame,Throwable, boolean)</a>: an <em>execute</em> method on the
 delegate has just thrown an exception.</li>
 </ul>
 <p>
 This method is always invoked on an interpreter thread. The method may be invoked without a
 language context currently being active.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>probe</code> - the <a href="../../../../../com/oracle/truffle/api/instrumentation/ProbeNode.html" title="class in com.oracle.truffle.api.instrumentation"><code>probe node</code></a> to be adopted and sent execution events by the
            wrapper</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>a <a href="../../../../../com/oracle/truffle/api/instrumentation/InstrumentableNode.WrapperNode.html" title="interface in com.oracle.truffle.api.instrumentation"><code>wrapper</code></a> implementation</dd>
<dt><span class="simpleTagLabel">Since:</span></dt>
<dd>0.33</dd>
</dl>
</li>
</ul>
<a name="hasTag-java.lang.Class-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>hasTag</h4>
<pre>default&nbsp;boolean&nbsp;hasTag(<a href="http://docs.oracle.com/javase/8/docs/api/java/lang/Class.html?is-external=true" title="class or interface in java.lang">Class</a>&lt;? extends <a href="../../../../../com/oracle/truffle/api/instrumentation/Tag.html" title="class in com.oracle.truffle.api.instrumentation">Tag</a>&gt;&nbsp;tag)</pre>
<div class="block">Returns <code>true</code> if this node should be considered tagged by a given tag else
 <code>false</code>. In order for a Truffle language to support a particular tag, the tag must
 also be marked as <a href="../../../../../com/oracle/truffle/api/instrumentation/ProvidedTags.html" title="annotation in com.oracle.truffle.api.instrumentation"><code>provided</code></a> by the language.
 <p>
 Tags are used by guest languages to indicate that a <a href="../../../../../com/oracle/truffle/api/nodes/Node.html" title="class in com.oracle.truffle.api.nodes"><code>node</code></a> is a member of a
 certain category of nodes. For example a debugger <a href="../../../../../com/oracle/truffle/api/instrumentation/TruffleInstrument.html" title="class in com.oracle.truffle.api.instrumentation"><code>instrument</code></a> might
 require a guest language to tag all nodes as statements that should be considered as such.
 <p>
 The node implementor may decide how to implement tagging for nodes. The simplest way to
 implement tagging using Java types is by overriding the <a href="../../../../../com/oracle/truffle/api/instrumentation/InstrumentableNode.html#hasTag-java.lang.Class-"><code>InstrumentableNode.hasTag(Class)</code></a> method. This
 example shows how to tag a node subclass and all its subclasses as statement:

 <pre>&#064;<a href="../../../../../com/oracle/truffle/api/instrumentation/GenerateWrapper.html" title="annotation in com.oracle.truffle.api.instrumentation"><code>GenerateWrapper</code></a>
<b>abstract</b> <b>static</b> <b>class</b> StatementNode <b>extends</b> SimpleNode
                <b>implements</b> <a href="../../../../../com/oracle/truffle/api/instrumentation/InstrumentableNode.html" title="interface in com.oracle.truffle.api.instrumentation"><code>InstrumentableNode</code></a> {

    &#064;<a href="http://docs.oracle.com/javase/8/docs/api/java/lang/Override.html?is-external=true" title="class or interface in java.lang"><code>Override</code></a>
    <b>public</b> <b>final</b> <a href="http://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang"><code>Object</code></a> execute(<a href="../../../../../com/oracle/truffle/api/frame/VirtualFrame.html" title="interface in com.oracle.truffle.api.frame"><code>VirtualFrame</code></a> frame) {
        executeVoid(frame);
        <b>return</b> <b>null</b>;
    }

    <b>public</b> <b>abstract</b> <b>void</b> executeVoid(<a href="../../../../../com/oracle/truffle/api/frame/VirtualFrame.html" title="interface in com.oracle.truffle.api.frame"><code>VirtualFrame</code></a> frame);

    &#064;<a href="http://docs.oracle.com/javase/8/docs/api/java/lang/Override.html?is-external=true" title="class or interface in java.lang"><code>Override</code></a>
    <b>public</b> <b>final</b> <a href="../../../../../com/oracle/truffle/api/instrumentation/InstrumentableNode.WrapperNode.html" title="interface in com.oracle.truffle.api.instrumentation"><code>InstrumentableNode.WrapperNode</code></a> createWrapper(<a href="../../../../../com/oracle/truffle/api/instrumentation/ProbeNode.html" title="class in com.oracle.truffle.api.instrumentation"><code>ProbeNode</code></a> probe) {
        <b>return</b> StatementNodeWrapper.create(<b>this</b>, probe);
    }

    <b>public</b> <b>boolean</b> hasTag(<a href="http://docs.oracle.com/javase/8/docs/api/java/lang/Class.html?is-external=true" title="class or interface in java.lang"><code>Class</code></a>&lt;? <b>extends</b> <a href="../../../../../com/oracle/truffle/api/instrumentation/Tag.html" title="class in com.oracle.truffle.api.instrumentation"><code>Tag</code></a>&gt; tag) {
        <b>if</b> (tag == <a href="../../../../../com/oracle/truffle/api/instrumentation/StandardTags.html" title="class in com.oracle.truffle.api.instrumentation"><code>StandardTags</code></a>.StatementTag.<b>class</b>) {
            <b>return</b> <b>true</b>;
        }
        <b>return</b> <b>false</b>;
    }
}
</pre>

 <p>
 Often it is impossible to just rely on the node's Java type to implement tagging. This
 example shows how to use local state to implement tagging for a node.

 <pre>&#064;<a href="../../../../../com/oracle/truffle/api/instrumentation/GenerateWrapper.html" title="annotation in com.oracle.truffle.api.instrumentation"><code>GenerateWrapper</code></a>
<b>static</b> <b>class</b> HaltNode <b>extends</b> <a href="../../../../../com/oracle/truffle/api/nodes/Node.html" title="class in com.oracle.truffle.api.nodes"><code>Node</code></a> <b>implements</b> <a href="../../../../../com/oracle/truffle/api/instrumentation/InstrumentableNode.html" title="interface in com.oracle.truffle.api.instrumentation"><code>InstrumentableNode</code></a> {
    <b>private</b> <b>boolean</b> isDebuggerHalt;

    <b>public</b> <b>void</b> setDebuggerHalt(<b>boolean</b> isDebuggerHalt) {
        <b>this</b>.isDebuggerHalt = isDebuggerHalt;
    }

    <b>public</b> <a href="http://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang"><code>Object</code></a> execute(<a href="../../../../../com/oracle/truffle/api/frame/VirtualFrame.html" title="interface in com.oracle.truffle.api.frame"><code>VirtualFrame</code></a> frame) {
        <em>// does nothing;</em>
        <b>return</b> <b>null</b>;
    }

    <b>public</b> <b>boolean</b> isInstrumentable() {
        <b>return</b> <b>true</b>;
    }

    <b>public</b> <b>boolean</b> hasTag(<a href="http://docs.oracle.com/javase/8/docs/api/java/lang/Class.html?is-external=true" title="class or interface in java.lang"><code>Class</code></a>&lt;? <b>extends</b> <a href="../../../../../com/oracle/truffle/api/instrumentation/Tag.html" title="class in com.oracle.truffle.api.instrumentation"><code>Tag</code></a>&gt; tag) {
        <b>if</b> (tag == <a href="../../../../../com/oracle/truffle/api/debug/Debugger.html" title="class in com.oracle.truffle.api.debug"><code>Debugger</code></a>.HaltTag.<b>class</b>) {
            <b>return</b> isDebuggerHalt;
        }
        <b>return</b> <b>false</b>;
    }

    <b>public</b> <a href="../../../../../com/oracle/truffle/api/instrumentation/InstrumentableNode.WrapperNode.html" title="interface in com.oracle.truffle.api.instrumentation"><code>InstrumentableNode.WrapperNode</code></a> createWrapper(<a href="../../../../../com/oracle/truffle/api/instrumentation/ProbeNode.html" title="class in com.oracle.truffle.api.instrumentation"><code>ProbeNode</code></a> probe) {
        <b>return</b> <b>new</b> HaltNodeWrapper(<b>this</b>, probe);
    }

}

</pre>

 <p>
 The implementation of hasTag method must ensure that its result is stable after the parent
 <a href="../../../../../com/oracle/truffle/api/nodes/RootNode.html" title="class in com.oracle.truffle.api.nodes"><code>root node</code></a> was wrapped in a <a href="../../../../../com/oracle/truffle/api/CallTarget.html" title="interface in com.oracle.truffle.api"><code>CallTarget</code></a> using
 <a href="../../../../../com/oracle/truffle/api/TruffleRuntime.html#createCallTarget-com.oracle.truffle.api.nodes.RootNode-"><code>TruffleRuntime.createCallTarget(RootNode)</code></a>. The result is stable if the result of
 calling this method for a particular tag remains always the same.
 <p>
 This method might be called in parallel from multiple threads even if the language is single
 threaded. The method may be invoked without a language context currently being active.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>tag</code> - the class <a href="../../../../../com/oracle/truffle/api/instrumentation/ProvidedTags.html" title="annotation in com.oracle.truffle.api.instrumentation"><code>provided</code></a> by
            the <a href="../../../../../com/oracle/truffle/api/TruffleLanguage.html" title="class in com.oracle.truffle.api"><code>language</code></a></dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd><code>true</code> if the node should be considered tagged by a tag else
         <code>false</code>.</dd>
<dt><span class="simpleTagLabel">Since:</span></dt>
<dd>0.33</dd>
</dl>
</li>
</ul>
<a name="getNodeObject--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getNodeObject</h4>
<pre>default&nbsp;<a href="http://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">Object</a>&nbsp;getNodeObject()</pre>
<div class="block">Returns an interop capable object that contains all keys and values of attributes associated
 with this node. The returned object must return <code>true</code> in response to the
 <a href="../../../../../com/oracle/truffle/api/interop/InteropLibrary.html#hasMembers-java.lang.Object-"><code>has members</code></a> message.
 If <code>null</code> is returned then an empty tag object without any readable keys will be
 assumed. Multiple calls to <a href="../../../../../com/oracle/truffle/api/instrumentation/InstrumentableNode.html#getNodeObject--"><code>InstrumentableNode.getNodeObject()</code></a> for a particular node may return the same
 or objects with different identity. The returned object must not support any write operation.
 The returned object must not support execution or instantiation and must not have a size.
 <p>
 For performance reasons it is not recommended to eagerly collect all properties of the node
 object when <a href="../../../../../com/oracle/truffle/api/instrumentation/InstrumentableNode.html#getNodeObject--"><code>InstrumentableNode.getNodeObject()</code></a> is invoked. Instead, the language should lazily compute
 them when they are read. If the node object contains dynamic properties, that change during
 the execution of the AST, then the node must return an updated value for each key when it is
 read repeatedly. In other words the node object must always represent the current state of
 this AST <a href="../../../../../com/oracle/truffle/api/nodes/Node.html" title="class in com.oracle.truffle.api.nodes"><code>node</code></a>. The implementer should not cache the node instance in the AST.
 The instrumentation framework will take care of caching node object instances when they are
 requested by tools.
 <p>
 <b>Compatibility:</b> In addition to the expected keys by the tag specification, the language
 implementation may provide any set of additional keys and values. Tools might depend on these
 language specific tags and might break if keys or values are changed without notice.
 <p>
 For a memory efficient implementation the language might make the instrumentable <a href="../../../../../com/oracle/truffle/api/nodes/Node.html" title="class in com.oracle.truffle.api.nodes"><code>Node</code></a>
 a TruffleObject and return this instance.
 <p>
 This method might be called in parallel from multiple threads even if the language is single
 threaded. The method may be invoked without a language context currently being active. The
 <a href="../../../../../com/oracle/truffle/api/nodes/Node.html#getLock--"><code>AST lock</code></a> is held while <a href="../../../../../com/oracle/truffle/api/instrumentation/InstrumentableNode.html#getNodeObject--"><code>InstrumentableNode.getNodeObject()</code></a> object is invoked.
 There is no lock held when the object is read.</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>the node object as TruffleObject or <code>null</code> if no node object properties
         are available for this instrumented node</dd>
<dt><span class="simpleTagLabel">Since:</span></dt>
<dd>0.33</dd>
</dl>
</li>
</ul>
<a name="materializeInstrumentableNodes-java.util.Set-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>materializeInstrumentableNodes</h4>
<pre>default&nbsp;<a href="../../../../../com/oracle/truffle/api/instrumentation/InstrumentableNode.html" title="interface in com.oracle.truffle.api.instrumentation">InstrumentableNode</a>&nbsp;materializeInstrumentableNodes(<a href="http://docs.oracle.com/javase/8/docs/api/java/util/Set.html?is-external=true" title="class or interface in java.util">Set</a>&lt;<a href="http://docs.oracle.com/javase/8/docs/api/java/lang/Class.html?is-external=true" title="class or interface in java.lang">Class</a>&lt;? extends <a href="../../../../../com/oracle/truffle/api/instrumentation/Tag.html" title="class in com.oracle.truffle.api.instrumentation">Tag</a>&gt;&gt;&nbsp;materializedTags)</pre>
<div class="block">Removes optimizations performed in this AST node to restore the syntactic AST structure.
 Guest languages may decide to group multiple nodes together into a single node. This is
 useful to reduce the memory consumed by the AST representation and it can also improve the
 execution performance when interpreting the AST. Performing such optimizations often modify
 the syntactic AST structure, leading to invalid execution events reported to the
 instrumentation framework. Implementing this method allows the instrumented node to restore
 the syntactic AST structure when needed. It provides a list of tags that were requested by
 all current execution event bindings to allow the language to do the materialization
 selectively for instrumentable nodes with certain tags only.
 <p>
 The returned instrumentable nodes must return themselves when this method is called on them
 with the same tags. Materialized nodes should not be re-materialized again. Instrumentation
 relies on the stability of materialized nodes. Use <a href="../../../../../com/oracle/truffle/api/nodes/Node.html#notifyInserted-com.oracle.truffle.api.nodes.Node-"><code>Node.notifyInserted(Node)</code></a> when you
 need to change the structure of instrumentable nodes.
 <p>
 Node must return itself from this method when it has already seen all the materializedTags
 specified as an argument, i.e., not only if the set of tags is exactly the same as before,
 but also if the current set of tags is completely contained in the union of all the sets of
 tags specified in all the calls of this method that led to creation of this materialized
 node.
 <p>
 If the node returns a new node from this method, the subtree rooted at the new node must be
 completely unadopted, i.e., all nodes it contains must not have existed in the original AST.
 Also, the new subtree must be completely materialized, so that no new materializations occur
 when the instrumentation framework instruments the new subtree during the current traversal.
 <p>
 The AST lock is acquired while this method is invoked. Therefore it is not allowed to run
 guest language code while this method is invoked. This method might be called in parallel
 from multiple threads even if the language is single threaded. The method may be invoked
 without a language context currently being active.
 <p>
 In the example below, we show how the <code>IncrementNode</code> with a
 <code>ConstantNode</code> child is optimized into a <code>ConstantIncrementNode</code> and
 how it can implement <code>materializeSyntaxNodes</code> to restore the syntactic structure
 of the AST:
 <p>
 <pre>&#064;<a href="../../../../../com/oracle/truffle/api/instrumentation/GenerateWrapper.html" title="annotation in com.oracle.truffle.api.instrumentation"><code>GenerateWrapper</code></a>
<b>abstract</b> <b>static</b> <b>class</b> ExpressionNode <b>extends</b> <a href="../../../../../com/oracle/truffle/api/nodes/Node.html" title="class in com.oracle.truffle.api.nodes"><code>Node</code></a>
                <b>implements</b> <a href="../../../../../com/oracle/truffle/api/instrumentation/InstrumentableNode.html" title="interface in com.oracle.truffle.api.instrumentation"><code>InstrumentableNode</code></a> {
    <b>abstract</b> <b>int</b> execute(<a href="../../../../../com/oracle/truffle/api/frame/VirtualFrame.html" title="interface in com.oracle.truffle.api.frame"><code>VirtualFrame</code></a> frame);

    <b>public</b> <b>boolean</b> isInstrumentable() {
        <b>return</b> <b>true</b>;
    }

    <b>public</b> <b>boolean</b> hasTag(<a href="http://docs.oracle.com/javase/8/docs/api/java/lang/Class.html?is-external=true" title="class or interface in java.lang"><code>Class</code></a>&lt;? <b>extends</b> <a href="../../../../../com/oracle/truffle/api/instrumentation/Tag.html" title="class in com.oracle.truffle.api.instrumentation"><code>Tag</code></a>&gt; tag) {
        <b>return</b> tag == <a href="../../../../../com/oracle/truffle/api/instrumentation/StandardTags.html" title="class in com.oracle.truffle.api.instrumentation"><code>StandardTags</code></a>.ExpressionTag.<b>class</b>;
    }

    <b>public</b> <a href="../../../../../com/oracle/truffle/api/instrumentation/InstrumentableNode.WrapperNode.html" title="interface in com.oracle.truffle.api.instrumentation"><code>InstrumentableNode.WrapperNode</code></a> createWrapper(<a href="../../../../../com/oracle/truffle/api/instrumentation/ProbeNode.html" title="class in com.oracle.truffle.api.instrumentation"><code>ProbeNode</code></a> probe) {
        <b>return</b> <b>new</b> ExpressionNodeWrapper(<b>this</b>, probe);
    }
}

<b>class</b> ConstantNode <b>extends</b> ExpressionNode {

    <b>private</b> <b>final</b> <b>int</b> constant;

    ConstantNode(<b>int</b> constant) {
        <b>this</b>.constant = constant;
    }

    &#064;<a href="http://docs.oracle.com/javase/8/docs/api/java/lang/Override.html?is-external=true" title="class or interface in java.lang"><code>Override</code></a>
    <b>int</b> execute(<a href="../../../../../com/oracle/truffle/api/frame/VirtualFrame.html" title="interface in com.oracle.truffle.api.frame"><code>VirtualFrame</code></a> frame) {
        <b>return</b> constant;
    }

}

<em>// node with constant folded operation</em>
<b>class</b> ConstantIncrementNode <b>extends</b> ExpressionNode {
    <b>final</b> <b>int</b> constantIncremented;

    ConstantIncrementNode(<b>int</b> constant) {
        <b>this</b>.constantIncremented = constant + 1;
    }

    <em>// desguar to restore syntactic structure of the AST</em>
    <b>public</b> <a href="../../../../../com/oracle/truffle/api/instrumentation/InstrumentableNode.html" title="interface in com.oracle.truffle.api.instrumentation"><code>InstrumentableNode</code></a> materializeInstrumentableNodes(
                    <a href="http://docs.oracle.com/javase/8/docs/api/java/util/Set.html?is-external=true" title="class or interface in java.util"><code>Set</code></a>&lt;<a href="http://docs.oracle.com/javase/8/docs/api/java/lang/Class.html?is-external=true" title="class or interface in java.lang"><code>Class</code></a>&lt;? <b>extends</b> <a href="../../../../../com/oracle/truffle/api/instrumentation/Tag.html" title="class in com.oracle.truffle.api.instrumentation"><code>Tag</code></a>&gt;&gt; tags) {
        <b>if</b> (tags.contains(<a href="../../../../../com/oracle/truffle/api/instrumentation/StandardTags.html" title="class in com.oracle.truffle.api.instrumentation"><code>StandardTags</code></a>.ExpressionTag.<b>class</b>)) {
            <b>return</b> <b>new</b> IncrementNode(
                            <b>new</b> ConstantNode(constantIncremented - 1));
        }
        <b>return</b> <b>this</b>;
    }

    &#064;<a href="http://docs.oracle.com/javase/8/docs/api/java/lang/Override.html?is-external=true" title="class or interface in java.lang"><code>Override</code></a>
    <b>int</b> execute(<a href="../../../../../com/oracle/truffle/api/frame/VirtualFrame.html" title="interface in com.oracle.truffle.api.frame"><code>VirtualFrame</code></a> frame) {
        <b>return</b> constantIncremented;
    }

}

<em>// node with full semantics of the node.</em>
<b>class</b> IncrementNode <b>extends</b> ExpressionNode {
    &#064;<a href="../../../../../com/oracle/truffle/api/nodes/Node.Child.html" title="annotation in com.oracle.truffle.api.nodes"><code>Node.Child</code></a> ExpressionNode child;

    IncrementNode(ExpressionNode child) {
        <b>this</b>.child = child;
    }

    &#064;<a href="http://docs.oracle.com/javase/8/docs/api/java/lang/Override.html?is-external=true" title="class or interface in java.lang"><code>Override</code></a>
    <b>int</b> execute(<a href="../../../../../com/oracle/truffle/api/frame/VirtualFrame.html" title="interface in com.oracle.truffle.api.frame"><code>VirtualFrame</code></a> frame) {
        <b>return</b> child.execute(frame) + 1;
    }
}
</pre></div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>materializedTags</code> - a set of tags that requested to be materialized</dd>
<dt><span class="simpleTagLabel">Since:</span></dt>
<dd>0.33</dd>
</dl>
</li>
</ul>
<a name="findNearestNodeAt-int-java.util.Set-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>findNearestNodeAt</h4>
<pre>default&nbsp;<a href="../../../../../com/oracle/truffle/api/nodes/Node.html" title="class in com.oracle.truffle.api.nodes">Node</a>&nbsp;findNearestNodeAt(int&nbsp;sourceCharIndex,
                               <a href="http://docs.oracle.com/javase/8/docs/api/java/util/Set.html?is-external=true" title="class or interface in java.util">Set</a>&lt;<a href="http://docs.oracle.com/javase/8/docs/api/java/lang/Class.html?is-external=true" title="class or interface in java.lang">Class</a>&lt;? extends <a href="../../../../../com/oracle/truffle/api/instrumentation/Tag.html" title="class in com.oracle.truffle.api.instrumentation">Tag</a>&gt;&gt;&nbsp;tags)</pre>
<div class="block">Find the nearest <a href="../../../../../com/oracle/truffle/api/nodes/Node.html" title="class in com.oracle.truffle.api.nodes"><code>node</code></a> to the given source character index according to the guest
 language control flow, that is tagged with some of the given tags. The source character index
 is in this node's source. The nearest node will preferably be in the same block/function as
 the character index. This node acts as a context node - either a node containing the
 character index if such node exists, or node following the character index if exists, or node
 preceding the character index otherwise.
 <p>
 Return an instrumentable node that is tagged with some of the tags and containing the
 character index, if such exists and there is not a more suitable sibling node inside the
 container source section. Return the next sibling tagged node otherwise, or the previous one
 when the next one does not exist.
 <p>
 <u>Use Case</u><br>
 The current use-case of this method is a relocation of breakpoint position, for instance.
 When a user submits a breakpoint at the source character index, a nearest logical
 instrumentable node that has suitable tags needs to be found to move the breakpoint
 accordingly.
 <p>
 <u>Default Implementation</u><br>
 This method has a default implementation, which assumes that the materialized Truffle
 <a href="../../../../../com/oracle/truffle/api/nodes/Node.html" title="class in com.oracle.truffle.api.nodes"><code>Node</code></a> hierarchy corresponds with the logical guest language AST structure. If this is
 not the case for a particular guest language, this method needs to be implemented, possibly
 with the help of language specific AST node classes.
 <p>
 The default algorithm is following:<br>
 <ol>
 <li>If the character index is smaller than the start index of this node's source section,
 return the first tagged child of this node.</li>
 <li>If the character index is larger than the end index of this node's source section, return
 the last tagged child of this node.</li>
 <li>Otherwise, this node's source section contains the character index. Use following steps
 to find the nearest tagged node in this node's hierarchy:
 <ol type="a">
 <li>Traverse the node children in declaration order (AST breadth-first order). For every
 child do:
 <ol>
 <li>When the child is not instrumentable, include its children into the traversal.</li>
 <li>When the child does not have a source section assigned, ignore it.</li>
 <li>When the <code>sourceCharIndex</code> is inside the child's source section, find if it's
 tagged with one of the tags (store as <code>isTagged</code>) and repeat recursively from
 <b>3.a.</b> using this child as the node.</li>
 <li>When the child is above the character index, remember a sorted list of such children up
 to the lowest tagged child (store in <code>higherNodes</code> list).</li>
 <li>When the child is below the character index, remember a sorted list of such children down
 to the highest tagged child (store in <code>lowerNodes</code> list).</li>
 </ol>
 </li>
 <li>If a tagged child node was found in <b>3.a</b> with source section matching the
 <code>sourceCharIndex</code>, return it.</li>
 <li>Otherwise, we check the list of lower/higher nodes:
 <ol>
 <li>Prefer the node after the character index.</li>
 <li>Traverse <code>higherNodes</code> in ascending order. When the node is tagged, return it,
 when not, repeat with that node from <b>3.a.</b></li>
 <li>If no tagged node was found, traverse <code>lowerNodes</code> in descending order. When
 the node is tagged, return it, when not, repeat with that node from <b>3.a.</b></li>
 <li>When nothing was found in the steps above, return <code>null</code>.</li>
 </ol>
 </li>
 <li>If <b>c.</b> didn't provide a tagged node, apply this algorithm recursively to a parent
 of this node, if exists. If you encounter the nearest tagged parent node found in <b>3.a</b>,
 return it. Otherwise, return a tagged child found in the steps above, if any.</li>
 </ol>
 </li>
 </ol></div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>sourceCharIndex</code> - the 0-based character index in this node's source, to find the nearest
            tagged node from</dd>
<dd><code>tags</code> - a set of tags, the nearest node needs to be tagged with at least one tag from
            this set</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>the nearest instrumentable node according to the execution flow and tagged with some
         of the tags, or <code>null</code> when none was found</dd>
<dt><span class="simpleTagLabel">Since:</span></dt>
<dd>0.33</dd>
</dl>
</li>
</ul>
<a name="findInstrumentableParent-com.oracle.truffle.api.nodes.Node-">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>findInstrumentableParent</h4>
<pre>static&nbsp;<a href="../../../../../com/oracle/truffle/api/nodes/Node.html" title="class in com.oracle.truffle.api.nodes">Node</a>&nbsp;findInstrumentableParent(<a href="../../../../../com/oracle/truffle/api/nodes/Node.html" title="class in com.oracle.truffle.api.nodes">Node</a>&nbsp;node)</pre>
<div class="block">Find the first <a href="../../../../../com/oracle/truffle/api/instrumentation/InstrumentableNode.html#isInstrumentable--"><code>instrumentable</code></a> node on it's parent chain. If the
 provided node is instrumentable itself, it is returned. If not, the first parent node that is
 instrumentable is returned, if any.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>node</code> - a Node</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>the first instrumentable node, or <code>null</code> when no instrumentable parent
         exists.</dd>
<dt><span class="simpleTagLabel">Since:</span></dt>
<dd>20.3</dd>
</dl>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<!-- ========= END OF CLASS DATA ========= -->
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar.bottom">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.bottom" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.bottom.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../index-all.html">Index</a></li>
<li><a href="../../../../../help-doc.html">Help</a></li>
</ul>
<div class="aboutLanguage"><b>GraalVM Truffle Java API Reference<br>21.3.0-dev</b><br>44d3ba029ef261aefaf3371e8fee9403c5e88ab4</div>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../../com/oracle/truffle/api/instrumentation/GenerateWrapper.OutgoingConverter.html" title="annotation in com.oracle.truffle.api.instrumentation"><span class="typeNameLink">Prev&nbsp;Class</span></a></li>
<li><a href="../../../../../com/oracle/truffle/api/instrumentation/InstrumentableNode.WrapperNode.html" title="interface in com.oracle.truffle.api.instrumentation"><span class="typeNameLink">Next&nbsp;Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../../index.html?com/oracle/truffle/api/instrumentation/InstrumentableNode.html" target="_top">Frames</a></li>
<li><a href="InstrumentableNode.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li><a href="#nested.class.summary">Nested</a>&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a name="skip.navbar.bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
<p class="legalCopy"><small><center>Copyright &copy; 2012, 2021, Oracle and/or its affiliates. All rights reserved.</center></small></p>
</body>
</html>
