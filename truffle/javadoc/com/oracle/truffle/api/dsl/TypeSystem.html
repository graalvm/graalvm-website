<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc -->
<title>TypeSystem (GraalVM Truffle Java API Reference)</title>
<link rel="stylesheet" type="text/css" href="../../../../../stylesheet.css" title="Style">
<script type="text/javascript" src="../../../../../script.js"></script>
</head>
<body>
<script type="text/javascript"><!--
    try {
        if (location.href.indexOf('is-external=true') == -1) {
            parent.document.title="TypeSystem (GraalVM Truffle Java API Reference)";
        }
    }
    catch(err) {
    }
//-->
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar.top">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.top" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.top.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../index-all.html">Index</a></li>
<li><a href="../../../../../help-doc.html">Help</a></li>
</ul>
<div class="aboutLanguage"><b>GraalVM Truffle Java API Reference<br>22.3.0-dev</b><br>2b3d4466b087406ea49e61609b52c74e84e75510</div>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../../com/oracle/truffle/api/dsl/TypeCheck.html" title="annotation in com.oracle.truffle.api.dsl"><span class="typeNameLink">Prev&nbsp;Class</span></a></li>
<li><a href="../../../../../com/oracle/truffle/api/dsl/TypeSystemReference.html" title="annotation in com.oracle.truffle.api.dsl"><span class="typeNameLink">Next&nbsp;Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../../index.html?com/oracle/truffle/api/dsl/TypeSystem.html" target="_top">Frames</a></li>
<li><a href="TypeSystem.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Required&nbsp;|&nbsp;</li>
<li><a href="#annotation.type.optional.element.summary">Optional</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#annotation.type.element.detail">Element</a></li>
</ul>
</div>
<a name="skip.navbar.top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="subTitle">com.oracle.truffle.api.dsl</div>
<h2 title="Annotation Type TypeSystem" class="title">Annotation Type TypeSystem</h2>
</div>
<div class="contentContainer">
<div class="description">
<ul class="blockList">
<li class="blockList">
<hr>
<br>
<pre><a href="http://docs.oracle.com/javase/17/docs/api/java/lang/annotation/Retention.html?is-external=true" title="class or interface in java.lang.annotation">@Retention</a>(<a href="http://docs.oracle.com/javase/17/docs/api/java/lang/annotation/Retention.html?is-external=true#value--" title="class or interface in java.lang.annotation">value</a>=<a href="http://docs.oracle.com/javase/17/docs/api/java/lang/annotation/RetentionPolicy.html?is-external=true#CLASS" title="class or interface in java.lang.annotation">CLASS</a>)
 <a href="http://docs.oracle.com/javase/17/docs/api/java/lang/annotation/Target.html?is-external=true" title="class or interface in java.lang.annotation">@Target</a>(<a href="http://docs.oracle.com/javase/17/docs/api/java/lang/annotation/Target.html?is-external=true#value--" title="class or interface in java.lang.annotation">value</a>=<a href="http://docs.oracle.com/javase/17/docs/api/java/lang/annotation/ElementType.html?is-external=true#TYPE" title="class or interface in java.lang.annotation">TYPE</a>)
public @interface <span class="memberNameLabel">TypeSystem</span></pre>
<div class="block">Type guards are the most common form of guards used in Truffle languages. By default all type
 checks and casts use the default method of checking and casting a type in Java. A default type
 check is performed using the <code>instanceof</code> operator, and a default cast is done using a
 standard Java cast conversion. However, for some types, this behavior needs to be customized or
 extended. Therefore, operations can decide to use type systems. If used, type systems are applied
 to operation classes using the <a href="../../../../../com/oracle/truffle/api/dsl/TypeSystemReference.html" title="annotation in com.oracle.truffle.api.dsl"><code>TypeSystemReference</code></a> annotation. Only one type system can
 be active for a single operation. Type systems are inherited from operation superclasses so that
 the most concrete type system reference is used. If no type system reference is found in the type
 hierarchy, all type checks and casts are kept default.
 <p>
 Example usage:

 <pre>
 &#64;TypeSystem
 public static class ExampleTypeSystem {

     &#64;TypeCast(Undefined.class)
     public static Undefined asUndefined(Object value) {
         return Undefined.INSTANCE;
     }

     &#64;TypeCheck(Undefined.class)
     public static boolean isUndefined(Object value) {
         return value == Undefined.INSTANCE;
     }

     &#64;ImplicitCast
     public static double castInt(int value) {
         return value;
     }
 }

 &#64;TypeSystemReference(ExampleTypeSystem.class)
 public abstract class BaseNode extends Node {
     abstract Object execute();
 }

 public static final class Undefined {
     public static final Undefined INSTANCE = new Undefined();
 }
 </pre>

 The example type system declared in here defines a special type check and cast for the type
 Undefined using methods annotated with <a href="../../../../../com/oracle/truffle/api/dsl/TypeCheck.html" title="annotation in com.oracle.truffle.api.dsl"><code>TypeCheck</code></a> and <a href="../../../../../com/oracle/truffle/api/dsl/TypeCast.html" title="annotation in com.oracle.truffle.api.dsl"><code>TypeCast</code></a>. Undefined is a
 singleton type and therefore, only a single instance of it exists at a time. For singleton types
 the type check can be implemented using an identity comparison and instead of casting a value to
 Undefined we can implement it by returning a constant value. Both the singleton check and cast
 are considered more efficient than the default check and cast behavior.
 <p>
 Multiple distinct Java types can be used to represent values of the same semantic guest language
 type. For example our JavaScript implementation uses the Java types <code>int</code> and
 <code>double</code> to represent the JavaScript numeric type. Whenever a type needs to be checked
 for the type numeric we need to check the value for each representation type. Defining a
 specialization with two numeric parameters would normally require us to specify four
 specializations, for each combination of the representation type. However, in Java, an
 <code>int</code> type has the interesting property of always being representable with a double
 value without losing precision. Type systems allows the user to specify such relationships using
 implicit casts such as the <code>castInt</code> method declared in the example After declaring an
 implicit cast from <code>int</code> to <code>double</code> we can specify a single specialization
 with double type guards to implicitly represent all the cases of the JavaScript numeric type.
 Whenever the DSL implementation needs to cast a value from <code>int</code> to
 <code>double</code> then the implicit cast method is called. Specializations with
 <code>int</code> type guards can be declared before specializations with <code>double</code> type
 guards. If an int specialization is declared after the <code>double</code> specialization then
 the <code>int</code> specialization is unreachable due to the implicit cast. The requirements for
 implicit casts can vary between guest languages. Therefore, no implicit cast is enabled by
 default or if no type system is referenced.
 <p>
 If multiple implicit casts are declared for a single target type then their types are checked in
 declaration order. Languages implementations are encouraged to optimize their implicit cast
 declaration order by sorting them starting with the most frequently used type.</div>
<dl>
<dt><span class="simpleTagLabel">Since:</span></dt>
<dd>0.8 or earlier</dd>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../../com/oracle/truffle/api/dsl/TypeCast.html" title="annotation in com.oracle.truffle.api.dsl"><code>TypeCast</code></a>, 
<a href="../../../../../com/oracle/truffle/api/dsl/TypeCheck.html" title="annotation in com.oracle.truffle.api.dsl"><code>TypeCheck</code></a>, 
<a href="../../../../../com/oracle/truffle/api/dsl/ImplicitCast.html" title="annotation in com.oracle.truffle.api.dsl"><code>ImplicitCast</code></a></dd>
</dl>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- =========== ANNOTATION TYPE OPTIONAL MEMBER SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="annotation.type.optional.element.summary">
<!--   -->
</a>
<h3>Optional Element Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Optional Element Summary table, listing optional elements, and an explanation">
<caption><span>Optional Elements</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Optional Element and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code><a href="http://docs.oracle.com/javase/17/docs/api/java/lang/Class.html?is-external=true" title="class or interface in java.lang">Class</a>&lt;?&gt;[]</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../com/oracle/truffle/api/dsl/TypeSystem.html#value--">value</a></span></code>
<div class="block">The list of types as child elements of the <a href="../../../../../com/oracle/truffle/api/dsl/TypeSystem.html" title="annotation in com.oracle.truffle.api.dsl"><code>TypeSystem</code></a>.</div>
</td>
</tr>
</table>
</li>
</ul>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ============ ANNOTATION TYPE MEMBER DETAIL =========== -->
<ul class="blockList">
<li class="blockList"><a name="annotation.type.element.detail">
<!--   -->
</a>
<h3>Element Detail</h3>
<a name="value--">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>value</h4>
<pre>public abstract&nbsp;<a href="http://docs.oracle.com/javase/17/docs/api/java/lang/Class.html?is-external=true" title="class or interface in java.lang">Class</a>&lt;?&gt;[]&nbsp;value</pre>
<div class="block">The list of types as child elements of the <a href="../../../../../com/oracle/truffle/api/dsl/TypeSystem.html" title="annotation in com.oracle.truffle.api.dsl"><code>TypeSystem</code></a>. Each precedes its super type.</div>
<dl>
<dt><span class="simpleTagLabel">Since:</span></dt>
<dd>0.8 or earlier</dd>
</dl>
<dl>
<dt>Default:</dt>
<dd>{}</dd>
</dl>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<!-- ========= END OF CLASS DATA ========= -->
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar.bottom">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.bottom" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.bottom.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../index-all.html">Index</a></li>
<li><a href="../../../../../help-doc.html">Help</a></li>
</ul>
<div class="aboutLanguage"><b>GraalVM Truffle Java API Reference<br>22.3.0-dev</b><br>2b3d4466b087406ea49e61609b52c74e84e75510</div>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../../com/oracle/truffle/api/dsl/TypeCheck.html" title="annotation in com.oracle.truffle.api.dsl"><span class="typeNameLink">Prev&nbsp;Class</span></a></li>
<li><a href="../../../../../com/oracle/truffle/api/dsl/TypeSystemReference.html" title="annotation in com.oracle.truffle.api.dsl"><span class="typeNameLink">Next&nbsp;Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../../index.html?com/oracle/truffle/api/dsl/TypeSystem.html" target="_top">Frames</a></li>
<li><a href="TypeSystem.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Required&nbsp;|&nbsp;</li>
<li><a href="#annotation.type.optional.element.summary">Optional</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#annotation.type.element.detail">Element</a></li>
</ul>
</div>
<a name="skip.navbar.bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
<p class="legalCopy"><small><center>Copyright &copy; 2012, 2022, Oracle and/or its affiliates. All rights reserved.</center></small></p>
</body>
</html>
