<!DOCTYPE HTML>
<html lang="en">
<head>
<!-- Generated by javadoc (25) -->
<title>TypeSystem (GraalVM Truffle Java API Reference)</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="declaration: package: com.oracle.truffle.api.dsl, annotation type: TypeSystem">
<meta name="generator" content="javadoc/ClassWriter">
<link rel="stylesheet" type="text/css" href="../../../../../resource-files/jquery-ui.min.css">
<link rel="stylesheet" type="text/css" href="../../../../../resource-files/stylesheet.css">
<script type="text/javascript" src="../../../../../script-files/script.js"></script>
<script type="text/javascript" src="../../../../../script-files/jquery-3.7.1.min.js"></script>
<script type="text/javascript" src="../../../../../script-files/jquery-ui.min.js"></script>
</head>
<body class="class-declaration-page">
<script type="text/javascript">const pathtoroot = "../../../../../";
loadScripts(document, 'script');</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<header role="banner">
<nav role="navigation">
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="top-nav" id="navbar-top">
<div class="nav-content">
<div class="nav-menu-button"><button id="navbar-toggle-button" aria-controls="navbar-top" aria-expanded="false" aria-label="Toggle navigation links"><span class="nav-bar-toggle-icon">&nbsp;</span><span class="nav-bar-toggle-icon">&nbsp;</span><span class="nav-bar-toggle-icon">&nbsp;</span></button></div>
<div class="skip-nav"><a href="#skip-navbar-top" title="Skip navigation links">Skip navigation links</a></div>
<ul id="navbar-top-firstrow" class="nav-list" title="Navigation">
<li><a href="../../../../../index.html">Overview</a></li>
<li class="nav-bar-cell1-rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../index-all.html">Index</a></li>
<li><a href="../../../../../search.html">Search</a></li>
<li><a href="../../../../../help-doc.html#class">Help</a></li>
</ul>
<div class="about-language"><b>GraalVM Truffle Java API Reference<br>26.0.0-dev</b><br>9421aee08e80f7efd199936ef43076a23be0a89f</div>
</div>
</div>
<div class="sub-nav">
<div class="nav-content">
<ol class="sub-nav-list">
<li><a href="package-summary.html">com.oracle.truffle.api.dsl</a></li>
<li><a href="TypeSystem.html" class="current-selection">TypeSystem</a></li>
</ol>
<div class="nav-list-search"><input type="text" id="search-input" disabled placeholder="Search documentation (type /)" aria-label="Search in documentation" autocomplete="off" spellcheck="false"><input type="reset" id="reset-search" disabled value="Reset"></div>
</div>
</div>
<!-- ========= END OF TOP NAVBAR ========= -->
<span class="skip-nav" id="skip-navbar-top"></span></nav>
</header>
<div class="main-grid">
<nav role="navigation" class="toc" aria-label="Table of contents">
<div class="toc-header">Contents&nbsp;<input type="text" class="filter-input" disabled placeholder="Filter contents (type .)" aria-label="Filter table of contents" autocomplete="off" spellcheck="false"><input type="reset" class="reset-filter" disabled tabindex="-1" value="Reset"></div>
<ol class="toc-list" tabindex="-1">
<li><a href="#" tabindex="0">Description</a></li>
<li><a href="#annotation-interface-optional-element-summary" tabindex="0">Optional Element Summary</a></li>
<li><a href="#annotation-interface-element-detail" tabindex="0">Element Details</a>
<ol class="toc-list">
<li><a href="#value()" tabindex="0">value</a></li>
</ol>
</li>
</ol>
<button class="hide-sidebar"><span>Hide sidebar&nbsp;</span><img src="../../../../../resource-files/left.svg" alt="Hide sidebar"></button><button class="show-sidebar"><img src="../../../../../resource-files/right.svg" alt="Show sidebar"><span>&nbsp;Show sidebar</span></button></nav>
<main role="main">
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<h1 title="Annotation Interface TypeSystem" class="title">Annotation Interface TypeSystem</h1>
</div>
<section class="class-description" id="class-description">
<hr>
<div class="horizontal-scroll">
<div class="type-signature"><span class="annotations"><a href="https://docs.oracle.com/en/java/javase/25/docs/api/java.base/java/lang/annotation/Retention.html" title="class or interface in java.lang.annotation" class="external-link">@Retention</a>(<a href="https://docs.oracle.com/en/java/javase/25/docs/api/java.base/java/lang/annotation/RetentionPolicy.html#CLASS" title="class or interface in java.lang.annotation" class="external-link">CLASS</a>)
<a href="https://docs.oracle.com/en/java/javase/25/docs/api/java.base/java/lang/annotation/Target.html" title="class or interface in java.lang.annotation" class="external-link">@Target</a>(<a href="https://docs.oracle.com/en/java/javase/25/docs/api/java.base/java/lang/annotation/ElementType.html#TYPE" title="class or interface in java.lang.annotation" class="external-link">TYPE</a>)
</span><span class="modifiers">public @interface </span><span class="element-name type-name-label">TypeSystem</span></div>
<div class="block">Type guards are the most common form of guards used in Truffle languages. By default all type
checks and casts use the default method of checking and casting a type in Java. A default type
check is performed using the <code>instanceof</code> operator, and a default cast is done using a
standard Java cast conversion. However, for some types, this behavior needs to be customized or
extended. Therefore, operations can decide to use type systems. If used, type systems are applied
to operation classes using the <a href="TypeSystemReference.html" title="annotation interface in com.oracle.truffle.api.dsl"><code>TypeSystemReference</code></a> annotation. Only one type system can
be active for a single operation. Type systems are inherited from operation superclasses so that
the most concrete type system reference is used. If no type system reference is found in the type
hierarchy, all type checks and casts are kept default.
<p>
Example usage:

<pre>
&#64;TypeSystem
public static class ExampleTypeSystem {

    &#64;TypeCast(Undefined.class)
    public static Undefined asUndefined(Object value) {
        return Undefined.INSTANCE;
    }

    &#64;TypeCheck(Undefined.class)
    public static boolean isUndefined(Object value) {
        return value == Undefined.INSTANCE;
    }

    &#64;ImplicitCast
    public static double castInt(int value) {
        return value;
    }
}

&#64;TypeSystemReference(ExampleTypeSystem.class)
public abstract class BaseNode extends Node {
    abstract Object execute();
}

public static final class Undefined {
    public static final Undefined INSTANCE = new Undefined();
}
</pre>

The example type system declared in here defines a special type check and cast for the type
Undefined using methods annotated with <a href="TypeCheck.html" title="annotation interface in com.oracle.truffle.api.dsl"><code>TypeCheck</code></a> and <a href="TypeCast.html" title="annotation interface in com.oracle.truffle.api.dsl"><code>TypeCast</code></a>. Undefined is a
singleton type and therefore, only a single instance of it exists at a time. For singleton types
the type check can be implemented using an identity comparison and instead of casting a value to
Undefined we can implement it by returning a constant value. Both the singleton check and cast
are considered more efficient than the default check and cast behavior.
<p>
Multiple distinct Java types can be used to represent values of the same semantic guest language
type. For example our JavaScript implementation uses the Java types <code>int</code> and
<code>double</code> to represent the JavaScript numeric type. Whenever a type needs to be checked
for the type numeric we need to check the value for each representation type. Defining a
specialization with two numeric parameters would normally require us to specify four
specializations, for each combination of the representation type. However, in Java, an
<code>int</code> type has the interesting property of always being representable with a double
value without losing precision. Type systems allows the user to specify such relationships using
implicit casts such as the <code>castInt</code> method declared in the example After declaring an
implicit cast from <code>int</code> to <code>double</code> we can specify a single specialization
with double type guards to implicitly represent all the cases of the JavaScript numeric type.
Whenever the DSL implementation needs to cast a value from <code>int</code> to
<code>double</code> then the implicit cast method is called. Specializations with
<code>int</code> type guards can be declared before specializations with <code>double</code> type
guards. If an int specialization is declared after the <code>double</code> specialization then
the <code>int</code> specialization is unreachable due to the implicit cast. The requirements for
implicit casts can vary between guest languages. Therefore, no implicit cast is enabled by
default or if no type system is referenced.
<p>
If multiple implicit casts are declared for a single target type then their types are checked in
declaration order. Languages implementations are encouraged to optimize their implicit cast
declaration order by sorting them starting with the most frequently used type.</div>
<dl class="notes">
<dt>Since:</dt>
<dd>0.8 or earlier</dd>
<dt>See Also:</dt>
<dd>
<ul class="tag-list">
<li><a href="TypeCast.html" title="annotation interface in com.oracle.truffle.api.dsl"><code>TypeCast</code></a></li>
<li><a href="TypeCheck.html" title="annotation interface in com.oracle.truffle.api.dsl"><code>TypeCheck</code></a></li>
<li><a href="ImplicitCast.html" title="annotation interface in com.oracle.truffle.api.dsl"><code>ImplicitCast</code></a></li>
</ul>
</dd>
</dl>
</div>
</section>
<section class="summary">
<ul class="summary-list">
<!-- =========== ANNOTATION INTERFACE OPTIONAL MEMBER SUMMARY =========== -->
<li>
<section class="member-summary" id="annotation-interface-optional-element-summary">
<h2>Optional Element Summary</h2>
<div class="caption"><span>Optional Elements</span></div>
<div class="summary-table three-column-summary">
<div class="table-header col-first">Modifier and Type</div>
<div class="table-header col-second">Optional Element</div>
<div class="table-header col-last">Description</div>
<div class="col-first even-row-color"><code><a href="https://docs.oracle.com/en/java/javase/25/docs/api/java.base/java/lang/Class.html" title="class or interface in java.lang" class="external-link">Class</a>&lt;?&gt;[]</code></div>
<div class="col-second even-row-color"><code><a href="#value()" class="member-name-link">value</a></code></div>
<div class="col-last even-row-color">
<div class="block">The list of types as child elements of the <a href="TypeSystem.html" title="annotation interface in com.oracle.truffle.api.dsl"><code>TypeSystem</code></a>.</div>
</div>
</div>
</section>
</li>
</ul>
</section>
<section class="details" id="annotation-interface-element-detail">
<ul class="details-list">
<!-- ============ ANNOTATION INTERFACE MEMBER DETAIL =========== -->
<li>
<section class="member-details">
<h2>Element Details</h2>
<ul class="member-list">
<li>
<section class="detail" id="value()">
<h3>value</h3>
<div class="horizontal-scroll">
<div class="member-signature"><span class="return-type"><a href="https://docs.oracle.com/en/java/javase/25/docs/api/java.base/java/lang/Class.html" title="class or interface in java.lang" class="external-link">Class</a>&lt;?&gt;[]</span>&nbsp;<span class="element-name">value</span></div>
<div class="block">The list of types as child elements of the <a href="TypeSystem.html" title="annotation interface in com.oracle.truffle.api.dsl"><code>TypeSystem</code></a>. Each precedes its super type.</div>
<dl class="notes">
<dt>Since:</dt>
<dd>0.8 or earlier</dd>
</dl>
<dl class="notes">
<dt>Default:</dt>
<dd><code>{}</code></dd>
</dl>
</div>
</section>
</li>
</ul>
</section>
</li>
</ul>
</section>
<!-- ========= END OF CLASS DATA ========= -->
<footer role="contentinfo">
<hr>
<p class="legal-copy"><small><center>Copyright &copy; 2012, 2025, Oracle and/or its affiliates. All rights reserved.</center></small></p>
</footer>
</main>
</div>
</body>
</html>
