<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc -->
<title>Specialization (GraalVM Truffle Java API Reference)</title>
<link rel="stylesheet" type="text/css" href="../../../../../stylesheet.css" title="Style">
<script type="text/javascript" src="../../../../../script.js"></script>
</head>
<body>
<script type="text/javascript"><!--
    try {
        if (location.href.indexOf('is-external=true') == -1) {
            parent.document.title="Specialization (GraalVM Truffle Java API Reference)";
        }
    }
    catch(err) {
    }
//-->
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar.top">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.top" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.top.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../index-all.html">Index</a></li>
<li><a href="../../../../../help-doc.html">Help</a></li>
</ul>
<div class="aboutLanguage"><b>GraalVM Truffle Java API Reference<br>21.3.0-dev</b><br>44d3ba029ef261aefaf3371e8fee9403c5e88ab4</div>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../../com/oracle/truffle/api/dsl/ReportPolymorphism.Megamorphic.html" title="annotation in com.oracle.truffle.api.dsl"><span class="typeNameLink">Prev&nbsp;Class</span></a></li>
<li><a href="../../../../../com/oracle/truffle/api/dsl/SpecializationStatistics.html" title="class in com.oracle.truffle.api.dsl"><span class="typeNameLink">Next&nbsp;Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../../index.html?com/oracle/truffle/api/dsl/Specialization.html" target="_top">Frames</a></li>
<li><a href="Specialization.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Required&nbsp;|&nbsp;</li>
<li><a href="#annotation.type.optional.element.summary">Optional</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#annotation.type.element.detail">Element</a></li>
</ul>
</div>
<a name="skip.navbar.top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="subTitle">com.oracle.truffle.api.dsl</div>
<h2 title="Annotation Type Specialization" class="title">Annotation Type Specialization</h2>
</div>
<div class="contentContainer">
<div class="description">
<ul class="blockList">
<li class="blockList">
<hr>
<br>
<pre><a href="http://docs.oracle.com/javase/8/docs/api/java/lang/annotation/Retention.html?is-external=true" title="class or interface in java.lang.annotation">@Retention</a>(<a href="http://docs.oracle.com/javase/8/docs/api/java/lang/annotation/Retention.html?is-external=true#value--" title="class or interface in java.lang.annotation">value</a>=<a href="http://docs.oracle.com/javase/8/docs/api/java/lang/annotation/RetentionPolicy.html?is-external=true#RUNTIME" title="class or interface in java.lang.annotation">RUNTIME</a>)
 <a href="http://docs.oracle.com/javase/8/docs/api/java/lang/annotation/Target.html?is-external=true" title="class or interface in java.lang.annotation">@Target</a>(<a href="http://docs.oracle.com/javase/8/docs/api/java/lang/annotation/Target.html?is-external=true#value--" title="class or interface in java.lang.annotation">value</a>=<a href="http://docs.oracle.com/javase/8/docs/api/java/lang/annotation/ElementType.html?is-external=true#METHOD" title="class or interface in java.lang.annotation">METHOD</a>)
public @interface <span class="memberNameLabel">Specialization</span></pre>
<div class="block"><p>
 Defines a method of a node subclass to represent one specialization of an operation. Multiple
 specializations can be defined in a node representing an operation. A specialization defines
 which kind of input is expected using the method signature and the annotation attributes. The
 specialized semantics of the operation are defined using the body of the annotated Java method. A
 specialization method must be declared in a class that is derived from <a href="../../../../../com/oracle/truffle/api/nodes/Node.html" title="class in com.oracle.truffle.api.nodes"><code>Node</code></a> that
 references a <a href="../../../../../com/oracle/truffle/api/dsl/TypeSystem.html" title="annotation in com.oracle.truffle.api.dsl"><code>TypeSystem</code></a>. At least one specialization must be defined per operation. If no
 specialization is valid for the given set of input values then an
 <a href="../../../../../com/oracle/truffle/api/dsl/UnsupportedSpecializationException.html" title="class in com.oracle.truffle.api.dsl"><code>UnsupportedSpecializationException</code></a> is thrown instead of invoking any specialization
 method.
 </p>
 <p>
 A specialization must have at least as many parameters as there are <a href="../../../../../com/oracle/truffle/api/dsl/NodeChild.html" title="annotation in com.oracle.truffle.api.dsl"><code>NodeChild</code></a> annotations
 declared for the enclosing operation node. These parameters are declared in the same order as the
 <a href="../../../../../com/oracle/truffle/api/dsl/NodeChild.html" title="annotation in com.oracle.truffle.api.dsl"><code>NodeChild</code></a> annotations (linear execution order). We call such parameters dynamic input
 parameters. Every specialization that is declared within an operation must have an equal number
 of dynamic input parameters.
 </p>
 <p>
 The supported kind of input values for a specialization are declared using guards. A
 specialization may provide declarative specifications for four kinds of guards:
 <ul>
 <li><b>Type guards</b> optimistically assume the type of an input value. A value that matches the
 type is cast to its expected type automatically. Type guards are modeled using the parameter type
 of the specialization method. Types used for type guards must be defined in the
 <a href="../../../../../com/oracle/truffle/api/dsl/TypeSystem.html" title="annotation in com.oracle.truffle.api.dsl"><code>TypeSystem</code></a>. If the type of the parameter is <a href="http://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang"><code>Object</code></a> then no type guard is used for
 the dynamic input parameter.</li>

 <li><b>Expression guards</b> optimistically assume the return value of a user-defined expression
 to be <code>true</code>. Expression guards are modeled using Java expressions that return a
 <code>boolean</code> value. If the guard expression returns <code>false</code>, the
 specialization is no longer applicable and the operation is re-specialized. Guard expressions are
 declared using the <a href="../../../../../com/oracle/truffle/api/dsl/Specialization.html#guards--"><code>Specialization.guards()</code></a> attribute.</li>

 <li><b>Event guards</b> trigger re-specialization in case an exception is thrown in the
 specialization body. The <a href="../../../../../com/oracle/truffle/api/dsl/Specialization.html#rewriteOn--"><code>Specialization.rewriteOn()</code></a> attribute can be used to declare a list of such
 exceptions. Guards of this kind are useful to avoid calculating a value twice when it is used in
 the guard and its specialization.</li>

 <li><b>Assumption guards</b> optimistically assume that the state of an <a href="../../../../../com/oracle/truffle/api/Assumption.html" title="interface in com.oracle.truffle.api"><code>Assumption</code></a>
 remains <code>true</code>. Assumptions can be assigned to specializations using the
 <a href="../../../../../com/oracle/truffle/api/dsl/Specialization.html#assumptions--"><code>Specialization.assumptions()</code></a> attribute.</li>
 </ul>
 </p>
 <p>
 The enclosing <a href="../../../../../com/oracle/truffle/api/nodes/Node.html" title="class in com.oracle.truffle.api.nodes"><code>Node</code></a> of a specialization method must have at least one <code>public</code>
 and non-<code>final</code> execute method. An execute method is a method that starts with
 'execute'. If all execute methods declare the first parameter type as <a href="../../../../../com/oracle/truffle/api/frame/Frame.html" title="interface in com.oracle.truffle.api.frame"><code>Frame</code></a>,
 <a href="../../../../../com/oracle/truffle/api/frame/VirtualFrame.html" title="interface in com.oracle.truffle.api.frame"><code>VirtualFrame</code></a> or <a href="../../../../../com/oracle/truffle/api/frame/MaterializedFrame.html" title="interface in com.oracle.truffle.api.frame"><code>MaterializedFrame</code></a> then the same frame type can be used as
 optional first parameter of the specialization. This parameter does not count to the number of
 dynamic parameters.
 </p>
 <p>
 A specialization method may declare multiple parameters annotated with <a href="../../../../../com/oracle/truffle/api/dsl/Cached.html" title="annotation in com.oracle.truffle.api.dsl"><code>Cached</code></a>. Cached
 parameters are initialized and stored once per specialization instantiation. For consistency
 between specialization declarations cached parameters must be declared last in a specialization
 method.
 </p>
 <p>
 If the operation is re-specialized or if it is executed for the first time then all declared
 specializations of the operation are tried in declaration order until the guards of the first
 specialization accepts the current input values. The new specialization is then added to the
 chain of current specialization instances which might consist of one (monomorph) or multiple
 instances (polymorph). If an assumption of an instantiated specialization is violated then
 re-specialization is triggered again.
 </p>
 <p>
 With guards in combination with cached parameters it is possible that multiple instances of the
 same specialization are created. The <a href="../../../../../com/oracle/truffle/api/dsl/Specialization.html#limit--"><code>Specialization.limit()</code></a> attribute can be used to limit the number
 of instantiations per specialization.
 </p></div>
<dl>
<dt><span class="simpleTagLabel">Since:</span></dt>
<dd>0.8 or earlier</dd>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../../com/oracle/truffle/api/dsl/NodeChild.html" title="annotation in com.oracle.truffle.api.dsl"><code>NodeChild</code></a>, 
<a href="../../../../../com/oracle/truffle/api/dsl/Fallback.html" title="annotation in com.oracle.truffle.api.dsl"><code>Fallback</code></a>, 
<a href="../../../../../com/oracle/truffle/api/dsl/Cached.html" title="annotation in com.oracle.truffle.api.dsl"><code>Cached</code></a>, 
<a href="../../../../../com/oracle/truffle/api/dsl/TypeSystem.html" title="annotation in com.oracle.truffle.api.dsl"><code>TypeSystem</code></a>, 
<a href="../../../../../com/oracle/truffle/api/dsl/TypeSystemReference.html" title="annotation in com.oracle.truffle.api.dsl"><code>TypeSystemReference</code></a>, 
<a href="../../../../../com/oracle/truffle/api/dsl/UnsupportedSpecializationException.html" title="class in com.oracle.truffle.api.dsl"><code>UnsupportedSpecializationException</code></a></dd>
</dl>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- =========== ANNOTATION TYPE OPTIONAL MEMBER SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="annotation.type.optional.element.summary">
<!--   -->
</a>
<h3>Optional Element Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Optional Element Summary table, listing optional elements, and an explanation">
<caption><span>Optional Elements</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Optional Element and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code><a href="http://docs.oracle.com/javase/8/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a>[]</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../com/oracle/truffle/api/dsl/Specialization.html#assumptions--">assumptions</a></span></code>
<div class="block">
 Declares assumption guards that optimistically assume that the state of an <a href="../../../../../com/oracle/truffle/api/Assumption.html" title="interface in com.oracle.truffle.api"><code>Assumption</code></a>
 remains valid.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code><a href="http://docs.oracle.com/javase/8/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a>[]</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../com/oracle/truffle/api/dsl/Specialization.html#guards--">guards</a></span></code>
<div class="block">
 Declares <code>boolean</code> expressions that define whether or not input values are
 applicable to this specialization instance.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code><a href="http://docs.oracle.com/javase/8/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../com/oracle/truffle/api/dsl/Specialization.html#insertBefore--">insertBefore</a></span></code>
<div class="block">References a specialization of a super class by its method name where this specialization is
 inserted before.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code><a href="http://docs.oracle.com/javase/8/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../com/oracle/truffle/api/dsl/Specialization.html#limit--">limit</a></span></code>
<div class="block">
 Declares the expression that limits the number of specialization instantiations.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code><a href="http://docs.oracle.com/javase/8/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a>[]</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../com/oracle/truffle/api/dsl/Specialization.html#replaces--">replaces</a></span></code>
<div class="block">
 Declares other specializations of the same operation to be replaced by this specialization.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code><a href="http://docs.oracle.com/javase/8/docs/api/java/lang/Class.html?is-external=true" title="class or interface in java.lang">Class</a>&lt;? extends <a href="http://docs.oracle.com/javase/8/docs/api/java/lang/Throwable.html?is-external=true" title="class or interface in java.lang">Throwable</a>&gt;[]</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../com/oracle/truffle/api/dsl/Specialization.html#rewriteOn--">rewriteOn</a></span></code>
<div class="block">
 Declares an event guards that trigger re-specialization in case an exception is thrown in the
 specialization body.</div>
</td>
</tr>
</table>
</li>
</ul>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ============ ANNOTATION TYPE MEMBER DETAIL =========== -->
<ul class="blockList">
<li class="blockList"><a name="annotation.type.element.detail">
<!--   -->
</a>
<h3>Element Detail</h3>
<a name="insertBefore--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>insertBefore</h4>
<pre>public abstract&nbsp;<a href="http://docs.oracle.com/javase/8/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a>&nbsp;insertBefore</pre>
<div class="block">References a specialization of a super class by its method name where this specialization is
 inserted before. The declaration order of a specialization is not usable for nodes where
 specializations are partly declared in the super class and partly declared in a derived
 class. By default all specializations declared in the derived class are appended to those in
 the super class. This attribute can be used to override the default behavior.</div>
<dl>
<dt><span class="simpleTagLabel">Since:</span></dt>
<dd>0.8 or earlier</dd>
</dl>
<dl>
<dt>Default:</dt>
<dd>""</dd>
</dl>
</li>
</ul>
</li>
</ul>
<ul class="blockList">
<li class="blockList"><a name="rewriteOn--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>rewriteOn</h4>
<pre>public abstract&nbsp;<a href="http://docs.oracle.com/javase/8/docs/api/java/lang/Class.html?is-external=true" title="class or interface in java.lang">Class</a>&lt;? extends <a href="http://docs.oracle.com/javase/8/docs/api/java/lang/Throwable.html?is-external=true" title="class or interface in java.lang">Throwable</a>&gt;[]&nbsp;rewriteOn</pre>
<div class="block"><p>
 Declares an event guards that trigger re-specialization in case an exception is thrown in the
 specialization body. This attribute can be used to declare a list of such exceptions. Guards
 of this kind are useful to avoid calculating a value twice when it is used in the guard and
 its specialization.
 </p>

 <p>
 If an event guard exception is triggered then all instantiations of this specialization are
 removed. If one of theses exceptions is thrown once then no further instantiations of this
 specialization are going to be created for this node.

 In case of explicitly declared <a href="../../../../../com/oracle/truffle/api/nodes/UnexpectedResultException.html" title="class in com.oracle.truffle.api.nodes"><code>UnexpectedResultException</code></a>s, the result from the
 exception will be used. For all other exception types, the next available specialization will
 be executed, so that the original specialization must ensure that no non-repeatable
 side-effect is caused until the rewrite is triggered.
 </p>

 <b>Example usage:</b>

 <pre>
 &#064;Specialization(rewriteOn = ArithmeticException.class)
 int doAddNoOverflow(int a, int b) {
     return Math.addExact(a, b);
 }
 &#064;Specialization
 long doAddWithOverflow(int a, int b) {
     return a + b;
 }
 ...
 Example executions:
   execute(Integer.MAX_VALUE - 1, 1) => doAddNoOverflow(Integer.MAX_VALUE - 1, 1)
   execute(Integer.MAX_VALUE, 1)     => doAddNoOverflow(Integer.MAX_VALUE, 1)
                                     => throws ArithmeticException
                                     => doAddWithOverflow(Integer.MAX_VALUE, 1)
   execute(Integer.MAX_VALUE - 1, 1) => doAddWithOverflow(Integer.MAX_VALUE - 1, 1)
 </pre>

 </p></div>
<dl>
<dt><span class="simpleTagLabel">Since:</span></dt>
<dd>0.8 or earlier</dd>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="http://docs.oracle.com/javase/8/docs/api/java/lang/Math.html?is-external=true#addExact-int-int-" title="class or interface in java.lang"><code>Math.addExact(int, int)</code></a></dd>
</dl>
<dl>
<dt>Default:</dt>
<dd>{}</dd>
</dl>
</li>
</ul>
</li>
</ul>
<ul class="blockList">
<li class="blockList"><a name="replaces--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>replaces</h4>
<pre>public abstract&nbsp;<a href="http://docs.oracle.com/javase/8/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a>[]&nbsp;replaces</pre>
<div class="block"><p>
 Declares other specializations of the same operation to be replaced by this specialization.
 Other specializations are referenced using their unique method name. If this specialization
 is instantiated then all replaced specialization instances are removed and never instantiated
 again for this node instance. Therefore this specialization should handle strictly more
 inputs than which were handled by the replaced specialization, otherwise the removal of the
 replaced specialization will lead to unspecialized types of input values. The replaces
 declaration is transitive for multiple involved specializations.
 </p>
 <b>Example usage:</b>

 <pre>
 &#064;Specialization(guards = "b == 2")
 void doDivPowerTwo(int a, int b) {
     return a >> 1;
 }
 &#064;Specialization(replaces ="doDivPowerTwo", guards = "b > 0")
 void doDivPositive(int a, int b) {
     return a / b;
 }
 ...
 Example executions with replaces="doDivPowerTwo":
   execute(4, 2) => doDivPowerTwo(4, 2)
   execute(9, 3) => doDivPositive(9, 3) // doDivPowerTwo instances get removed
   execute(4, 2) => doDivPositive(4, 2)
 Same executions without replaces="doDivPowerTwo"
   execute(4, 2) => doDivPowerTwo(4, 2)
   execute(9, 3) => doDivPositive(9, 3)
   execute(4, 2) => doDivPowerTwo(4, 2)
 </pre>

 </p></div>
<dl>
<dt><span class="simpleTagLabel">Since:</span></dt>
<dd>0.22</dd>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../../com/oracle/truffle/api/dsl/Specialization.html#guards--"><code>Specialization.guards()</code></a></dd>
</dl>
<dl>
<dt>Default:</dt>
<dd>{}</dd>
</dl>
</li>
</ul>
</li>
</ul>
<ul class="blockList">
<li class="blockList"><a name="guards--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>guards</h4>
<pre>public abstract&nbsp;<a href="http://docs.oracle.com/javase/8/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a>[]&nbsp;guards</pre>
<div class="block"><p>
 Declares <code>boolean</code> expressions that define whether or not input values are
 applicable to this specialization instance. Guard expressions must always return the same
 result for each combination of the enclosing node instance and the bound input values.
 </p>
 <p>
 If a guard expression does not bind any dynamic input parameters then the DSL assumes that
 the result will not change for this node after specialization instantiation. The DSL asserts
 this assumption if assertions are enabled (-ea).
 </p>
 <p>
 Guard expressions are defined using a subset of Java. This subset includes field/parameter
 accesses, function calls, type exact infix comparisons (==, !=, <, <=, >, >=), logical
 negation (!), logical disjunction (||), null, true, false, and integer literals. The return
 type of guard expressions must be <code>boolean</code>. Bound elements without receivers are
 resolved using the following order:
 <ol>
 <li>Dynamic and cached parameters of the enclosing specialization.</li>
 <li>Fields defined using <a href="../../../../../com/oracle/truffle/api/dsl/NodeField.html" title="annotation in com.oracle.truffle.api.dsl"><code>NodeField</code></a> for the enclosing node.</li>
 <li>Non-private, static or virtual methods or fields of enclosing node.</li>
 <li>Non-private, static or virtual methods or fields of super types of the enclosing node.
 </li>
 <li>Public and static methods or fields imported using <a href="../../../../../com/oracle/truffle/api/dsl/ImportStatic.html" title="annotation in com.oracle.truffle.api.dsl"><code>ImportStatic</code></a>.</li>
 </ol>
 </p>
 <p>
 <b>Example usage:</b>

 <pre>
 static boolean acceptOperand(int operand) { assert operand <= 42; return operand & 1 ==
 1; } &#064;Specialization(guards = {"operand <= 42", "acceptOperand(operand)"}) void
 doSpecialization(int operand) {...}
 </pre>

 </p></div>
<dl>
<dt><span class="simpleTagLabel">Since:</span></dt>
<dd>0.8 or earlier</dd>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../../com/oracle/truffle/api/dsl/Cached.html" title="annotation in com.oracle.truffle.api.dsl"><code>Cached</code></a>, 
<a href="../../../../../com/oracle/truffle/api/dsl/ImportStatic.html" title="annotation in com.oracle.truffle.api.dsl"><code>ImportStatic</code></a></dd>
</dl>
<dl>
<dt>Default:</dt>
<dd>{}</dd>
</dl>
</li>
</ul>
</li>
</ul>
<ul class="blockList">
<li class="blockList"><a name="assumptions--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>assumptions</h4>
<pre>public abstract&nbsp;<a href="http://docs.oracle.com/javase/8/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a>[]&nbsp;assumptions</pre>
<div class="block"><p>
 Declares assumption guards that optimistically assume that the state of an <a href="../../../../../com/oracle/truffle/api/Assumption.html" title="interface in com.oracle.truffle.api"><code>Assumption</code></a>
 remains valid. Assumption expressions are cached once per specialization instantiation. If
 one of the returned assumptions gets invalidated then the specialization instance is removed.
 If the assumption expression returns an array of assumptions then all assumptions of the
 array are checked. This is limited to one-dimensional arrays.
 </p>
 <p>
 Assumption expressions are defined using a subset of Java. This subset includes
 field/parameter accesses, function calls, type exact infix comparisons (==, !=, <, <=, >,
 >=), logical negation (!), logical disjunction (||), null, true, false, and integer literals.
 The return type of the expression must be <a href="../../../../../com/oracle/truffle/api/Assumption.html" title="interface in com.oracle.truffle.api"><code>Assumption</code></a> or an array of
 <a href="../../../../../com/oracle/truffle/api/Assumption.html" title="interface in com.oracle.truffle.api"><code>Assumption</code></a> instances. Assumption expressions are not allowed to bind to dynamic
 parameter values of the specialization. Bound elements without receivers are resolved using
 the following order:
 <ol>
 <li>Cached parameters of the enclosing specialization.</li>
 <li>Fields defined using <a href="../../../../../com/oracle/truffle/api/dsl/NodeField.html" title="annotation in com.oracle.truffle.api.dsl"><code>NodeField</code></a> for the enclosing node.</li>
 <li>Non-private, static or virtual methods or fields of enclosing node.</li>
 <li>Non-private, static or virtual methods or fields of super types of the enclosing node.
 </li>
 <li>Public and static methods or fields imported using <a href="../../../../../com/oracle/truffle/api/dsl/ImportStatic.html" title="annotation in com.oracle.truffle.api.dsl"><code>ImportStatic</code></a>.</li>
 </ol>
 </p>

 <p>
 <b>Example usage:</b>

 <pre>
 abstract static class DynamicObject() { abstract Shape getShape(); ... } static
 abstract class Shape() { abstract Assumption getUnmodifiedAssuption(); ... }
 &#064;Specialization(guards = "operand.getShape() == cachedShape", assumptions =
 "cachedShape.getUnmodifiedAssumption()") void doAssumeUnmodifiedShape(DynamicObject
 operand, @Cached("operand.getShape()") Shape cachedShape) {...}
 </pre>

 </p></div>
<dl>
<dt><span class="simpleTagLabel">Since:</span></dt>
<dd>0.8 or earlier</dd>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../../com/oracle/truffle/api/dsl/Cached.html" title="annotation in com.oracle.truffle.api.dsl"><code>Cached</code></a>, 
<a href="../../../../../com/oracle/truffle/api/dsl/ImportStatic.html" title="annotation in com.oracle.truffle.api.dsl"><code>ImportStatic</code></a></dd>
</dl>
<dl>
<dt>Default:</dt>
<dd>{}</dd>
</dl>
</li>
</ul>
</li>
</ul>
<ul class="blockList">
<li class="blockList"><a name="limit--">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>limit</h4>
<pre>public abstract&nbsp;<a href="http://docs.oracle.com/javase/8/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a>&nbsp;limit</pre>
<div class="block"><p>
 Declares the expression that limits the number of specialization instantiations. The default
 limit for specialization instantiations is defined as <code>"3"</code>. If the limit is
 exceeded no more instantiations of the enclosing specialization method are created. Please
 note that the existing specialization instantiations are <b>not</b> removed from the
 specialization chain. You can use <a href="../../../../../com/oracle/truffle/api/dsl/Specialization.html#replaces--"><code>Specialization.replaces()</code></a> to remove unnecessary specializations
 instances.
 </p>
 <p>
 The limit expression is defined using a subset of Java. This subset includes field/parameter
 accesses, function calls, type exact infix comparisons (==, !=, <, <=, >, >=), logical
 negation (!), logical disjunction (||), null, true, false, and integer literals. The return
 type of the limit expression must be <code>int</code>. Limit expressions are not allowed to
 bind to dynamic parameter values of the specialization. Bound elements without receivers are
 resolved using the following order:
 <ol>
 <li>Cached parameters of the enclosing specialization.</li>
 <li>Fields defined using <a href="../../../../../com/oracle/truffle/api/dsl/NodeField.html" title="annotation in com.oracle.truffle.api.dsl"><code>NodeField</code></a> for the enclosing node.</li>
 <li>Non-private, static or virtual methods or fields of enclosing node.</li>
 <li>Non-private, static or virtual methods or fields of super types of the enclosing node.
 </li>
 <li>Public and static methods or fields imported using <a href="../../../../../com/oracle/truffle/api/dsl/ImportStatic.html" title="annotation in com.oracle.truffle.api.dsl"><code>ImportStatic</code></a>.</li>
 </ol>
 </p>

 <p>
 <b>Example usage:</b>

 <pre>
 static int getCacheLimit() { return
 Integer.parseInt(System.getProperty("language.cacheLimit")); } &#064;Specialization(guards =
 "operand == cachedOperand", limit = "getCacheLimit()") void doCached(Object
 operand, @Cached("operand") Object cachedOperand) {...}
 </pre>

 </p></div>
<dl>
<dt><span class="simpleTagLabel">Since:</span></dt>
<dd>0.8 or earlier</dd>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../../com/oracle/truffle/api/dsl/Specialization.html#guards--"><code>Specialization.guards()</code></a>, 
<a href="../../../../../com/oracle/truffle/api/dsl/Specialization.html#replaces--"><code>Specialization.replaces()</code></a>, 
<a href="../../../../../com/oracle/truffle/api/dsl/Cached.html" title="annotation in com.oracle.truffle.api.dsl"><code>Cached</code></a>, 
<a href="../../../../../com/oracle/truffle/api/dsl/ImportStatic.html" title="annotation in com.oracle.truffle.api.dsl"><code>ImportStatic</code></a></dd>
</dl>
<dl>
<dt>Default:</dt>
<dd>""</dd>
</dl>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<!-- ========= END OF CLASS DATA ========= -->
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar.bottom">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.bottom" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.bottom.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../index-all.html">Index</a></li>
<li><a href="../../../../../help-doc.html">Help</a></li>
</ul>
<div class="aboutLanguage"><b>GraalVM Truffle Java API Reference<br>21.3.0-dev</b><br>44d3ba029ef261aefaf3371e8fee9403c5e88ab4</div>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../../com/oracle/truffle/api/dsl/ReportPolymorphism.Megamorphic.html" title="annotation in com.oracle.truffle.api.dsl"><span class="typeNameLink">Prev&nbsp;Class</span></a></li>
<li><a href="../../../../../com/oracle/truffle/api/dsl/SpecializationStatistics.html" title="class in com.oracle.truffle.api.dsl"><span class="typeNameLink">Next&nbsp;Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../../index.html?com/oracle/truffle/api/dsl/Specialization.html" target="_top">Frames</a></li>
<li><a href="Specialization.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Required&nbsp;|&nbsp;</li>
<li><a href="#annotation.type.optional.element.summary">Optional</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#annotation.type.element.detail">Element</a></li>
</ul>
</div>
<a name="skip.navbar.bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
<p class="legalCopy"><small><center>Copyright &copy; 2012, 2021, Oracle and/or its affiliates. All rights reserved.</center></small></p>
</body>
</html>
