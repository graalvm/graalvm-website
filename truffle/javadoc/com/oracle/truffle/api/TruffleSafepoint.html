<!DOCTYPE HTML>
<html lang="en">
<head>
<!-- Generated by javadoc (21) -->
<title>TruffleSafepoint (GraalVM Truffle Java API Reference)</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="declaration: package: com.oracle.truffle.api, class: TruffleSafepoint">
<meta name="generator" content="javadoc/ClassWriterImpl">
<link rel="stylesheet" type="text/css" href="../../../../stylesheet.css" title="Style">
<link rel="stylesheet" type="text/css" href="../../../../script-dir/jquery-ui.min.css" title="Style">
<script type="text/javascript" src="../../../../script.js"></script>
<script type="text/javascript" src="../../../../script-dir/jquery-3.6.1.min.js"></script>
<script type="text/javascript" src="../../../../script-dir/jquery-ui.min.js"></script>
</head>
<body class="class-declaration-page">
<script type="text/javascript">var pathtoroot = "../../../../";
loadScripts(document, 'script');</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<div class="flex-box">
<header role="banner" class="flex-header">
<nav role="navigation">
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="top-nav" id="navbar-top"><button id="navbar-toggle-button" aria-controls="navbar-top" aria-expanded="false" aria-label="Toggle navigation links"><span class="nav-bar-toggle-icon">&nbsp;</span><span class="nav-bar-toggle-icon">&nbsp;</span><span class="nav-bar-toggle-icon">&nbsp;</span></button>
<div class="skip-nav"><a href="#skip-navbar-top" title="Skip navigation links">Skip navigation links</a></div>
<div class="about-language"><b>GraalVM Truffle Java API Reference<br>24.2.0-dev</b><br>55b3c34b5356b8b92e3259efff970f285470e0e6</div>
<ul id="navbar-top-firstrow" class="nav-list" title="Navigation">
<li><a href="../../../../index.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="nav-bar-cell1-rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../index-all.html">Index</a></li>
<li><a href="../../../../help-doc.html#class">Help</a></li>
</ul>
<ul class="sub-nav-list-small">
<li>
<p>Summary:</p>
<ul>
<li><a href="#nested-class-summary">Nested</a></li>
<li>Field</li>
<li><a href="#constructor-summary">Constr</a></li>
<li><a href="#method-summary">Method</a></li>
</ul>
</li>
<li>
<p>Detail:</p>
<ul>
<li>Field</li>
<li><a href="#constructor-detail">Constr</a></li>
<li><a href="#method-detail">Method</a></li>
</ul>
</li>
</ul>
</div>
<div class="sub-nav">
<div id="navbar-sub-list">
<ul class="sub-nav-list">
<li>Summary:&nbsp;</li>
<li><a href="#nested-class-summary">Nested</a>&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor-summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method-summary">Method</a></li>
</ul>
<ul class="sub-nav-list">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor-detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method-detail">Method</a></li>
</ul>
</div>
<div class="nav-list-search"><a href="../../../../search.html">SEARCH</a>
<input type="text" id="search-input" disabled placeholder="Search">
<input type="reset" id="reset-button" disabled value="reset">
</div>
</div>
<!-- ========= END OF TOP NAVBAR ========= -->
<span class="skip-nav" id="skip-navbar-top"></span></nav>
</header>
<div class="flex-content">
<main role="main">
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="sub-title"><span class="package-label-in-type">Package</span>&nbsp;<a href="package-summary.html">com.oracle.truffle.api</a></div>
<h1 title="Class TruffleSafepoint" class="title">Class TruffleSafepoint</h1>
</div>
<div class="inheritance" title="Inheritance Tree"><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html" title="class or interface in java.lang" class="external-link">java.lang.Object</a>
<div class="inheritance">com.oracle.truffle.api.TruffleSafepoint</div>
</div>
<section class="class-description" id="class-description">
<hr>
<div class="type-signature"><span class="modifiers">public abstract class </span><span class="element-name type-name-label">TruffleSafepoint</span>
<span class="extends-implements">extends <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html" title="class or interface in java.lang" class="external-link">Object</a></span></div>
<div class="block">Truffle safepoints allow interrupting the guest language execution to execute thread-local
 actions submitted by a language or tool. A safepoint is a location during the guest language
 execution where the state is consistent, and other operations can read its state.
 <p>
 <h3 id="supporting-safepoints-in-a-language-heading">Supporting Safepoints in a Language</h3>
 <p>
 Safepoints are explicitly polled by invoking the <a href="#poll(com.oracle.truffle.api.nodes.Node)"><code>poll(Node)</code></a> method. Safepoints are
 <a href="#poll(com.oracle.truffle.api.nodes.Node)"><code>polled</code></a> with relaxed location or with <a href="#pollHere(com.oracle.truffle.api.nodes.Node)"><code>exact location</code></a>.
 A poll with a relaxed location is significantly more efficient than a poll with a precise
 location as the compiler is able to move and combine the poll requests during compilation. A
 Truffle guest language implementation must ensure that a safepoint is polled repeatedly within a
 constant time interval. For example, a single arithmetic expression completes within a constant
 number of CPU cycles. However, a loop that summarizes values over an array uses a non-constant
 time dependent on the array size. This typically means that safepoints are best polled at the end
 of loops and at the end of function or method calls to cover recursion. In addition, any guest
 language code that blocks the execution, like guest language locks, need to use the
 <a href="#setBlocked(com.oracle.truffle.api.nodes.Node,com.oracle.truffle.api.TruffleSafepoint.Interrupter,com.oracle.truffle.api.TruffleSafepoint.Interruptible,T,java.lang.Runnable,java.util.function.Consumer)"><code>blocking API</code></a> to
 allow polling of safepoints while the thread is waiting.
 <p>
 Truffle's <a href="nodes/LoopNode.html" title="class in com.oracle.truffle.api.nodes"><code>loop node</code></a> and <a href="nodes/RootNode.html" title="class in com.oracle.truffle.api.nodes"><code>root node</code></a> support safepoint polling
 automatically. No further calls to <a href="#poll(com.oracle.truffle.api.nodes.Node)"><code>poll(Node)</code></a> are therefore necessary. Custom loops or
 loops behind <a href="CompilerDirectives.TruffleBoundary.html" title="annotation interface in com.oracle.truffle.api"><code>boundary</code></a> annotated method calls are expected to be notified
 by the guest language implementation manually.
 <p>
 Thread local actions optionally incur side-effects. By default side-effects are enabled. A
 language implementation may disable side-effects temporarily for the current thread using
 <a href="#setAllowSideEffects(boolean)"><code>setAllowSideEffects(boolean)</code></a> method.
 <p>

 <h3 id="submitting-thread-local-actions-heading">Submitting thread local actions</h3>
 <p>
 See <a href="ThreadLocalAction.html" title="class in com.oracle.truffle.api"><code>ThreadLocalAction</code></a> for details on how to submit actions.
 <p>
 Further information can be found in the
 <a href="http://github.com/oracle/graal/blob/master/truffle/docs/Safepoints.md">safepoint
 tutorial</a>.</div>
<dl class="notes">
<dt>Since:</dt>
<dd>21.1</dd>
<dt>See Also:</dt>
<dd>
<ul class="tag-list">
<li><a href="ThreadLocalAction.html" title="class in com.oracle.truffle.api"><code>ThreadLocalAction</code></a></li>
<li><a href="../../../../org/graalvm/polyglot/Context.html#safepoint()"><code>Context.safepoint()</code></a></li>
</ul>
</dd>
</dl>
</section>
<section class="summary">
<ul class="summary-list">
<!-- ======== NESTED CLASS SUMMARY ======== -->
<li>
<section class="nested-class-summary" id="nested-class-summary">
<h2>Nested Class Summary</h2>
<div class="caption"><span>Nested Classes</span></div>
<div class="summary-table three-column-summary">
<div class="table-header col-first">Modifier and Type</div>
<div class="table-header col-second">Class</div>
<div class="table-header col-last">Description</div>
<div class="col-first even-row-color"><code>static interface&nbsp;</code></div>
<div class="col-second even-row-color"><code><a href="TruffleSafepoint.CompiledInterruptible.html" class="type-name-link" title="interface in com.oracle.truffle.api">TruffleSafepoint.CompiledInterruptible</a>&lt;<a href="TruffleSafepoint.CompiledInterruptible.html" title="type parameter in TruffleSafepoint.CompiledInterruptible">T</a>&gt;</code></div>
<div class="col-last even-row-color">
<div class="block">Just like <a href="TruffleSafepoint.Interruptible.html" title="interface in com.oracle.truffle.api"><code>TruffleSafepoint.Interruptible</code></a> but allows partial evaluation.</div>
</div>
<div class="col-first odd-row-color"><code>static interface&nbsp;</code></div>
<div class="col-second odd-row-color"><code><a href="TruffleSafepoint.CompiledInterruptibleFunction.html" class="type-name-link" title="interface in com.oracle.truffle.api">TruffleSafepoint.CompiledInterruptibleFunction</a>&lt;<a href="TruffleSafepoint.CompiledInterruptibleFunction.html" title="type parameter in TruffleSafepoint.CompiledInterruptibleFunction">T</a>,<wbr><a href="TruffleSafepoint.CompiledInterruptibleFunction.html" title="type parameter in TruffleSafepoint.CompiledInterruptibleFunction">R</a>&gt;</code></div>
<div class="col-last odd-row-color">
<div class="block">Just like <a href="TruffleSafepoint.InterruptibleFunction.html" title="interface in com.oracle.truffle.api"><code>TruffleSafepoint.InterruptibleFunction</code></a> but allows partial evaluation.</div>
</div>
<div class="col-first even-row-color"><code>static interface&nbsp;</code></div>
<div class="col-second even-row-color"><code><a href="TruffleSafepoint.Interrupter.html" class="type-name-link" title="interface in com.oracle.truffle.api">TruffleSafepoint.Interrupter</a></code></div>
<div class="col-last even-row-color">
<div class="block">An interrupter allows a foreign thread to interrupt the execution on a separate thread.</div>
</div>
<div class="col-first odd-row-color"><code>static interface&nbsp;</code></div>
<div class="col-second odd-row-color"><code><a href="TruffleSafepoint.Interruptible.html" class="type-name-link" title="interface in com.oracle.truffle.api">TruffleSafepoint.Interruptible</a>&lt;<a href="TruffleSafepoint.Interruptible.html" title="type parameter in TruffleSafepoint.Interruptible">T</a>&gt;</code></div>
<div class="col-last odd-row-color">
<div class="block">Function interface that represent interruptable Java methods.</div>
</div>
<div class="col-first even-row-color"><code>static interface&nbsp;</code></div>
<div class="col-second even-row-color"><code><a href="TruffleSafepoint.InterruptibleFunction.html" class="type-name-link" title="interface in com.oracle.truffle.api">TruffleSafepoint.InterruptibleFunction</a>&lt;<a href="TruffleSafepoint.InterruptibleFunction.html" title="type parameter in TruffleSafepoint.InterruptibleFunction">T</a>,<wbr><a href="TruffleSafepoint.InterruptibleFunction.html" title="type parameter in TruffleSafepoint.InterruptibleFunction">R</a>&gt;</code></div>
<div class="col-last even-row-color">
<div class="block">Function interface that represent interruptable Java methods.</div>
</div>
</div>
</section>
</li>
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<li>
<section class="constructor-summary" id="constructor-summary">
<h2>Constructor Summary</h2>
<div class="caption"><span>Constructors</span></div>
<div class="summary-table three-column-summary">
<div class="table-header col-first">Modifier</div>
<div class="table-header col-second">Constructor</div>
<div class="table-header col-last">Description</div>
<div class="col-first even-row-color"><code>protected </code></div>
<div class="col-constructor-name even-row-color"><code><a href="#%3Cinit%3E(com.oracle.truffle.api.impl.Accessor.EngineSupport)" class="member-name-link">TruffleSafepoint</a><wbr>(com.oracle.truffle.api.impl.Accessor.EngineSupport&nbsp;support)</code></div>
<div class="col-last even-row-color">
<div class="block">Do not extend this class.</div>
</div>
</div>
</section>
</li>
<!-- ========== METHOD SUMMARY =========== -->
<li>
<section class="method-summary" id="method-summary">
<h2>Method Summary</h2>
<div id="method-summary-table">
<div class="table-tabs" role="tablist" aria-orientation="horizontal"><button id="method-summary-table-tab0" role="tab" aria-selected="true" aria-controls="method-summary-table.tabpanel" tabindex="0" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table', 3)" class="active-table-tab">All Methods</button><button id="method-summary-table-tab1" role="tab" aria-selected="false" aria-controls="method-summary-table.tabpanel" tabindex="-1" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table-tab1', 3)" class="table-tab">Static Methods</button><button id="method-summary-table-tab2" role="tab" aria-selected="false" aria-controls="method-summary-table.tabpanel" tabindex="-1" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table-tab2', 3)" class="table-tab">Instance Methods</button><button id="method-summary-table-tab3" role="tab" aria-selected="false" aria-controls="method-summary-table.tabpanel" tabindex="-1" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table-tab3', 3)" class="table-tab">Abstract Methods</button><button id="method-summary-table-tab4" role="tab" aria-selected="false" aria-controls="method-summary-table.tabpanel" tabindex="-1" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table-tab4', 3)" class="table-tab">Concrete Methods</button><button id="method-summary-table-tab6" role="tab" aria-selected="false" aria-controls="method-summary-table.tabpanel" tabindex="-1" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table-tab6', 3)" class="table-tab">Deprecated Methods</button></div>
<div id="method-summary-table.tabpanel" role="tabpanel">
<div class="summary-table three-column-summary" aria-labelledby="method-summary-table-tab0">
<div class="table-header col-first">Modifier and Type</div>
<div class="table-header col-second">Method</div>
<div class="table-header col-last">Description</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code>static <a href="TruffleSafepoint.html" title="class in com.oracle.truffle.api">TruffleSafepoint</a></code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code><a href="#getCurrent()" class="member-name-link">getCurrent</a>()</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4">
<div class="block">Returns the current safepoint configuration for the current thread.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code>abstract boolean</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="#hasPendingSideEffectingActions()" class="member-name-link">hasPendingSideEffectingActions</a>()</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3">
<div class="block">Returns whether there is any pending side-effecting thread local action on this thread, due
 to being in a critical section using <a href="#setAllowSideEffects(boolean)"><code>setAllowSideEffects(boolean)</code></a>.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code>static void</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code><a href="#poll(com.oracle.truffle.api.nodes.Node)" class="member-name-link">poll</a><wbr>(<a href="nodes/Node.html" title="class in com.oracle.truffle.api.nodes">Node</a>&nbsp;location)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4">
<div class="block">Polls a safepoint at the provided location.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code>static void</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code><a href="#pollHere(com.oracle.truffle.api.nodes.Node)" class="member-name-link">pollHere</a><wbr>(<a href="nodes/Node.html" title="class in com.oracle.truffle.api.nodes">Node</a>&nbsp;location)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4">
<div class="block">Similar to <a href="#poll(com.oracle.truffle.api.nodes.Node)"><code>poll(Node)</code></a> but with exact location.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code>abstract boolean</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="#setAllowActions(boolean)" class="member-name-link">setAllowActions</a><wbr>(boolean&nbsp;enabled)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3">
<div class="block">Allows to temporarily delay all thread local actions on the current thread.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code>abstract boolean</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="#setAllowSideEffects(boolean)" class="member-name-link">setAllowSideEffects</a><wbr>(boolean&nbsp;enabled)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3">
<div class="block">Allows to temporarily delay side-effecting thread local actions on the current thread.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code>abstract &lt;T&gt;&nbsp;void</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="#setBlocked(com.oracle.truffle.api.nodes.Node,com.oracle.truffle.api.TruffleSafepoint.Interrupter,com.oracle.truffle.api.TruffleSafepoint.Interruptible,T,java.lang.Runnable,java.util.function.Consumer)" class="member-name-link">setBlocked</a><wbr>(<a href="nodes/Node.html" title="class in com.oracle.truffle.api.nodes">Node</a>&nbsp;location,
 <a href="TruffleSafepoint.Interrupter.html" title="interface in com.oracle.truffle.api">TruffleSafepoint.Interrupter</a>&nbsp;interrupter,
 <a href="TruffleSafepoint.Interruptible.html" title="interface in com.oracle.truffle.api">TruffleSafepoint.Interruptible</a>&lt;T&gt;&nbsp;interruptible,
 T&nbsp;object,
 <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Runnable.html" title="class or interface in java.lang" class="external-link">Runnable</a>&nbsp;beforeInterrupt,
 <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/util/function/Consumer.html" title="class or interface in java.util.function" class="external-link">Consumer</a>&lt;<a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Throwable.html" title="class or interface in java.lang" class="external-link">Throwable</a>&gt;&nbsp;afterInterrupt)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3">
<div class="block">The same as
 <a href="#setBlockedFunction(com.oracle.truffle.api.nodes.Node,com.oracle.truffle.api.TruffleSafepoint.Interrupter,com.oracle.truffle.api.TruffleSafepoint.InterruptibleFunction,T,java.lang.Runnable,java.util.function.Consumer)"><code>setBlockedFunction(Node, Interrupter, InterruptibleFunction, Object, Runnable, Consumer)</code></a>.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code>abstract &lt;T,<wbr>
R&gt;&nbsp;R</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="#setBlockedFunction(com.oracle.truffle.api.nodes.Node,com.oracle.truffle.api.TruffleSafepoint.Interrupter,com.oracle.truffle.api.TruffleSafepoint.InterruptibleFunction,T,java.lang.Runnable,java.util.function.Consumer)" class="member-name-link">setBlockedFunction</a><wbr>(<a href="nodes/Node.html" title="class in com.oracle.truffle.api.nodes">Node</a>&nbsp;location,
 <a href="TruffleSafepoint.Interrupter.html" title="interface in com.oracle.truffle.api">TruffleSafepoint.Interrupter</a>&nbsp;interrupter,
 <a href="TruffleSafepoint.InterruptibleFunction.html" title="interface in com.oracle.truffle.api">TruffleSafepoint.InterruptibleFunction</a>&lt;T,<wbr>R&gt;&nbsp;interruptible,
 T&nbsp;object,
 <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Runnable.html" title="class or interface in java.lang" class="external-link">Runnable</a>&nbsp;beforeInterrupt,
 <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/util/function/Consumer.html" title="class or interface in java.util.function" class="external-link">Consumer</a>&lt;<a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Throwable.html" title="class or interface in java.lang" class="external-link">Throwable</a>&gt;&nbsp;afterInterrupt)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3">
<div class="block">Transitions the current thread into a blocked state and calls an interruptible functional
 method.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code>static &lt;T&gt;&nbsp;void</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code><a href="#setBlockedThreadInterruptible(com.oracle.truffle.api.nodes.Node,com.oracle.truffle.api.TruffleSafepoint.Interruptible,T)" class="member-name-link">setBlockedThreadInterruptible</a><wbr>(<a href="nodes/Node.html" title="class in com.oracle.truffle.api.nodes">Node</a>&nbsp;location,
 <a href="TruffleSafepoint.Interruptible.html" title="interface in com.oracle.truffle.api">TruffleSafepoint.Interruptible</a>&lt;T&gt;&nbsp;interruptible,
 T&nbsp;object)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4">
<div class="block">Short-cut method to allow setting the blocked status for methods that throw
 <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/InterruptedException.html" title="class or interface in java.lang" class="external-link"><code>InterruptedException</code></a> and support interrupting using <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Thread.html#interrupt()" title="class or interface in java.lang" class="external-link"><code>Thread.interrupt()</code></a>.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code>static &lt;T,<wbr>
R&gt;&nbsp;R</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code><a href="#setBlockedThreadInterruptibleFunction(com.oracle.truffle.api.nodes.Node,com.oracle.truffle.api.TruffleSafepoint.InterruptibleFunction,T)" class="member-name-link">setBlockedThreadInterruptibleFunction</a><wbr>(<a href="nodes/Node.html" title="class in com.oracle.truffle.api.nodes">Node</a>&nbsp;location,
 <a href="TruffleSafepoint.InterruptibleFunction.html" title="interface in com.oracle.truffle.api">TruffleSafepoint.InterruptibleFunction</a>&lt;T,<wbr>R&gt;&nbsp;interruptible,
 T&nbsp;object)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4">
<div class="block">Short-cut method to allow setting the blocked status for methods that throw
 <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/InterruptedException.html" title="class or interface in java.lang" class="external-link"><code>InterruptedException</code></a> and support interrupting using <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Thread.html#interrupt()" title="class or interface in java.lang" class="external-link"><code>Thread.interrupt()</code></a>.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4 method-summary-table-tab6"><code>&lt;T&gt;&nbsp;void</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4 method-summary-table-tab6"><code><a href="#setBlockedWithException(com.oracle.truffle.api.nodes.Node,com.oracle.truffle.api.TruffleSafepoint.Interrupter,com.oracle.truffle.api.TruffleSafepoint.Interruptible,T,java.lang.Runnable,java.util.function.Consumer)" class="member-name-link">setBlockedWithException</a><wbr>(<a href="nodes/Node.html" title="class in com.oracle.truffle.api.nodes">Node</a>&nbsp;location,
 <a href="TruffleSafepoint.Interrupter.html" title="interface in com.oracle.truffle.api">TruffleSafepoint.Interrupter</a>&nbsp;interrupter,
 <a href="TruffleSafepoint.Interruptible.html" title="interface in com.oracle.truffle.api">TruffleSafepoint.Interruptible</a>&lt;T&gt;&nbsp;interruptible,
 T&nbsp;object,
 <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Runnable.html" title="class or interface in java.lang" class="external-link">Runnable</a>&nbsp;beforeInterrupt,
 <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/util/function/Consumer.html" title="class or interface in java.util.function" class="external-link">Consumer</a>&lt;<a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Throwable.html" title="class or interface in java.lang" class="external-link">Throwable</a>&gt;&nbsp;afterInterrupt)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4 method-summary-table-tab6">
<div class="block"><span class="deprecated-label">Deprecated.</span>
<div class="deprecation-comment">Use
             <a href="#setBlocked(com.oracle.truffle.api.nodes.Node,com.oracle.truffle.api.TruffleSafepoint.Interrupter,com.oracle.truffle.api.TruffleSafepoint.Interruptible,T,java.lang.Runnable,java.util.function.Consumer)"><code>setBlocked(Node, Interrupter, Interruptible, Object, Runnable, Consumer)</code></a></div>
</div>
</div>
</div>
</div>
</div>
<div class="inherited-list">
<h3 id="methods-inherited-from-class-java.lang.Object">Methods inherited from class&nbsp;java.lang.<a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html" title="class or interface in java.lang" class="external-link">Object</a></h3>
<code><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html#clone()" title="class or interface in java.lang" class="external-link">clone</a>, <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html#equals(java.lang.Object)" title="class or interface in java.lang" class="external-link">equals</a>, <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html#finalize()" title="class or interface in java.lang" class="external-link">finalize</a>, <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html#getClass()" title="class or interface in java.lang" class="external-link">getClass</a>, <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html#hashCode()" title="class or interface in java.lang" class="external-link">hashCode</a>, <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html#notify()" title="class or interface in java.lang" class="external-link">notify</a>, <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html#notifyAll()" title="class or interface in java.lang" class="external-link">notifyAll</a>, <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html#toString()" title="class or interface in java.lang" class="external-link">toString</a>, <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html#wait()" title="class or interface in java.lang" class="external-link">wait</a>, <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html#wait(long)" title="class or interface in java.lang" class="external-link">wait</a>, <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html#wait(long,int)" title="class or interface in java.lang" class="external-link">wait</a></code></div>
</section>
</li>
</ul>
</section>
<section class="details">
<ul class="details-list">
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<li>
<section class="constructor-details" id="constructor-detail">
<h2>Constructor Details</h2>
<ul class="member-list">
<li>
<section class="detail" id="&lt;init&gt;(com.oracle.truffle.api.impl.Accessor.EngineSupport)">
<h3>TruffleSafepoint</h3>
<div class="member-signature"><span class="modifiers">protected</span>&nbsp;<span class="element-name">TruffleSafepoint</span><wbr><span class="parameters">(com.oracle.truffle.api.impl.Accessor.EngineSupport&nbsp;support)</span></div>
<div class="block">Do not extend this class. This class is intended to be implemented by a Truffle runtime
 implementation.</div>
<dl class="notes">
<dt>Since:</dt>
<dd>21.1</dd>
</dl>
</section>
</li>
</ul>
</section>
</li>
<!-- ============ METHOD DETAIL ========== -->
<li>
<section class="method-details" id="method-detail">
<h2>Method Details</h2>
<ul class="member-list">
<li>
<section class="detail" id="poll(com.oracle.truffle.api.nodes.Node)">
<h3>poll</h3>
<div class="member-signature"><span class="modifiers">public static</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name">poll</span><wbr><span class="parameters">(<a href="nodes/Node.html" title="class in com.oracle.truffle.api.nodes">Node</a>&nbsp;location)</span></div>
<div class="block">Polls a safepoint at the provided location. This allows to run thread local actions at this
 location. A Truffle guest language implementation must ensure that a safepoint is polled
 repeatedly within a constant time interval. See <a href="TruffleSafepoint.html" title="class in com.oracle.truffle.api"><code>TruffleSafepoint</code></a> for further details.
 <p>
 In compiled code calls to this method are removed. Instead the compiler inserts safepoints
 automatically at loop ends and method exits. In this case the node location is approximated
 by frame state of method ends and loop exits in the compiler IR. For method ends the parent
 root node and for loop exits the loop node is passed as location.
 <p>
 Guest language exceptions may be thrown by this method. If
 <a href="#setAllowSideEffects(boolean)"><code>side-effects</code></a> are allowed then also guest language
 exceptions may be thrown. Otherwise only internal or <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/ThreadDeath.html" title="class or interface in java.lang" class="external-link"><code>thread-death</code></a>
 exceptions may be thrown. This method is safe to be used on compiled code paths.
 <p>
 Example usage with an unbounded loop sum behind a <a href="CompilerDirectives.TruffleBoundary.html" title="annotation interface in com.oracle.truffle.api"><code>CompilerDirectives.TruffleBoundary</code></a>.

 <pre>
 &#64;TruffleBoundary
 int sum(int[] array) {
     int sum = 0;
     for (int i = 0; i &lt; array.length; i++) {
         sum += array[i];

         TruffleSafepoint.poll();
     }
     return sum;
 }
 </pre></div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>location</code> - the location of the poll. May be <code>null</code>, but it is recommended to
            always pass a location node, if available.</dd>
<dt>Since:</dt>
<dd>21.1</dd>
<dt>See Also:</dt>
<dd>
<ul class="tag-list">
<li><a href="TruffleSafepoint.html" title="class in com.oracle.truffle.api"><code>TruffleSafepoint</code></a></li>
<li><a href="#pollHere(com.oracle.truffle.api.nodes.Node)"><code>pollHere(Node)</code></a></li>
</ul>
</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="pollHere(com.oracle.truffle.api.nodes.Node)">
<h3>pollHere</h3>
<div class="member-signature"><span class="modifiers">public static</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name">pollHere</span><wbr><span class="parameters">(<a href="nodes/Node.html" title="class in com.oracle.truffle.api.nodes">Node</a>&nbsp;location)</span></div>
<div class="block">Similar to <a href="#poll(com.oracle.truffle.api.nodes.Node)"><code>poll(Node)</code></a> but with exact location. A poll with <a href="#poll(com.oracle.truffle.api.nodes.Node)"><code>relaxed location</code></a> is significantly more efficient than a poll with precise location as the
 compiler is able to move and combine the poll requests during compilation. This method is
 safe to be used on compiled code paths.
 <p>
 Usage example:

 <pre>
 TruffleSafepoint safepoint = TruffleSafepoint.getCurrent();
 boolean prev = safepoint.setAllowSideEffects(false);
 try {
     // criticial section
 } finally {
     safepoint.setAllowSideEffects(prev);
     TruffleSafepoint.pollHere(this);
 }
 </pre></div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>location</code> - the location of the poll. Must not be <code>null</code>.</dd>
<dt>Since:</dt>
<dd>21.1</dd>
<dt>See Also:</dt>
<dd>
<ul class="tag-list">
<li><a href="#poll(com.oracle.truffle.api.nodes.Node)"><code>poll(Node)</code></a></li>
</ul>
</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="setBlockedWithException(com.oracle.truffle.api.nodes.Node,com.oracle.truffle.api.TruffleSafepoint.Interrupter,com.oracle.truffle.api.TruffleSafepoint.Interruptible,T,java.lang.Runnable,java.util.function.Consumer)">
<h3 id="setBlockedWithException(com.oracle.truffle.api.nodes.Node,com.oracle.truffle.api.TruffleSafepoint.Interrupter,com.oracle.truffle.api.TruffleSafepoint.Interruptible,java.lang.Object,java.lang.Runnable,java.util.function.Consumer)">setBlockedWithException</h3>
<div class="member-signature"><span class="annotations"><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Deprecated.html" title="class or interface in java.lang" class="external-link">@Deprecated</a>
</span><span class="modifiers">public</span>&nbsp;<span class="type-parameters">&lt;T&gt;</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name">setBlockedWithException</span><wbr><span class="parameters">(<a href="nodes/Node.html" title="class in com.oracle.truffle.api.nodes">Node</a>&nbsp;location,
 <a href="TruffleSafepoint.Interrupter.html" title="interface in com.oracle.truffle.api">TruffleSafepoint.Interrupter</a>&nbsp;interrupter,
 <a href="TruffleSafepoint.Interruptible.html" title="interface in com.oracle.truffle.api">TruffleSafepoint.Interruptible</a>&lt;T&gt;&nbsp;interruptible,
 T&nbsp;object,
 <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Runnable.html" title="class or interface in java.lang" class="external-link">Runnable</a>&nbsp;beforeInterrupt,
 <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/util/function/Consumer.html" title="class or interface in java.util.function" class="external-link">Consumer</a>&lt;<a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Throwable.html" title="class or interface in java.lang" class="external-link">Throwable</a>&gt;&nbsp;afterInterrupt)</span></div>
<div class="deprecation-block"><span class="deprecated-label">Deprecated.</span>
<div class="deprecation-comment">Use
             <a href="#setBlocked(com.oracle.truffle.api.nodes.Node,com.oracle.truffle.api.TruffleSafepoint.Interrupter,com.oracle.truffle.api.TruffleSafepoint.Interruptible,T,java.lang.Runnable,java.util.function.Consumer)"><code>setBlocked(Node, Interrupter, Interruptible, Object, Runnable, Consumer)</code></a></div>
</div>
<div class="block">Transitions the current thread into a blocked state and calls an interruptible functional
 method. The blocked state is restored when the interruptible method returns. Setting the
 blocked state allows safepoint notification while the current thread is blocked. This allows
 Truffle to interrupt e.g. locks temporarily to perform a thread local action.
 <p>
 The <code>location&gt;</code> parameter is used <a href="#poll(com.oracle.truffle.api.nodes.Node)"><code>poll</code></a> all pending thread
 local actions before transition to blocked state.
 <p>
 The <code>interrupter</code> parameter specifies how the blocked state can be interrupted
 from another thread. The interrupter allows to interrupt the blocked state from other
 threads. For most blocking java.util.concurrent primitives the
 <a href="TruffleSafepoint.Interrupter.html#THREAD_INTERRUPT"><code>thread interrupter</code></a> can be used. If the thread will be
 blocked in native code, other ways of interrupting, like signals may be used by implementing
 the <a href="TruffleSafepoint.Interrupter.html" title="interface in com.oracle.truffle.api"><code>TruffleSafepoint.Interrupter</code></a> interface.
 <p>
 The <code>interruptible</code> parameter provides the method that calls the blocking method
 which throws <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/InterruptedException.html" title="class or interface in java.lang" class="external-link"><code>InterruptedException</code></a> on interrupt. In order to avoid allocations of the
 functional interface a single argument can be provided that is passed to the interface. This
 is typically the <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/util/concurrent/locks/Lock.html" title="class or interface in java.util.concurrent.locks" class="external-link"><code>lock</code></a> or <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/util/concurrent/Semaphore.html" title="class or interface in java.util.concurrent" class="external-link"><code>semaphore</code></a> instance. The
 implementation of this method is expected to throw an <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/InterruptedException.html" title="class or interface in java.lang" class="external-link"><code>InterruptedException</code></a> if the
 <a href="TruffleSafepoint.Interrupter.html#interrupt(java.lang.Thread)"><code>TruffleSafepoint.Interrupter.interrupt(Thread)</code></a> method is invoked for this thread. For most
 java.util.concurrent primitives this is supported by using the interruptible blocking method
 variant, for example <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/util/concurrent/locks/Lock.html#lockInterruptibly()" title="class or interface in java.util.concurrent.locks" class="external-link"><code>Lock.lockInterruptibly()</code></a>.
 <p>
 Since it is common to use this method with method reference syntax e.g.
 <code>Lock::lockInterruptibly</code> for the interruptible parameter, we implicitlely apply a
 <a href="CompilerDirectives.TruffleBoundary.html" title="annotation interface in com.oracle.truffle.api"><code>boundary</code></a> for the entire method call by default. If the interruptible
 is called from a compiled code path and the interruptible should get partial evaluated, then
 <a href="TruffleSafepoint.CompiledInterruptible.html" title="interface in com.oracle.truffle.api"><code>TruffleSafepoint.CompiledInterruptible</code></a> should be used instead of <a href="TruffleSafepoint.Interruptible.html" title="interface in com.oracle.truffle.api"><code>TruffleSafepoint.Interruptible</code></a>. In this case
 the parameter must be a <a href="CompilerDirectives.html#isPartialEvaluationConstant(java.lang.Object)"><code>partial
 evaluation constant</code></a>.
 <p>
 The <code>beforeInterrupt</code> <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Runnable.html" title="class or interface in java.lang" class="external-link"><code>runnable</code></a> and <code>afterInterrupt</code>
 <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/util/function/Consumer.html" title="class or interface in java.util.function" class="external-link"><code>consumer</code></a> optional parameters allow to run code before and after a thread got
 interrupted and safepoint events are processed. If <code>null</code> is provided then no
 action will be performed. Arbitrary code may be executed in this runnable. Note that the
 blocked state is temporarily reset to its previous state while the afterInterrupt is called.
 <p>
 If an exception is thrown during the processing of the safepoint, <code>afterInterrupt</code>
 will receive the throwable as argument, or <code>null</code> if the safepoint successfully
 completed. This exception will still be thrown after completion of
 <code>afterInterrupt</code>, unless <code>afterInterrupt</code> throws an exception of its
 own.

 <p>
 Multiple recursive invocations of this method is supported. The previous blocked state will
 be restored when the method completes or fails.
 <p>
 Example usage:
 <p>
 Note there is a short-cut method to achieve the same behavior as in this example
 <a href="#setBlockedThreadInterruptible(com.oracle.truffle.api.nodes.Node,com.oracle.truffle.api.TruffleSafepoint.Interruptible,T)"><code>setBlockedThreadInterruptible(Node, Interruptible, Object)</code></a>.

 <pre>
 Lock lock = new ReentrantLock();
 TruffleSafepoint sp = TruffleSafepoint.getCurrent();
 sp.setBlocked(location, Interrupter.THREAD_INTERRUPT, ReentrantLock::lockInterruptibly, lock, null, null);
 </pre></div>
<dl class="notes">
<dt>Since:</dt>
<dd>22.1</dd>
<dt>See Also:</dt>
<dd>
<ul class="tag-list">
<li><a href="TruffleSafepoint.html" title="class in com.oracle.truffle.api"><code>TruffleSafepoint</code></a></li>
</ul>
</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="setBlockedFunction(com.oracle.truffle.api.nodes.Node,com.oracle.truffle.api.TruffleSafepoint.Interrupter,com.oracle.truffle.api.TruffleSafepoint.InterruptibleFunction,T,java.lang.Runnable,java.util.function.Consumer)">
<h3 id="setBlockedFunction(com.oracle.truffle.api.nodes.Node,com.oracle.truffle.api.TruffleSafepoint.Interrupter,com.oracle.truffle.api.TruffleSafepoint.InterruptibleFunction,java.lang.Object,java.lang.Runnable,java.util.function.Consumer)">setBlockedFunction</h3>
<div class="member-signature"><span class="modifiers">public abstract</span>&nbsp;<span class="type-parameters">&lt;T,<wbr>
R&gt;</span>&nbsp;<span class="return-type">R</span>&nbsp;<span class="element-name">setBlockedFunction</span><wbr><span class="parameters">(<a href="nodes/Node.html" title="class in com.oracle.truffle.api.nodes">Node</a>&nbsp;location,
 <a href="TruffleSafepoint.Interrupter.html" title="interface in com.oracle.truffle.api">TruffleSafepoint.Interrupter</a>&nbsp;interrupter,
 <a href="TruffleSafepoint.InterruptibleFunction.html" title="interface in com.oracle.truffle.api">TruffleSafepoint.InterruptibleFunction</a>&lt;T,<wbr>R&gt;&nbsp;interruptible,
 T&nbsp;object,
 <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Runnable.html" title="class or interface in java.lang" class="external-link">Runnable</a>&nbsp;beforeInterrupt,
 <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/util/function/Consumer.html" title="class or interface in java.util.function" class="external-link">Consumer</a>&lt;<a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Throwable.html" title="class or interface in java.lang" class="external-link">Throwable</a>&gt;&nbsp;afterInterrupt)</span></div>
<div class="block">Transitions the current thread into a blocked state and calls an interruptible functional
 method. The blocked state is restored when the interruptible method returns. Setting the
 blocked state allows safepoint notification while the current thread is blocked. This allows
 Truffle to interrupt e.g. locks temporarily to perform a thread local action.
 <p>
 The <code>location</code> parameter is used to <a href="#poll(com.oracle.truffle.api.nodes.Node)"><code>poll</code></a> all pending thread
 local actions before transition to blocked state. It may be <code>null</code>, but it is
 recommended to always pass a location node, if available.
 <p>
 The <code>interrupter</code> parameter specifies how the blocked state can be interrupted
 from another thread. The interrupter allows to interrupt the blocked state from other
 threads. For most blocking java.util.concurrent primitives the
 <a href="TruffleSafepoint.Interrupter.html#THREAD_INTERRUPT"><code>thread interrupter</code></a> can be used. If the thread will be
 blocked in native code, other ways of interrupting, like signals may be used by implementing
 the <a href="TruffleSafepoint.Interrupter.html" title="interface in com.oracle.truffle.api"><code>TruffleSafepoint.Interrupter</code></a> interface.
 <p>
 The <code>interruptible</code> parameter provides the method that calls the blocking method
 which throws <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/InterruptedException.html" title="class or interface in java.lang" class="external-link"><code>InterruptedException</code></a> on interrupt. In order to avoid allocations of the
 functional interface a single argument can be provided that is passed to the interface. This
 is typically the <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/util/concurrent/locks/Lock.html" title="class or interface in java.util.concurrent.locks" class="external-link"><code>lock</code></a> or <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/util/concurrent/Semaphore.html" title="class or interface in java.util.concurrent" class="external-link"><code>semaphore</code></a> instance. The
 implementation of this method is expected to throw an <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/InterruptedException.html" title="class or interface in java.lang" class="external-link"><code>InterruptedException</code></a> if the
 <a href="TruffleSafepoint.Interrupter.html#interrupt(java.lang.Thread)"><code>TruffleSafepoint.Interrupter.interrupt(Thread)</code></a> method is invoked for this thread. For most
 java.util.concurrent primitives this is supported by using the interruptible blocking method
 variant, for example <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/util/concurrent/locks/Lock.html#lockInterruptibly()" title="class or interface in java.util.concurrent.locks" class="external-link"><code>Lock.lockInterruptibly()</code></a>.
 <p>
 <a href="CompilerDirectives.TruffleBoundary.html" title="annotation interface in com.oracle.truffle.api"><code>boundary</code></a> is applied for the entire interruptible method call by
 default. If the interruptible is called from a compiled code path and the interruptible
 should get partial evaluated, then <a href="TruffleSafepoint.CompiledInterruptibleFunction.html" title="interface in com.oracle.truffle.api"><code>TruffleSafepoint.CompiledInterruptibleFunction</code></a> should be used
 instead of <a href="TruffleSafepoint.InterruptibleFunction.html" title="interface in com.oracle.truffle.api"><code>TruffleSafepoint.InterruptibleFunction</code></a>. In this case the parameter must be a
 <a href="CompilerDirectives.html#isPartialEvaluationConstant(java.lang.Object)"><code>partial evaluation constant</code></a>.
 <p>
 The <code>beforeInterrupt</code> <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Runnable.html" title="class or interface in java.lang" class="external-link"><code>runnable</code></a> and <code>afterInterrupt</code>
 <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/util/function/Consumer.html" title="class or interface in java.util.function" class="external-link"><code>consumer</code></a> optional parameters allow to run code before and after a thread got
 interrupted and safepoint events are processed. If <code>null</code> is provided then no
 action will be performed. Arbitrary code may be executed in this runnable. Note that the
 blocked state is temporarily reset to its previous state while the afterInterrupt is called.
 <p>
 If an exception is thrown during the processing of the safepoint, <code>afterInterrupt</code>
 will receive the throwable as argument, or <code>null</code> if the safepoint successfully
 completed. This exception will still be thrown after completion of
 <code>afterInterrupt</code>, unless <code>afterInterrupt</code> throws an exception of its
 own.

 <p>
 Multiple recursive invocations of this method is supported. The previous blocked state will
 be restored when the method completes or fails.
 <p>
 Example usage:
 <p>
 Note there is a short-cut method to achieve the same behavior as in this example
 <a href="#setBlockedThreadInterruptibleFunction(com.oracle.truffle.api.nodes.Node,com.oracle.truffle.api.TruffleSafepoint.InterruptibleFunction,T)"><code>setBlockedThreadInterruptibleFunction(Node, InterruptibleFunction, Object)</code></a>.

 <pre>
 Queue&lt;Object&gt; queue = new ArrayBlockingQueue&lt;&gt;(10);
 TruffleSafepoint sp = TruffleSafepoint.getCurrent();
 sp.setBlockedFunction(location, Interrupter.THREAD_INTERRUPT, BlockingQueue::take, queue, null, null);
 </pre></div>
<dl class="notes">
<dt>Since:</dt>
<dd>23.1</dd>
<dt>See Also:</dt>
<dd>
<ul class="tag-list">
<li><a href="TruffleSafepoint.html" title="class in com.oracle.truffle.api"><code>TruffleSafepoint</code></a></li>
</ul>
</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="setBlocked(com.oracle.truffle.api.nodes.Node,com.oracle.truffle.api.TruffleSafepoint.Interrupter,com.oracle.truffle.api.TruffleSafepoint.Interruptible,T,java.lang.Runnable,java.util.function.Consumer)">
<h3 id="setBlocked(com.oracle.truffle.api.nodes.Node,com.oracle.truffle.api.TruffleSafepoint.Interrupter,com.oracle.truffle.api.TruffleSafepoint.Interruptible,java.lang.Object,java.lang.Runnable,java.util.function.Consumer)">setBlocked</h3>
<div class="member-signature"><span class="modifiers">public abstract</span>&nbsp;<span class="type-parameters">&lt;T&gt;</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name">setBlocked</span><wbr><span class="parameters">(<a href="nodes/Node.html" title="class in com.oracle.truffle.api.nodes">Node</a>&nbsp;location,
 <a href="TruffleSafepoint.Interrupter.html" title="interface in com.oracle.truffle.api">TruffleSafepoint.Interrupter</a>&nbsp;interrupter,
 <a href="TruffleSafepoint.Interruptible.html" title="interface in com.oracle.truffle.api">TruffleSafepoint.Interruptible</a>&lt;T&gt;&nbsp;interruptible,
 T&nbsp;object,
 <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Runnable.html" title="class or interface in java.lang" class="external-link">Runnable</a>&nbsp;beforeInterrupt,
 <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/util/function/Consumer.html" title="class or interface in java.util.function" class="external-link">Consumer</a>&lt;<a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Throwable.html" title="class or interface in java.lang" class="external-link">Throwable</a>&gt;&nbsp;afterInterrupt)</span></div>
<div class="block">The same as
 <a href="#setBlockedFunction(com.oracle.truffle.api.nodes.Node,com.oracle.truffle.api.TruffleSafepoint.Interrupter,com.oracle.truffle.api.TruffleSafepoint.InterruptibleFunction,T,java.lang.Runnable,java.util.function.Consumer)"><code>setBlockedFunction(Node, Interrupter, InterruptibleFunction, Object, Runnable, Consumer)</code></a>.
 The only difference is that the interruptible functional method does not return anything.</div>
<dl class="notes">
<dt>Since:</dt>
<dd>23.1</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="setBlockedThreadInterruptible(com.oracle.truffle.api.nodes.Node,com.oracle.truffle.api.TruffleSafepoint.Interruptible,T)">
<h3 id="setBlockedThreadInterruptible(com.oracle.truffle.api.nodes.Node,com.oracle.truffle.api.TruffleSafepoint.Interruptible,java.lang.Object)">setBlockedThreadInterruptible</h3>
<div class="member-signature"><span class="modifiers">public static</span>&nbsp;<span class="type-parameters">&lt;T&gt;</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name">setBlockedThreadInterruptible</span><wbr><span class="parameters">(<a href="nodes/Node.html" title="class in com.oracle.truffle.api.nodes">Node</a>&nbsp;location,
 <a href="TruffleSafepoint.Interruptible.html" title="interface in com.oracle.truffle.api">TruffleSafepoint.Interruptible</a>&lt;T&gt;&nbsp;interruptible,
 T&nbsp;object)</span></div>
<div class="block">Short-cut method to allow setting the blocked status for methods that throw
 <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/InterruptedException.html" title="class or interface in java.lang" class="external-link"><code>InterruptedException</code></a> and support interrupting using <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Thread.html#interrupt()" title="class or interface in java.lang" class="external-link"><code>Thread.interrupt()</code></a>.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>location</code> - the location with which the safepoint should be polled.</dd>
<dd><code>interruptible</code> - the thread interruptable method to use for locking the object</dd>
<dd><code>object</code> - the instance to use the interruptable method with.</dd>
<dt>Since:</dt>
<dd>21.1</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="setBlockedThreadInterruptibleFunction(com.oracle.truffle.api.nodes.Node,com.oracle.truffle.api.TruffleSafepoint.InterruptibleFunction,T)">
<h3 id="setBlockedThreadInterruptibleFunction(com.oracle.truffle.api.nodes.Node,com.oracle.truffle.api.TruffleSafepoint.InterruptibleFunction,java.lang.Object)">setBlockedThreadInterruptibleFunction</h3>
<div class="member-signature"><span class="modifiers">public static</span>&nbsp;<span class="type-parameters">&lt;T,<wbr>
R&gt;</span>&nbsp;<span class="return-type">R</span>&nbsp;<span class="element-name">setBlockedThreadInterruptibleFunction</span><wbr><span class="parameters">(<a href="nodes/Node.html" title="class in com.oracle.truffle.api.nodes">Node</a>&nbsp;location,
 <a href="TruffleSafepoint.InterruptibleFunction.html" title="interface in com.oracle.truffle.api">TruffleSafepoint.InterruptibleFunction</a>&lt;T,<wbr>R&gt;&nbsp;interruptible,
 T&nbsp;object)</span></div>
<div class="block">Short-cut method to allow setting the blocked status for methods that throw
 <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/InterruptedException.html" title="class or interface in java.lang" class="external-link"><code>InterruptedException</code></a> and support interrupting using <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Thread.html#interrupt()" title="class or interface in java.lang" class="external-link"><code>Thread.interrupt()</code></a>.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>location</code> - the location with which the safepoint should be polled.</dd>
<dd><code>interruptible</code> - the thread interruptable method to use for locking the object</dd>
<dd><code>object</code> - the instance to use the interruptable method with.</dd>
<dt>Since:</dt>
<dd>23.1</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="setAllowActions(boolean)">
<h3>setAllowActions</h3>
<div class="member-signature"><span class="modifiers">public abstract</span>&nbsp;<span class="return-type">boolean</span>&nbsp;<span class="element-name">setAllowActions</span><wbr><span class="parameters">(boolean&nbsp;enabled)</span>
                                 throws <span class="exceptions"><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/IllegalStateException.html" title="class or interface in java.lang" class="external-link">IllegalStateException</a></span></div>
<div class="block">Allows to temporarily delay all thread local actions on the current thread. It is recommended
 to delay actions only for a constant period of time and while trusted and internal guest code
 is running. Please consider using <a href="#setAllowSideEffects(boolean)"><code>setAllowSideEffects(boolean)</code></a> before using this
 method. While actions are disabled the value of <a href="#setAllowSideEffects(boolean)"><code>setAllowSideEffects(boolean)</code></a> has no
 effect. When <a href="#setAllowActions(boolean)"><code>actions</code></a> are enabled again the value of
 <a href="#setAllowSideEffects(boolean)"><code>setAllowSideEffects(boolean)</code></a> will be interpreted again.
 <p>
 Currently this method may only be used during <a href="TruffleLanguage.html#finalizeContext(C)"><code>context finalization</code></a>. This could be necessary to free up native resources through guest code
 when a context is cancelled to avoid resource leakage. Any usage of this method should be
 subject to a detailed security review to ensure only internal and well-known guest code is
 executed. Disabling thread local actions may delay thread local actions like exit,
 cancellation and interruption.
 <p>
 Example usage:

 <pre>
 TruffleSafepoint sp = TruffleSafepoint.getCurrent();
 boolean prev = sp.setAllowActions(false);
 try {
     // critical section
 } finally {
     sp.setAllowActions(prev);
 }
 </pre></div>
<dl class="notes">
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/IllegalStateException.html" title="class or interface in java.lang" class="external-link">IllegalStateException</a></code> - if allow actions can currently not be set, for example outside
             the scope of a <a href="TruffleLanguage.html#finalizeContext(C)"><code>context
             finalization</code></a>.</dd>
<dt>Since:</dt>
<dd>22.1</dd>
<dt>See Also:</dt>
<dd>
<ul class="tag-list-long">
<li><a href="TruffleLanguage.html#finalizeContext(C)"><code>TruffleLanguage.finalizeContext(Object)</code></a></li>
</ul>
</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="setAllowSideEffects(boolean)">
<h3>setAllowSideEffects</h3>
<div class="member-signature"><span class="modifiers">public abstract</span>&nbsp;<span class="return-type">boolean</span>&nbsp;<span class="element-name">setAllowSideEffects</span><wbr><span class="parameters">(boolean&nbsp;enabled)</span></div>
<div class="block">Allows to temporarily delay side-effecting thread local actions on the current thread. It is
 recommended to delay side-effecting actions only for a short and constant period of time.
 <p>
 While side-effecting thread local actions are delayed on this thread, only non-side-effecting
 thread local actions will be scheduled in this thread. Non-side-effecting thread local
 actions do not mutate guest objects, run guest code or throw guest exceptions, but they might
 still throw internal errors.
 <p>
 Example usage:

 <pre>
 TruffleSafepoint sp = TruffleSafepoint.getCurrent();
 boolean prev = sp.setAllowSideEffects(false);
 try {
     // critical section
 } finally {
     sp.setAllowSideEffects(prev);
 }
 </pre></div>
<dl class="notes">
<dt>Since:</dt>
<dd>21.1</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="hasPendingSideEffectingActions()">
<h3>hasPendingSideEffectingActions</h3>
<div class="member-signature"><span class="modifiers">public abstract</span>&nbsp;<span class="return-type">boolean</span>&nbsp;<span class="element-name">hasPendingSideEffectingActions</span>()</div>
<div class="block">Returns whether there is any pending side-effecting thread local action on this thread, due
 to being in a critical section using <a href="#setAllowSideEffects(boolean)"><code>setAllowSideEffects(boolean)</code></a>. When
 side-effecting actions are allowed, this method always returns <code>false</code>.
 <p>
 This is useful if the language exposes a way to know if there are any pending side-effecting
 thread local action due to using <a href="#setAllowSideEffects(boolean)"><code>setAllowSideEffects(boolean)</code></a>.</div>
<dl class="notes">
<dt>Since:</dt>
<dd>21.1</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="getCurrent()">
<h3>getCurrent</h3>
<div class="member-signature"><span class="modifiers">public static</span>&nbsp;<span class="return-type"><a href="TruffleSafepoint.html" title="class in com.oracle.truffle.api">TruffleSafepoint</a></span>&nbsp;<span class="element-name">getCurrent</span>()</div>
<div class="block">Returns the current safepoint configuration for the current thread. This method is useful to
 access configuration methods like
 <a href="#setBlocked(com.oracle.truffle.api.nodes.Node,com.oracle.truffle.api.TruffleSafepoint.Interrupter,com.oracle.truffle.api.TruffleSafepoint.Interruptible,T,java.lang.Runnable,java.util.function.Consumer)"><code>setBlocked(Node, Interrupter, Interruptible, Object, Runnable, Consumer)</code></a> or
 <a href="#setAllowSideEffects(boolean)"><code>setAllowSideEffects(boolean)</code></a>.
 <p>
 Important: The result of this method must not be stored or used on a different thread than
 the current thread.</div>
<dl class="notes">
<dt>Since:</dt>
<dd>21.1</dd>
</dl>
</section>
</li>
</ul>
</section>
</li>
</ul>
</section>
<!-- ========= END OF CLASS DATA ========= -->
</main>
<footer role="contentinfo">
<hr>
<p class="legal-copy"><small><center>Copyright &copy; 2012, 2024, Oracle and/or its affiliates. All rights reserved.</center></small></p>
</footer>
</div>
</div>
</body>
</html>
