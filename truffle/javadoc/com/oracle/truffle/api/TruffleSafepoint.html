<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc -->
<title>TruffleSafepoint (GraalVM Truffle Java API Reference)</title>
<link rel="stylesheet" type="text/css" href="../../../../stylesheet.css" title="Style">
<script type="text/javascript" src="../../../../script.js"></script>
</head>
<body>
<script type="text/javascript"><!--
    try {
        if (location.href.indexOf('is-external=true') == -1) {
            parent.document.title="TruffleSafepoint (GraalVM Truffle Java API Reference)";
        }
    }
    catch(err) {
    }
//-->
var methods = {"i0":9,"i1":6,"i2":9,"i3":9,"i4":6,"i5":6,"i6":9,"i7":6};
var tabs = {65535:["t0","All Methods"],1:["t1","Static Methods"],2:["t2","Instance Methods"],4:["t3","Abstract Methods"],8:["t4","Concrete Methods"]};
var altColor = "altColor";
var rowColor = "rowColor";
var tableTab = "tableTab";
var activeTableTab = "activeTableTab";
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar.top">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.top" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.top.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../index-all.html">Index</a></li>
<li><a href="../../../../help-doc.html">Help</a></li>
</ul>
<div class="aboutLanguage"><b>GraalVM Truffle Java API Reference<br>22.3.0-dev</b><br>4488a34ed5a0084bfb0ce74d062ef7183854f7bb</div>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../com/oracle/truffle/api/TruffleRuntimeAccess.html" title="interface in com.oracle.truffle.api"><span class="typeNameLink">Prev&nbsp;Class</span></a></li>
<li><a href="../../../../com/oracle/truffle/api/TruffleSafepoint.CompiledInterruptible.html" title="interface in com.oracle.truffle.api"><span class="typeNameLink">Next&nbsp;Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../index.html?com/oracle/truffle/api/TruffleSafepoint.html" target="_top">Frames</a></li>
<li><a href="TruffleSafepoint.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li><a href="#nested.class.summary">Nested</a>&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a name="skip.navbar.top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="subTitle">com.oracle.truffle.api</div>
<h2 title="Class TruffleSafepoint" class="title">Class TruffleSafepoint</h2>
</div>
<div class="contentContainer">
<ul class="inheritance">
<li><a href="http://docs.oracle.com/javase/17/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">java.lang.Object</a></li>
<li>
<ul class="inheritance">
<li>com.oracle.truffle.api.TruffleSafepoint</li>
</ul>
</li>
</ul>
<div class="description">
<ul class="blockList">
<li class="blockList">
<hr>
<br>
<pre>public abstract class <span class="typeNameLabel">TruffleSafepoint</span>
extends <a href="http://docs.oracle.com/javase/17/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">Object</a></pre>
<div class="block">Truffle safepoints allow interrupting the guest language execution to execute thread-local
 actions submitted by a language or tool. A safepoint is a location during the guest language
 execution where the state is consistent, and other operations can read its state.
 <p>
 <h3>Supporting Safepoints in a Language</h3>
 <p>
 Safepoints are explicitly polled by invoking the <a href="../../../../com/oracle/truffle/api/TruffleSafepoint.html#poll-com.oracle.truffle.api.nodes.Node-"><code>TruffleSafepoint.poll(Node)</code></a> method. Safepoints are
 <a href="../../../../com/oracle/truffle/api/TruffleSafepoint.html#poll-com.oracle.truffle.api.nodes.Node-"><code>polled</code></a> with relaxed location or with <a href="../../../../com/oracle/truffle/api/TruffleSafepoint.html#pollHere-com.oracle.truffle.api.nodes.Node-"><code>exact location</code></a>.
 A poll with a relaxed location is significantly more efficient than a poll with a precise
 location as the compiler is able to move and combine the poll requests during compilation. A
 Truffle guest language implementation must ensure that a safepoint is polled repeatedly within a
 constant time interval. For example, a single arithmetic expression completes within a constant
 number of CPU cycles. However, a loop that summarizes values over an array uses a non-constant
 time dependent on the array size. This typically means that safepoints are best polled at the end
 of loops and at the end of function or method calls to cover recursion. In addition, any guest
 language code that blocks the execution, like guest language locks, need to use the
 <a href="../../../../com/oracle/truffle/api/TruffleSafepoint.html#setBlockedWithException-com.oracle.truffle.api.nodes.Node-com.oracle.truffle.api.TruffleSafepoint.Interrupter-com.oracle.truffle.api.TruffleSafepoint.Interruptible-T-java.lang.Runnable-java.util.function.Consumer-"><code>blocking API</code></a> to allow polling of safepoints while the thread is waiting.
 <p>
 Truffle's <a href="../../../../com/oracle/truffle/api/nodes/LoopNode.html" title="class in com.oracle.truffle.api.nodes"><code>loop node</code></a> and <a href="../../../../com/oracle/truffle/api/nodes/RootNode.html" title="class in com.oracle.truffle.api.nodes"><code>root node</code></a> support safepoint polling
 automatically. No further calls to <a href="../../../../com/oracle/truffle/api/TruffleSafepoint.html#poll-com.oracle.truffle.api.nodes.Node-"><code>TruffleSafepoint.poll(Node)</code></a> are therefore necessary. Custom loops or
 loops behind <a href="../../../../com/oracle/truffle/api/CompilerDirectives.TruffleBoundary.html" title="annotation in com.oracle.truffle.api"><code>boundary</code></a> annotated method calls are expected to be notified
 by the guest language implementation manually.
 <p>
 Thread local actions optionally incur side-effects. By default side-effects are enabled. A
 language implementation may disable side-effects temporarily for the current thread using
 <a href="../../../../com/oracle/truffle/api/TruffleSafepoint.html#setAllowSideEffects-boolean-"><code>TruffleSafepoint.setAllowSideEffects(boolean)</code></a> method.
 <p>

 <h3>Submitting thread local actions</h3>
 <p>
 See <a href="../../../../com/oracle/truffle/api/ThreadLocalAction.html" title="class in com.oracle.truffle.api"><code>ThreadLocalAction</code></a> for details on how to submit actions.
 <p>
 Further information can be found in the
 <a href="http://github.com/oracle/graal/blob/master/truffle/docs/Safepoints.md">safepoint
 tutorial</a>.</div>
<dl>
<dt><span class="simpleTagLabel">Since:</span></dt>
<dd>21.1</dd>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../com/oracle/truffle/api/ThreadLocalAction.html" title="class in com.oracle.truffle.api"><code>ThreadLocalAction</code></a>, 
<a href="../../../../org/graalvm/polyglot/Context.html#safepoint--"><code>Context.safepoint()</code></a></dd>
</dl>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- ======== NESTED CLASS SUMMARY ======== -->
<ul class="blockList">
<li class="blockList"><a name="nested.class.summary">
<!--   -->
</a>
<h3>Nested Class Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Nested Class Summary table, listing nested classes, and an explanation">
<caption><span>Nested Classes</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Class and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>static interface&nbsp;</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../com/oracle/truffle/api/TruffleSafepoint.CompiledInterruptible.html" title="interface in com.oracle.truffle.api">TruffleSafepoint.CompiledInterruptible</a>&lt;<a href="../../../../com/oracle/truffle/api/TruffleSafepoint.CompiledInterruptible.html" title="type parameter in TruffleSafepoint.CompiledInterruptible">T</a>&gt;</span></code>
<div class="block">Just like <a href="../../../../com/oracle/truffle/api/TruffleSafepoint.Interruptible.html" title="interface in com.oracle.truffle.api"><code>TruffleSafepoint.Interruptible</code></a> but allows partial evaluation.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>static interface&nbsp;</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../com/oracle/truffle/api/TruffleSafepoint.Interrupter.html" title="interface in com.oracle.truffle.api">TruffleSafepoint.Interrupter</a></span></code>
<div class="block">An interrupter allows a foreign thread to interrupt the execution on a separate thread.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>static interface&nbsp;</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../com/oracle/truffle/api/TruffleSafepoint.Interruptible.html" title="interface in com.oracle.truffle.api">TruffleSafepoint.Interruptible</a>&lt;<a href="../../../../com/oracle/truffle/api/TruffleSafepoint.Interruptible.html" title="type parameter in TruffleSafepoint.Interruptible">T</a>&gt;</span></code>
<div class="block">Function interface that represent interruptable Java methods.</div>
</td>
</tr>
</table>
</li>
</ul>
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor.summary">
<!--   -->
</a>
<h3>Constructor Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Constructor Summary table, listing constructors, and an explanation">
<caption><span>Constructors</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier</th>
<th class="colLast" scope="col">Constructor and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>protected </code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../com/oracle/truffle/api/TruffleSafepoint.html#TruffleSafepoint-com.oracle.truffle.api.impl.Accessor.EngineSupport-">TruffleSafepoint</a></span>(com.oracle.truffle.api.impl.Accessor.EngineSupport&nbsp;support)</code>
<div class="block">Do not extend this class.</div>
</td>
</tr>
</table>
</li>
</ul>
<!-- ========== METHOD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="method.summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Method Summary table, listing methods, and an explanation">
<caption><span id="t0" class="activeTableTab"><span>All Methods</span><span class="tabEnd">&nbsp;</span></span><span id="t1" class="tableTab"><span><a href="javascript:show(1);">Static Methods</a></span><span class="tabEnd">&nbsp;</span></span><span id="t2" class="tableTab"><span><a href="javascript:show(2);">Instance Methods</a></span><span class="tabEnd">&nbsp;</span></span><span id="t3" class="tableTab"><span><a href="javascript:show(4);">Abstract Methods</a></span><span class="tabEnd">&nbsp;</span></span><span id="t4" class="tableTab"><span><a href="javascript:show(8);">Concrete Methods</a></span><span class="tabEnd">&nbsp;</span></span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Method and Description</th>
</tr>
<tr id="i0" class="altColor">
<td class="colFirst"><code>static <a href="../../../../com/oracle/truffle/api/TruffleSafepoint.html" title="class in com.oracle.truffle.api">TruffleSafepoint</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../com/oracle/truffle/api/TruffleSafepoint.html#getCurrent--">getCurrent</a></span>()</code>
<div class="block">Returns the current safepoint configuration for the current thread.</div>
</td>
</tr>
<tr id="i1" class="rowColor">
<td class="colFirst"><code>abstract boolean</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../com/oracle/truffle/api/TruffleSafepoint.html#hasPendingSideEffectingActions--">hasPendingSideEffectingActions</a></span>()</code>
<div class="block">Returns whether there is any pending side-effecting thread local action on this thread, due
 to being in a critical section using <a href="../../../../com/oracle/truffle/api/TruffleSafepoint.html#setAllowSideEffects-boolean-"><code>TruffleSafepoint.setAllowSideEffects(boolean)</code></a>.</div>
</td>
</tr>
<tr id="i2" class="altColor">
<td class="colFirst"><code>static void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../com/oracle/truffle/api/TruffleSafepoint.html#poll-com.oracle.truffle.api.nodes.Node-">poll</a></span>(<a href="../../../../com/oracle/truffle/api/nodes/Node.html" title="class in com.oracle.truffle.api.nodes">Node</a>&nbsp;location)</code>
<div class="block">Polls a safepoint at the provided location.</div>
</td>
</tr>
<tr id="i3" class="rowColor">
<td class="colFirst"><code>static void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../com/oracle/truffle/api/TruffleSafepoint.html#pollHere-com.oracle.truffle.api.nodes.Node-">pollHere</a></span>(<a href="../../../../com/oracle/truffle/api/nodes/Node.html" title="class in com.oracle.truffle.api.nodes">Node</a>&nbsp;location)</code>
<div class="block">Similar to <a href="../../../../com/oracle/truffle/api/TruffleSafepoint.html#poll-com.oracle.truffle.api.nodes.Node-"><code>TruffleSafepoint.poll(Node)</code></a> but with exact location.</div>
</td>
</tr>
<tr id="i4" class="altColor">
<td class="colFirst"><code>abstract boolean</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../com/oracle/truffle/api/TruffleSafepoint.html#setAllowActions-boolean-">setAllowActions</a></span>(boolean&nbsp;enabled)</code>
<div class="block">Allows to temporarily delay all thread local actions on the current thread.</div>
</td>
</tr>
<tr id="i5" class="rowColor">
<td class="colFirst"><code>abstract boolean</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../com/oracle/truffle/api/TruffleSafepoint.html#setAllowSideEffects-boolean-">setAllowSideEffects</a></span>(boolean&nbsp;enabled)</code>
<div class="block">Allows to temporarily delay side-effecting thread local actions on the current thread.</div>
</td>
</tr>
<tr id="i6" class="altColor">
<td class="colFirst"><code>static &lt;T&gt;&nbsp;void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../com/oracle/truffle/api/TruffleSafepoint.html#setBlockedThreadInterruptible-com.oracle.truffle.api.nodes.Node-com.oracle.truffle.api.TruffleSafepoint.Interruptible-T-">setBlockedThreadInterruptible</a></span>(<a href="../../../../com/oracle/truffle/api/nodes/Node.html" title="class in com.oracle.truffle.api.nodes">Node</a>&nbsp;location,
                             <a href="../../../../com/oracle/truffle/api/TruffleSafepoint.Interruptible.html" title="interface in com.oracle.truffle.api">TruffleSafepoint.Interruptible</a>&lt;T&gt;&nbsp;interruptible,
                             T&nbsp;object)</code>
<div class="block">Short-cut method to allow setting the blocked status for methods that throw
 <a href="http://docs.oracle.com/javase/17/docs/api/java/lang/InterruptedException.html?is-external=true" title="class or interface in java.lang"><code>InterruptedException</code></a> and support interrupting using <a href="http://docs.oracle.com/javase/17/docs/api/java/lang/Thread.html?is-external=true#interrupt--" title="class or interface in java.lang"><code>Thread.interrupt()</code></a>.</div>
</td>
</tr>
<tr id="i7" class="rowColor">
<td class="colFirst"><code>abstract &lt;T&gt;&nbsp;void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../com/oracle/truffle/api/TruffleSafepoint.html#setBlockedWithException-com.oracle.truffle.api.nodes.Node-com.oracle.truffle.api.TruffleSafepoint.Interrupter-com.oracle.truffle.api.TruffleSafepoint.Interruptible-T-java.lang.Runnable-java.util.function.Consumer-">setBlockedWithException</a></span>(<a href="../../../../com/oracle/truffle/api/nodes/Node.html" title="class in com.oracle.truffle.api.nodes">Node</a>&nbsp;location,
                       <a href="../../../../com/oracle/truffle/api/TruffleSafepoint.Interrupter.html" title="interface in com.oracle.truffle.api">TruffleSafepoint.Interrupter</a>&nbsp;interrupter,
                       <a href="../../../../com/oracle/truffle/api/TruffleSafepoint.Interruptible.html" title="interface in com.oracle.truffle.api">TruffleSafepoint.Interruptible</a>&lt;T&gt;&nbsp;interruptible,
                       T&nbsp;object,
                       <a href="http://docs.oracle.com/javase/17/docs/api/java/lang/Runnable.html?is-external=true" title="class or interface in java.lang">Runnable</a>&nbsp;beforeInterrupt,
                       <a href="http://docs.oracle.com/javase/17/docs/api/java/util/function/Consumer.html?is-external=true" title="class or interface in java.util.function">Consumer</a>&lt;<a href="http://docs.oracle.com/javase/17/docs/api/java/lang/Throwable.html?is-external=true" title="class or interface in java.lang">Throwable</a>&gt;&nbsp;afterInterrupt)</code>
<div class="block">Transitions the current thread into a blocked state and calls an interruptible functional
 method.</div>
</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a name="methods.inherited.from.class.java.lang.Object">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;java.lang.<a href="http://docs.oracle.com/javase/17/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">Object</a></h3>
<code><a href="http://docs.oracle.com/javase/17/docs/api/java/lang/Object.html?is-external=true#clone--" title="class or interface in java.lang">clone</a>, <a href="http://docs.oracle.com/javase/17/docs/api/java/lang/Object.html?is-external=true#equals-java.lang.Object-" title="class or interface in java.lang">equals</a>, <a href="http://docs.oracle.com/javase/17/docs/api/java/lang/Object.html?is-external=true#getClass--" title="class or interface in java.lang">getClass</a>, <a href="http://docs.oracle.com/javase/17/docs/api/java/lang/Object.html?is-external=true#hashCode--" title="class or interface in java.lang">hashCode</a>, <a href="http://docs.oracle.com/javase/17/docs/api/java/lang/Object.html?is-external=true#notify--" title="class or interface in java.lang">notify</a>, <a href="http://docs.oracle.com/javase/17/docs/api/java/lang/Object.html?is-external=true#notifyAll--" title="class or interface in java.lang">notifyAll</a>, <a href="http://docs.oracle.com/javase/17/docs/api/java/lang/Object.html?is-external=true#toString--" title="class or interface in java.lang">toString</a>, <a href="http://docs.oracle.com/javase/17/docs/api/java/lang/Object.html?is-external=true#wait--" title="class or interface in java.lang">wait</a>, <a href="http://docs.oracle.com/javase/17/docs/api/java/lang/Object.html?is-external=true#wait-long-" title="class or interface in java.lang">wait</a>, <a href="http://docs.oracle.com/javase/17/docs/api/java/lang/Object.html?is-external=true#wait-long-int-" title="class or interface in java.lang">wait</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor.detail">
<!--   -->
</a>
<h3>Constructor Detail</h3>
<a name="TruffleSafepoint-com.oracle.truffle.api.impl.Accessor.EngineSupport-">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>TruffleSafepoint</h4>
<pre>protected&nbsp;TruffleSafepoint(com.oracle.truffle.api.impl.Accessor.EngineSupport&nbsp;support)</pre>
<div class="block">Do not extend this class. This class is intended to be implemented by a Truffle runtime
 implementation.</div>
<dl>
<dt><span class="simpleTagLabel">Since:</span></dt>
<dd>21.1</dd>
</dl>
</li>
</ul>
</li>
</ul>
<!-- ============ METHOD DETAIL ========== -->
<ul class="blockList">
<li class="blockList"><a name="method.detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a name="poll-com.oracle.truffle.api.nodes.Node-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>poll</h4>
<pre>public static&nbsp;void&nbsp;poll(<a href="../../../../com/oracle/truffle/api/nodes/Node.html" title="class in com.oracle.truffle.api.nodes">Node</a>&nbsp;location)</pre>
<div class="block">Polls a safepoint at the provided location. This allows to run thread local actions at this
 location. A Truffle guest language implementation must ensure that a safepoint is polled
 repeatedly within a constant time interval. See <a href="../../../../com/oracle/truffle/api/TruffleSafepoint.html" title="class in com.oracle.truffle.api"><code>TruffleSafepoint</code></a> for further details.
 <p>
 In compiled code calls to this method are removed. Instead the compiler inserts safepoints
 automatically at loop ends and method exits. In this case the node location is approximated
 by frame state of method ends and loop exits in the compiler IR. For method ends the parent
 root node and for loop exits the loop node is passed as location.
 <p>
 Guest language exceptions may be thrown by this method. If
 <a href="../../../../com/oracle/truffle/api/TruffleSafepoint.html#setAllowSideEffects-boolean-"><code>side-effects</code></a> are allowed then also guest language
 exceptions may be thrown. Otherwise only internal or <a href="http://docs.oracle.com/javase/17/docs/api/java/lang/ThreadDeath.html?is-external=true" title="class or interface in java.lang"><code>thread-death</code></a>
 exceptions may be thrown. This method is safe to be used on compiled code paths.
 <p>
 Example usage with an unbounded loop sum behind a <a href="../../../../com/oracle/truffle/api/CompilerDirectives.TruffleBoundary.html" title="annotation in com.oracle.truffle.api"><code>CompilerDirectives.TruffleBoundary</code></a>.

 <pre>
 &#64;TruffleBoundary
 int sum(int[] array) {
     int sum = 0;
     for (int i = 0; i < array.length; i++) {
         sum += array[i];

         TruffleSafepoint.poll();
     }
     return sum;
 }
 </pre></div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>location</code> - the location of the poll. Must not be <code>null</code>.</dd>
<dt><span class="simpleTagLabel">Since:</span></dt>
<dd>21.1</dd>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../com/oracle/truffle/api/TruffleSafepoint.html" title="class in com.oracle.truffle.api"><code>TruffleSafepoint</code></a>, 
<a href="../../../../com/oracle/truffle/api/TruffleSafepoint.html#pollHere-com.oracle.truffle.api.nodes.Node-"><code>TruffleSafepoint.pollHere(Node)</code></a></dd>
</dl>
</li>
</ul>
<a name="pollHere-com.oracle.truffle.api.nodes.Node-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>pollHere</h4>
<pre>public static&nbsp;void&nbsp;pollHere(<a href="../../../../com/oracle/truffle/api/nodes/Node.html" title="class in com.oracle.truffle.api.nodes">Node</a>&nbsp;location)</pre>
<div class="block">Similar to <a href="../../../../com/oracle/truffle/api/TruffleSafepoint.html#poll-com.oracle.truffle.api.nodes.Node-"><code>TruffleSafepoint.poll(Node)</code></a> but with exact location. A poll with <a href="../../../../com/oracle/truffle/api/TruffleSafepoint.html#poll-com.oracle.truffle.api.nodes.Node-"><code>relaxed location</code></a> is significantly more efficient than a poll with precise location as the
 compiler is able to move and combine the poll requests during compilation. This method is
 safe to be used on compiled code paths.
 <p>
 Usage example:

 <pre>
 TruffleSafepoint safepoint = TruffleSafepoint.getCurrent();
 boolean prev = safepoint.setAllowSideEffects(false);
 try {
     // criticial section
 } finally {
     safepoint.setAllowSideEffects(prev);
     TruffleSafepoint.pollHere(this);
 }
 </pre></div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>location</code> - the location of the poll. Must not be <code>null</code>.</dd>
<dt><span class="simpleTagLabel">Since:</span></dt>
<dd>21.1</dd>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../com/oracle/truffle/api/TruffleSafepoint.html#poll-com.oracle.truffle.api.nodes.Node-"><code>TruffleSafepoint.poll(Node)</code></a></dd>
</dl>
</li>
</ul>
<a name="setBlockedWithException-com.oracle.truffle.api.nodes.Node-com.oracle.truffle.api.TruffleSafepoint.Interrupter-com.oracle.truffle.api.TruffleSafepoint.Interruptible-java.lang.Object-java.lang.Runnable-java.util.function.Consumer-">
<!--   -->
</a><a name="setBlockedWithException-com.oracle.truffle.api.nodes.Node-com.oracle.truffle.api.TruffleSafepoint.Interrupter-com.oracle.truffle.api.TruffleSafepoint.Interruptible-T-java.lang.Runnable-java.util.function.Consumer-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>setBlockedWithException</h4>
<pre>public abstract&nbsp;&lt;T&gt;&nbsp;void&nbsp;setBlockedWithException(<a href="../../../../com/oracle/truffle/api/nodes/Node.html" title="class in com.oracle.truffle.api.nodes">Node</a>&nbsp;location,
                                                 <a href="../../../../com/oracle/truffle/api/TruffleSafepoint.Interrupter.html" title="interface in com.oracle.truffle.api">TruffleSafepoint.Interrupter</a>&nbsp;interrupter,
                                                 <a href="../../../../com/oracle/truffle/api/TruffleSafepoint.Interruptible.html" title="interface in com.oracle.truffle.api">TruffleSafepoint.Interruptible</a>&lt;T&gt;&nbsp;interruptible,
                                                 T&nbsp;object,
                                                 <a href="http://docs.oracle.com/javase/17/docs/api/java/lang/Runnable.html?is-external=true" title="class or interface in java.lang">Runnable</a>&nbsp;beforeInterrupt,
                                                 <a href="http://docs.oracle.com/javase/17/docs/api/java/util/function/Consumer.html?is-external=true" title="class or interface in java.util.function">Consumer</a>&lt;<a href="http://docs.oracle.com/javase/17/docs/api/java/lang/Throwable.html?is-external=true" title="class or interface in java.lang">Throwable</a>&gt;&nbsp;afterInterrupt)</pre>
<div class="block">Transitions the current thread into a blocked state and calls an interruptible functional
 method. The blocked state is restored when the interruptible method returns. Setting the
 blocked state allows safepoint notification while the current thread is blocked. This allows
 Truffle to interrupt e.g. locks temporarily to perform a thread local action.
 <p>
 The <code>location></code> parameter is used <a href="../../../../com/oracle/truffle/api/TruffleSafepoint.html#poll-com.oracle.truffle.api.nodes.Node-"><code>poll</code></a> all pending thread
 local actions before transition to blocked state.
 <p>
 The <code>interrupter</code> parameter specifies how the blocked state can be interrupted
 from another thread. The interrupter allows to interrupt the blocked state from other
 threads. For most blocking java.util.concurrent primitives the
 <a href="../../../../com/oracle/truffle/api/TruffleSafepoint.Interrupter.html#THREAD_INTERRUPT"><code>thread interrupter</code></a> can be used. If the thread will be
 blocked in native code, other ways of interrupting, like signals may be used by implementing
 the <a href="../../../../com/oracle/truffle/api/TruffleSafepoint.Interrupter.html" title="interface in com.oracle.truffle.api"><code>TruffleSafepoint.Interrupter</code></a> interface.
 <p>
 The <code>interruptible</code> parameter provides the method that calls the blocking method
 which throws <a href="http://docs.oracle.com/javase/17/docs/api/java/lang/InterruptedException.html?is-external=true" title="class or interface in java.lang"><code>InterruptedException</code></a> on interrupt. In order to avoid allocations of the
 functional interface a single argument can be provided that is passed to the interface. This
 is typically the <a href="http://docs.oracle.com/javase/17/docs/api/java/util/concurrent/locks/Lock.html?is-external=true" title="class or interface in java.util.concurrent.locks"><code>lock</code></a> or <a href="http://docs.oracle.com/javase/17/docs/api/java/util/concurrent/Semaphore.html?is-external=true" title="class or interface in java.util.concurrent"><code>semaphore</code></a> instance. The
 implementation of this method is expected to throw an <a href="http://docs.oracle.com/javase/17/docs/api/java/lang/InterruptedException.html?is-external=true" title="class or interface in java.lang"><code>InterruptedException</code></a> if the
 <a href="../../../../com/oracle/truffle/api/TruffleSafepoint.Interrupter.html#interrupt-java.lang.Thread-"><code>TruffleSafepoint.Interrupter.interrupt(Thread)</code></a> method is invoked for this thread. For most
 java.util.concurrent primitives this is supported by using the interruptible blocking method
 variant, for example <a href="http://docs.oracle.com/javase/17/docs/api/java/util/concurrent/locks/Lock.html?is-external=true#lockInterruptibly--" title="class or interface in java.util.concurrent.locks"><code>Lock.lockInterruptibly()</code></a>.
 <p>
 Since it is common to use this method with method reference syntax e.g.
 <code>Lock::lockInterruptibly</code> for the interruptible parameter, we implicitlely apply a
 <a href="../../../../com/oracle/truffle/api/CompilerDirectives.TruffleBoundary.html" title="annotation in com.oracle.truffle.api"><code>boundary</code></a> for the entire method call by default. If the interruptible
 is called from a compiled code path and the interruptible should get partial evaluated, then
 <a href="../../../../com/oracle/truffle/api/TruffleSafepoint.CompiledInterruptible.html" title="interface in com.oracle.truffle.api"><code>TruffleSafepoint.CompiledInterruptible</code></a> should be used instead of <a href="../../../../com/oracle/truffle/api/TruffleSafepoint.Interruptible.html" title="interface in com.oracle.truffle.api"><code>TruffleSafepoint.Interruptible</code></a>. In this case
 the parameter must be a <a href="../../../../com/oracle/truffle/api/CompilerDirectives.html#isPartialEvaluationConstant-java.lang.Object-"><code>partial
 evaluation constant</code></a>.
 <p>
 The <code>beforeInterrupt</code> <a href="http://docs.oracle.com/javase/17/docs/api/java/lang/Runnable.html?is-external=true" title="class or interface in java.lang"><code>runnable</code></a> and <code>afterInterrupt</code>
 <a href="http://docs.oracle.com/javase/17/docs/api/java/util/function/Consumer.html?is-external=true" title="class or interface in java.util.function"><code>consumer</code></a> optional parameters allow to run code before and after a thread got
 interrupted and safepoint events are processed. If <code>null</code> is provided then no
 action will be performed. Arbitrary code may be executed in this runnable. Note that the
 blocked state is temporarily reset to its previous state while the afterInterrupt is called.
 <p>
 If an exception is thrown during the processing of the safepoint, <code>afterInterrupt</code>
 will receive the throwable as argument, or <code>null</code> if the safepoint successfully
 completed. This exception will still be thrown after completion of
 <code>afterInterrupt</code>, unless <code>afterInterrupt</code> throws an exception of its
 own.

 <p>
 Multiple recursive invocations of this method is supported. The previous blocked state will
 be restored when the method completes or fails.
 <p>
 Example usage:
 <p>
 Note there is a short-cut method to achieve the same behavior as in this example
 <a href="../../../../com/oracle/truffle/api/TruffleSafepoint.html#setBlockedThreadInterruptible-com.oracle.truffle.api.nodes.Node-com.oracle.truffle.api.TruffleSafepoint.Interruptible-T-"><code>TruffleSafepoint.setBlockedThreadInterruptible(Node, Interruptible, Object)</code></a>.

 <pre>
 Lock lock = new ReentrantLock();
 TruffleSafepoint sp = TruffleSafepoint.getCurrent();
 sp.setBlocked(location, Interrupter.THREAD_INTERRUPT, ReentrantLock::lockInterruptibly, lock, null, null);
 </pre></div>
<dl>
<dt><span class="simpleTagLabel">Since:</span></dt>
<dd>22.1</dd>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../com/oracle/truffle/api/TruffleSafepoint.html" title="class in com.oracle.truffle.api"><code>TruffleSafepoint</code></a></dd>
</dl>
</li>
</ul>
<a name="setBlockedThreadInterruptible-com.oracle.truffle.api.nodes.Node-com.oracle.truffle.api.TruffleSafepoint.Interruptible-java.lang.Object-">
<!--   -->
</a><a name="setBlockedThreadInterruptible-com.oracle.truffle.api.nodes.Node-com.oracle.truffle.api.TruffleSafepoint.Interruptible-T-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>setBlockedThreadInterruptible</h4>
<pre>public static&nbsp;&lt;T&gt;&nbsp;void&nbsp;setBlockedThreadInterruptible(<a href="../../../../com/oracle/truffle/api/nodes/Node.html" title="class in com.oracle.truffle.api.nodes">Node</a>&nbsp;location,
                                                     <a href="../../../../com/oracle/truffle/api/TruffleSafepoint.Interruptible.html" title="interface in com.oracle.truffle.api">TruffleSafepoint.Interruptible</a>&lt;T&gt;&nbsp;interruptible,
                                                     T&nbsp;object)</pre>
<div class="block">Short-cut method to allow setting the blocked status for methods that throw
 <a href="http://docs.oracle.com/javase/17/docs/api/java/lang/InterruptedException.html?is-external=true" title="class or interface in java.lang"><code>InterruptedException</code></a> and support interrupting using <a href="http://docs.oracle.com/javase/17/docs/api/java/lang/Thread.html?is-external=true#interrupt--" title="class or interface in java.lang"><code>Thread.interrupt()</code></a>.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>location</code> - the location with which the safepoint should be polled.</dd>
<dd><code>interruptible</code> - the thread interruptable method to use for locking the object</dd>
<dd><code>object</code> - the instance to use the interruptable method with.</dd>
<dt><span class="simpleTagLabel">Since:</span></dt>
<dd>21.1</dd>
</dl>
</li>
</ul>
<a name="setAllowActions-boolean-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>setAllowActions</h4>
<pre>public abstract&nbsp;boolean&nbsp;setAllowActions(boolean&nbsp;enabled)
                                 throws <a href="http://docs.oracle.com/javase/17/docs/api/java/lang/IllegalStateException.html?is-external=true" title="class or interface in java.lang">IllegalStateException</a></pre>
<div class="block">Allows to temporarily delay all thread local actions on the current thread. It is recommended
 to delay actions only for a constant period of time and while trusted and internal guest code
 is running. Please consider using <a href="../../../../com/oracle/truffle/api/TruffleSafepoint.html#setAllowSideEffects-boolean-"><code>TruffleSafepoint.setAllowSideEffects(boolean)</code></a> before using this
 method. While actions are disabled the value of <a href="../../../../com/oracle/truffle/api/TruffleSafepoint.html#setAllowSideEffects-boolean-"><code>TruffleSafepoint.setAllowSideEffects(boolean)</code></a> has no
 effect. When <a href="../../../../com/oracle/truffle/api/TruffleSafepoint.html#setAllowActions-boolean-"><code>actions</code></a> are enabled again the value of
 <a href="../../../../com/oracle/truffle/api/TruffleSafepoint.html#setAllowSideEffects-boolean-"><code>TruffleSafepoint.setAllowSideEffects(boolean)</code></a> will be interpreted again.
 <p>
 Currently this method may only be used during <a href="../../../../com/oracle/truffle/api/TruffleLanguage.html#finalizeContext-C-"><code>context finalization</code></a>. This could be necessary to free up native resources through guest code
 when a context is cancelled to avoid resource leakage. Any usage of this method should be
 subject to a detailed security review to ensure only internal and well-known guest code is
 executed. Disabling thread local actions may delay thread local actions like exit,
 cancellation and interruption.
 <p>
 Example usage:

 <pre>
 TruffleSafepoint sp = TruffleSafepoint.getCurrent();
 boolean prev = sp.setAllowActions(false);
 try {
     // critical section
 } finally {
     sp.setAllowActions(prev);
 }
 </pre></div>
<dl>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="http://docs.oracle.com/javase/17/docs/api/java/lang/IllegalStateException.html?is-external=true" title="class or interface in java.lang">IllegalStateException</a></code> - if allow actions can currently not be set, for example outside
             the scope of a <a href="../../../../com/oracle/truffle/api/TruffleLanguage.html#finalizeContext-C-"><code>context
             finalization</code></a>.</dd>
<dt><span class="simpleTagLabel">Since:</span></dt>
<dd>22.1</dd>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../com/oracle/truffle/api/TruffleLanguage.html#finalizeContext-C-"><code>TruffleLanguage.finalizeContext(Object)</code></a></dd>
</dl>
</li>
</ul>
<a name="setAllowSideEffects-boolean-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>setAllowSideEffects</h4>
<pre>public abstract&nbsp;boolean&nbsp;setAllowSideEffects(boolean&nbsp;enabled)</pre>
<div class="block">Allows to temporarily delay side-effecting thread local actions on the current thread. It is
 recommended to delay side-effecting actions only for a short and constant period of time.
 <p>
 While side-effecting thread local actions are delayed on this thread, only non-side-effecting
 thread local actions will be scheduled in this thread. Non-side-effecting thread local
 actions do not mutate guest objects, run guest code or throw guest exceptions, but they might
 still throw internal errors.
 <p>
 Example usage:

 <pre>
 TruffleSafepoint sp = TruffleSafepoint.getCurrent();
 boolean prev = sp.setAllowSideEffects(false);
 try {
     // critical section
 } finally {
     sp.setAllowSideEffects(prev);
 }
 </pre></div>
<dl>
<dt><span class="simpleTagLabel">Since:</span></dt>
<dd>21.1</dd>
</dl>
</li>
</ul>
<a name="hasPendingSideEffectingActions--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>hasPendingSideEffectingActions</h4>
<pre>public abstract&nbsp;boolean&nbsp;hasPendingSideEffectingActions()</pre>
<div class="block">Returns whether there is any pending side-effecting thread local action on this thread, due
 to being in a critical section using <a href="../../../../com/oracle/truffle/api/TruffleSafepoint.html#setAllowSideEffects-boolean-"><code>TruffleSafepoint.setAllowSideEffects(boolean)</code></a>. When
 side-effecting actions are allowed, this method always returns <code>false</code>.
 <p>
 This is useful if the language exposes a way to know if there are any pending side-effecting
 thread local action due to using <a href="../../../../com/oracle/truffle/api/TruffleSafepoint.html#setAllowSideEffects-boolean-"><code>TruffleSafepoint.setAllowSideEffects(boolean)</code></a>.</div>
<dl>
<dt><span class="simpleTagLabel">Since:</span></dt>
<dd>21.1</dd>
</dl>
</li>
</ul>
<a name="getCurrent--">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>getCurrent</h4>
<pre>public static&nbsp;<a href="../../../../com/oracle/truffle/api/TruffleSafepoint.html" title="class in com.oracle.truffle.api">TruffleSafepoint</a>&nbsp;getCurrent()</pre>
<div class="block">Returns the current safepoint configuration for the current thread. This method is useful to
 access configuration methods like
 <a href="../../../../com/oracle/truffle/api/TruffleSafepoint.html#setBlockedWithException-com.oracle.truffle.api.nodes.Node-com.oracle.truffle.api.TruffleSafepoint.Interrupter-com.oracle.truffle.api.TruffleSafepoint.Interruptible-T-java.lang.Runnable-java.util.function.Consumer-"><code>TruffleSafepoint.setBlockedWithException(Node, Interrupter, Interruptible, Object, Runnable, Consumer)</code></a>
 or <a href="../../../../com/oracle/truffle/api/TruffleSafepoint.html#setAllowSideEffects-boolean-"><code>TruffleSafepoint.setAllowSideEffects(boolean)</code></a>.
 <p>
 Important: The result of this method must not be stored or used on a different thread than
 the current thread.</div>
<dl>
<dt><span class="simpleTagLabel">Since:</span></dt>
<dd>21.1</dd>
</dl>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<!-- ========= END OF CLASS DATA ========= -->
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar.bottom">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.bottom" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.bottom.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../index-all.html">Index</a></li>
<li><a href="../../../../help-doc.html">Help</a></li>
</ul>
<div class="aboutLanguage"><b>GraalVM Truffle Java API Reference<br>22.3.0-dev</b><br>4488a34ed5a0084bfb0ce74d062ef7183854f7bb</div>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../com/oracle/truffle/api/TruffleRuntimeAccess.html" title="interface in com.oracle.truffle.api"><span class="typeNameLink">Prev&nbsp;Class</span></a></li>
<li><a href="../../../../com/oracle/truffle/api/TruffleSafepoint.CompiledInterruptible.html" title="interface in com.oracle.truffle.api"><span class="typeNameLink">Next&nbsp;Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../index.html?com/oracle/truffle/api/TruffleSafepoint.html" target="_top">Frames</a></li>
<li><a href="TruffleSafepoint.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li><a href="#nested.class.summary">Nested</a>&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a name="skip.navbar.bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
<p class="legalCopy"><small><center>Copyright &copy; 2012, 2022, Oracle and/or its affiliates. All rights reserved.</center></small></p>
</body>
</html>
