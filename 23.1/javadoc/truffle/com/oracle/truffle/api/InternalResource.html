<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc -->
<title>InternalResource (GraalVM Truffle Java API Reference)</title>
<link rel="stylesheet" type="text/css" href="../../../../stylesheet.css" title="Style">
<script type="text/javascript" src="../../../../script.js"></script>
</head>
<body>
<script type="text/javascript"><!--
    try {
        if (location.href.indexOf('is-external=true') == -1) {
            parent.document.title="InternalResource (GraalVM Truffle Java API Reference)";
        }
    }
    catch(err) {
    }
//-->
var methods = {"i0":6,"i1":6};
var tabs = {65535:["t0","All Methods"],2:["t2","Instance Methods"],4:["t3","Abstract Methods"]};
var altColor = "altColor";
var rowColor = "rowColor";
var tableTab = "tableTab";
var activeTableTab = "activeTableTab";
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar.top">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.top" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.top.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../index-all.html">Index</a></li>
<li><a href="../../../../help-doc.html">Help</a></li>
</ul>
<div class="aboutLanguage"><b>GraalVM Truffle Java API Reference<br>23.1.10-dev</b><br>de703a7cacdfe47be879ac24a0f366bc4ca2d5c5</div>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../com/oracle/truffle/api/InstrumentInfo.html" title="class in com.oracle.truffle.api"><span class="typeNameLink">Prev&nbsp;Class</span></a></li>
<li><a href="../../../../com/oracle/truffle/api/InternalResource.CPUArchitecture.html" title="enum in com.oracle.truffle.api"><span class="typeNameLink">Next&nbsp;Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../index.html?com/oracle/truffle/api/InternalResource.html" target="_top">Frames</a></li>
<li><a href="InternalResource.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li><a href="#nested.class.summary">Nested</a>&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a name="skip.navbar.top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="subTitle">com.oracle.truffle.api</div>
<h2 title="Interface InternalResource" class="title">Interface InternalResource</h2>
</div>
<div class="contentContainer">
<div class="description">
<ul class="blockList">
<li class="blockList">
<hr>
<br>
<pre>public interface <span class="typeNameLabel">InternalResource</span></pre>
<div class="block">Represents an internal resource of a language that can be lazily unpacked to a cache user
 directory.
 <p>
 A typical implementation of an <code>InternalResource</code> for a platform-specific library stored in
 the <code>META-INF/resources/&lt;language-id&gt;/&lt;resource-id&gt;/&lt;os&gt;/&lt;arch&gt;</code> looks like this:

 <pre>
 &#64;InternalResource.Id("resource-id")
 final class NativeLibResource implements InternalResource {

     &#64;Override
     public void unpackFiles(Env env, Path targetDirectory) throws IOException {
         Path base = Path.of("META-INF", "resources", "mylanguage", "resource-id",
                         env.getOS().toString(), env.getCPUArchitecture().toString());
         env.unpackResourceFiles(base.resolve("file-list"), targetDirectory, base);
     }

     &#64;Override
     public String versionHash(Env env) {
         try {
             Path hashResource = Path.of("META-INF", "resources", "mylanguage", "resource-id",
                             env.getOS().toString(), env.getCPUArchitecture().toString(), "sha256");
             return env.readResourceLines(hashResource).get(0);
         } catch (IOException ioe) {
             throw CompilerDirectives.shouldNotReachHere(ioe);
         }
     }
 }
 </pre>

 The resource files are listed in the
 <code>META-INF/resources/&lt;language-id&gt;/&lt;resource-id&gt;/&lt;os&gt;/&lt;arch&gt;/file-list</code> file. For the file
 list format, refer to <a href="../../../../com/oracle/truffle/api/InternalResource.html#unpackFiles-com.oracle.truffle.api.InternalResource.Env-java.nio.file.Path-"><code>InternalResource.unpackFiles(Env, Path)</code></a>. Additionally, the
 <code>META-INF/resources/&lt;language-id&gt;/&lt;resource-id&gt;/&lt;os&gt;/&lt;arch&gt;/sha256</code> file contains an
 SHA-256 hash of the resource files. It is recommended to use non-encapsulated resource paths that
 include the component ID and resource ID, as this helps prevent ambiguity when the language or
 instrument is used in an unnamed module.</div>
<dl>
<dt><span class="simpleTagLabel">Since:</span></dt>
<dd>23.1</dd>
</dl>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- ======== NESTED CLASS SUMMARY ======== -->
<ul class="blockList">
<li class="blockList"><a name="nested.class.summary">
<!--   -->
</a>
<h3>Nested Class Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Nested Class Summary table, listing nested classes, and an explanation">
<caption><span>Nested Classes</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Interface and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>static class&nbsp;</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../com/oracle/truffle/api/InternalResource.CPUArchitecture.html" title="enum in com.oracle.truffle.api">InternalResource.CPUArchitecture</a></span></code>
<div class="block">Represents a supported CPU architecture.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>static class&nbsp;</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../com/oracle/truffle/api/InternalResource.Env.html" title="class in com.oracle.truffle.api">InternalResource.Env</a></span></code>
<div class="block">Access to common utilities for unpacking resource files.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>static interface&nbsp;</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../com/oracle/truffle/api/InternalResource.Id.html" title="annotation in com.oracle.truffle.api">InternalResource.Id</a></span></code>
<div class="block">The annotation used to lookup <a href="../../../../com/oracle/truffle/api/InternalResource.html" title="interface in com.oracle.truffle.api"><code>InternalResource</code></a> by an id.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>static class&nbsp;</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../com/oracle/truffle/api/InternalResource.OS.html" title="enum in com.oracle.truffle.api">InternalResource.OS</a></span></code>
<div class="block">Represents a supported operating system.</div>
</td>
</tr>
</table>
</li>
</ul>
<!-- ========== METHOD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="method.summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Method Summary table, listing methods, and an explanation">
<caption><span id="t0" class="activeTableTab"><span>All Methods</span><span class="tabEnd">&nbsp;</span></span><span id="t2" class="tableTab"><span><a href="javascript:show(2);">Instance Methods</a></span><span class="tabEnd">&nbsp;</span></span><span id="t3" class="tableTab"><span><a href="javascript:show(4);">Abstract Methods</a></span><span class="tabEnd">&nbsp;</span></span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Method and Description</th>
</tr>
<tr id="i0" class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../com/oracle/truffle/api/InternalResource.html#unpackFiles-com.oracle.truffle.api.InternalResource.Env-java.nio.file.Path-">unpackFiles</a></span>(<a href="../../../../com/oracle/truffle/api/InternalResource.Env.html" title="class in com.oracle.truffle.api">InternalResource.Env</a>&nbsp;env,
           <a href="http://docs.oracle.com/javase/21/docs/api/java/nio/file/Path.html?is-external=true" title="class or interface in java.nio.file">Path</a>&nbsp;targetDirectory)</code>
<div class="block">Unpacks all resources to a given target directory.</div>
</td>
</tr>
<tr id="i1" class="rowColor">
<td class="colFirst"><code><a href="http://docs.oracle.com/javase/21/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../com/oracle/truffle/api/InternalResource.html#versionHash-com.oracle.truffle.api.InternalResource.Env-">versionHash</a></span>(<a href="../../../../com/oracle/truffle/api/InternalResource.Env.html" title="class in com.oracle.truffle.api">InternalResource.Env</a>&nbsp;env)</code>
<div class="block">Returns the version hash to be used for this resource.</div>
</td>
</tr>
</table>
</li>
</ul>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ============ METHOD DETAIL ========== -->
<ul class="blockList">
<li class="blockList"><a name="method.detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a name="unpackFiles-com.oracle.truffle.api.InternalResource.Env-java.nio.file.Path-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>unpackFiles</h4>
<pre>void&nbsp;unpackFiles(<a href="../../../../com/oracle/truffle/api/InternalResource.Env.html" title="class in com.oracle.truffle.api">InternalResource.Env</a>&nbsp;env,
                 <a href="http://docs.oracle.com/javase/21/docs/api/java/nio/file/Path.html?is-external=true" title="class or interface in java.nio.file">Path</a>&nbsp;targetDirectory)
          throws <a href="http://docs.oracle.com/javase/21/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</a></pre>
<div class="block">Unpacks all resources to a given target directory. The target directory is guaranteed to be
 writable and the unpacking is synchronized by a file system lock. If a resource was
 previously cached then <a href="../../../../com/oracle/truffle/api/InternalResource.html#versionHash-com.oracle.truffle.api.InternalResource.Env-"><code>InternalResource.versionHash(Env)</code></a> is invoked and the version string is
 compared. If it matches then <a href="../../../../com/oracle/truffle/api/InternalResource.html#unpackFiles-com.oracle.truffle.api.InternalResource.Env-java.nio.file.Path-"><code>InternalResource.unpackFiles(Env, Path)</code></a> will not be invoked and the
 directory will be used as previously unpacked. The target directory is guaranteed to exist
 and guaranteed to be empty.
 <p>
 Ideally the result of this method should be idempotent in order to be safely cacheable. Care
 should be taken, if system properties are used that change the result of this method. It is
 safe to use <a href="../../../../com/oracle/truffle/api/InternalResource.OS.html" title="enum in com.oracle.truffle.api"><code>InternalResource.OS</code></a> and <a href="../../../../com/oracle/truffle/api/InternalResource.CPUArchitecture.html" title="enum in com.oracle.truffle.api"><code>InternalResource.CPUArchitecture</code></a> enums as internal resources are never
 cached or moved across operating system architectures.
 <p>
 No guest language code must run as part of this method.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>targetDirectory</code> - the target directory to extract files to</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="http://docs.oracle.com/javase/21/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</a></code></dd>
<dt><span class="simpleTagLabel">Since:</span></dt>
<dd>23.1</dd>
</dl>
</li>
</ul>
<a name="versionHash-com.oracle.truffle.api.InternalResource.Env-">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>versionHash</h4>
<pre><a href="http://docs.oracle.com/javase/21/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a>&nbsp;versionHash(<a href="../../../../com/oracle/truffle/api/InternalResource.Env.html" title="class in com.oracle.truffle.api">InternalResource.Env</a>&nbsp;env)</pre>
<div class="block">Returns the version hash to be used for this resource. It is the responsibility of the
 implementer to ensure that this version hash is unique. For example, an SHA-256 could be a
 good version identifier for file based resources. Since the version hash serves as a path
 component on the host filesystem, its length is restricted to a maximum of 128 bytes. If the
 version hash length exceeds this limit, an <code>IOException</code> will be thrown during
 unpacking.</div>
<dl>
<dt><span class="simpleTagLabel">Since:</span></dt>
<dd>23.1</dd>
</dl>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<!-- ========= END OF CLASS DATA ========= -->
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar.bottom">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.bottom" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.bottom.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../index-all.html">Index</a></li>
<li><a href="../../../../help-doc.html">Help</a></li>
</ul>
<div class="aboutLanguage"><b>GraalVM Truffle Java API Reference<br>23.1.10-dev</b><br>de703a7cacdfe47be879ac24a0f366bc4ca2d5c5</div>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../com/oracle/truffle/api/InstrumentInfo.html" title="class in com.oracle.truffle.api"><span class="typeNameLink">Prev&nbsp;Class</span></a></li>
<li><a href="../../../../com/oracle/truffle/api/InternalResource.CPUArchitecture.html" title="enum in com.oracle.truffle.api"><span class="typeNameLink">Next&nbsp;Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../index.html?com/oracle/truffle/api/InternalResource.html" target="_top">Frames</a></li>
<li><a href="InternalResource.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li><a href="#nested.class.summary">Nested</a>&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a name="skip.navbar.bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
<p class="legalCopy"><small><center>Copyright &copy; 2012, 2025, Oracle and/or its affiliates. All rights reserved.</center></small></p>
</body>
</html>
