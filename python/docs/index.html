<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta property="og:image" content='/python/assets/img/graalvm.png' />

  
  <title>GraalPy - Documentation</title><link rel="canonical" href="/docs/"><link rel="apple-touch-icon" sizes="180x180" href='/python/assets/img/favicons/apple-touch-icon.png'>
  <link rel="icon" type="image/png" sizes="32x32" href='/python/assets/img/favicons/favicon-32x32.png'>
  <link rel="icon" type="image/png" sizes="16x16" href='/python/assets/img/favicons/favicon-16x16.png'>

  <link rel="stylesheet" href="/python/assets/lib/bootstrap/css/bootstrap.min.css">
  <link rel="stylesheet" href="/python/assets/css/style.css">
  <link rel="stylesheet" href="/python/assets/css/highlight.css">

  <script src='/python/assets/lib/jquery/jquery-3.7.1.min.js'></script>

  <script src='/python/assets/lib/bootstrap/js/bootstrap.min.js'></script>

  <script src='/python/assets/lib/sticky-sidebar/resizeSensor.js'></script>
  <script src='/python/assets/lib/sticky-sidebar/sticky-sidebar.min.js'></script>

  <script async defer src="https://buttons.github.io/buttons.js"></script></head>

  <body>
    <header class="site-header site--header">
  <div class="container">
  <div class="wrapper">
    <a class="menu__logo" href="/python/">
      <img src='/python/assets/logo.svg' alt="project logo">
    </a>
    <nav class="site-nav">
      <ul class="menu__list">
        <li class="menu__item">
          <a href='/python/docs/' class="menu__link">Documentation</a>
        </li><li class="menu__item">
          <a href='/python/compatibility/' class="menu__link">Compatibility</a>
        </li>
        <li class="menu__item">
          <div class="stack-container">
            <a href="#" class="menu__link stack__header">Graal Projects</a>
            <div class="stack-menu">
              <div class="stack-row">
                <div class="stack-column">
                  <div class="stack__item">
                    <img alt="JavaScript icon" src="/python/assets/img/header-navigation/js-navi.svg">
                    <a href="https://graalvm.org/javascript/" class="item-line">GraalJS</a>
                  </div>
                  <div class="stack__item">
                    <img alt="Python icon" src="/python/assets/img/header-navigation/python-navi.svg">
                    <a href="https://graalvm.org/python/" class="item-line">GraalPy</a>
                  </div>
                  <div class="stack__item">
                    <img alt="WebAssembly icon" src="/python/assets/img/header-navigation/wasm-navi.svg">
                    <a href="https://graalvm.org/webassembly/" class="item-line">GraalWasm</a>
                  </div>
                  <div class="stack__item">
                    <img alt="Java icon" src="/python/assets/img/header-navigation/java-navi.svg">
                    <a href='https://graalvm.org/reference-manual/java-on-truffle/' class="item-line">Espresso</a>
                  </div>
                  <div class="stack__item">
                    <img alt="Ruby icon" src="/python/assets/img/header-navigation/ruby-navi.svg">
                    <a href="https://graalvm.org/ruby/" class="item-line">TruffleRuby</a>
                  </div>
                </div>
                <div class="stack-column">
                  <div class="stack__item">
                    <img alt="GraalVM icon" src="/python/assets/img/header-navigation/graalvm.svg">
                    <a href="https://graalvm.org/" class="item-line">GraalVM</a>
                  </div>
                  <div class="stack__item">
                    <img alt="Graal Stack icon" src="/python/assets/img/header-navigation/graalstack.svg">
                    <a href="https://graal.cloud/" class="item-line">Graal Stack</a>
                  </div>
                  <div class="stack__item">
                    <img alt="Graal Dev Kit for Micronaut icon" src="/python/assets/img/header-navigation/gdk.svg">
                    <a href="https://graal.cloud/gdk/" class="item-line">Graal Dev Kit for Micronaut</a>
                  </div>
                  <div class="stack__item">
                    <img alt="GraalOS icon" src="/python/assets/img/header-navigation/graalos.svg">
                    <a href="https://graal.cloud/graalos/" class="item-line">GraalOS</a>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </li>
        <div class="menu__item icons githubstar" tabindex="0">
          <span class="github-widget">
            <a tabindex="-1" class="github-button" href="https://github.com/oracle/graalpython" data-icon="octicon-star"
              data-show-count="true" aria-label="Star oracle/graalpython on GitHub">Star</a>
          </span>
        </div>
      </ul>
      <div role="button" class="menu-btn menu-btn--menu js-show-menu" tabindex="-1" title="sweet hamburger">
        <div class="hamburger">
          <div class="inner"></div>
        </div>
      </div>
    </nav>
  </div>
  </div>
</header>

    <main class="page-content" aria-label="Content">
      <article id="docs-page">
  <div class="row">
    <div class="col-sm-3 docsimpro col-bg sidebar-container">
      <div class="sidebar-wrap">
        <div class="sidebar sidestyle">
          <div class="toc-container">
            <ul class="toc">
            </ul>
          </div>
        </div>
      </div>
    </div>
    <div class="col-sm-9 docsmod content-container">
      <div id="content-wrapper" class="docs-content docs-content--with-sidebar">
        <h2 id="getting-started-with-graalpy-on-the-jvm"><a href="#getting-started-with-graalpy-on-the-jvm" class="anchor-link">Getting Started with GraalPy on the JVM</a></h2>

<p>You can use GraalPy with GraalVM JDK, Oracle JDK, or OpenJDK.
You can easily add GraalPy to your Java application using Maven or Gradle build tools as shown below.
Other build systems (Ant, Make, CMake, and so on) can also be used with a bit more manual work.</p>

<h3 id="maven"><a href="#maven" class="anchor-link">Maven</a></h3>

<p>GraalPy can generate a Maven project that embeds Python packages into a Java application using <a href="https://central.sonatype.com/namespace/org.graalvm.python">Maven artefacts</a>.</p>

<ol>
  <li>GraalPy project publishes a Maven archetype to generate a starter project:
    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>mvn archetype:generate <span class="se">\</span>
  <span class="nt">-DarchetypeGroupId</span><span class="o">=</span>org.graalvm.python <span class="se">\</span>
  <span class="nt">-DarchetypeArtifactId</span><span class="o">=</span>graalpy-archetype-polyglot-app <span class="se">\</span>
  <span class="nt">-DarchetypeVersion</span><span class="o">=</span>24.1.0
</code></pre></div>    </div>
  </li>
  <li>Build a native executable using the <a href="https://www.graalvm.org/latest/reference-manual/native-image/">GraalVM Native Image “tool”</a> plugin that was added for you automatically:
    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code> mvn <span class="nt">-Pnative</span> package
</code></pre></div>    </div>
  </li>
  <li>Once completed, run the executable:
    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code> ./target/polyglot_app
</code></pre></div>    </div>
    <p>The application prints “hello java” to the console.</p>
  </li>
</ol>

<p>The project uses the <a href="https://www.graalvm.org/sdk/javadoc/org/graalvm/polyglot/package-summary.html">GraalVM Polyglot API</a> with additional features to manage Python virtual environments and integrate Python package dependencies with a Maven workflow.
The Java code and the <em>pom.xml</em> file are heavily documented and the generated code describes available features.</p>

<p>See also <a href="#graalpy-maven-plugin">Embedding Build Tools</a> for more information about the GraalPy Maven Plugin.</p>

<h4 id="creating-cross-platform-jars-with-native-python-packages"><a href="#creating-cross-platform-jars-with-native-python-packages" class="anchor-link">Creating Cross-platform JARs with Native Python Packages</a></h4>

<p>The generated project uses the GraalPy Maven plugin, which makes it easy to add Python dependencies.
However, Python packages may have native components that are specific to the build system.
In order to distribute the resulting application for other systems, follow these steps:</p>

<ol>
  <li>
    <p>Build the project on each deployment platform.
Rename JAR files so they each have a platform-specific name and move them to a temporary directory on the same machine.</p>
  </li>
  <li>
    <p>Unzip each of the JAR files (substituting the correct names for the JAR files).
A special file, <em>vfs/fileslist.txt</em> needs to be concatenated from each JAR file.
Finally, create a new <em>combined.jar</em> from the combination of all files and with the concatenated <em>fileslist.txt</em>.</p>
    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code> unzip linux.jar <span class="nt">-d</span> combined
 <span class="nb">mv </span>combined/vfs/fileslist.txt fileslist-linux.txt
 unzip windows.jar <span class="nt">-d</span> combined
 <span class="nb">mv </span>combined/vfs/fileslist.txt fileslist-windows.txt
 <span class="nb">cat </span>fileslist-linux.txt fileslist-windows.txt <span class="o">&gt;</span> combined/vfs/fileslist.txt
 <span class="nb">cd </span>combined
 zip <span class="nt">-r</span> ../combined.jar <span class="k">*</span>
</code></pre></div>    </div>
  </li>
</ol>

<h3 id="gradle"><a href="#gradle" class="anchor-link">Gradle</a></h3>

<blockquote>
  <p>Note: GraalPy Gradle Plugin will become available as of GraalPy version 24.1.1, planned for October 15, 2024.</p>
</blockquote>

<ol>
  <li>Create a Java application with Gradle using the command below and follow the prompts (select the Groovy build script language, select a test framework, and so on):
    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code> gradle init <span class="nt">--type</span> java-application <span class="se">\</span>
             <span class="nt">--project-name</span> interop  <span class="se">\</span>
             <span class="nt">--package</span> interop <span class="se">\</span>
             <span class="nt">--no-split-project</span>
</code></pre></div>    </div>

    <p>The project is generated in the current working directory with the following structure:</p>
    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code> └── app
     ├── build.gradle
     └── src
         └── main
             ├── java
             │   └── interop
             │       └── App.java
             └── resources
</code></pre></div>    </div>
  </li>
  <li>Open your project configuration file, <em>app/build.gradle</em>, and modify it as follows.
    <ul>
      <li>Include the GraalPy support and the <a href="https://www.graalvm.org/sdk/javadoc/org/graalvm/polyglot/package-summary.html">GraalVM Polyglot API</a> in the <code>dependencies</code> section:
        <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  implementation<span class="o">(</span><span class="s2">"org.graalvm.polyglot:polyglot:24.1.1"</span><span class="o">)</span>
  implementation<span class="o">(</span><span class="s2">"org.graalvm.polyglot:python:24.1.1"</span><span class="o">)</span>
</code></pre></div>        </div>
      </li>
    </ul>
  </li>
  <li>Finally, replace the code in the file named <em>App.java</em> as follows for a small Python embedding:
    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="kn">package</span> <span class="nn">interop</span><span class="o">;</span>

 <span class="kn">import</span> <span class="nn">org.graalvm.polyglot.*</span><span class="o">;</span>

 <span class="kd">class</span> <span class="nc">App</span> <span class="o">{</span>
     <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
         <span class="k">try</span> <span class="o">(</span><span class="kt">var</span> <span class="n">context</span> <span class="o">=</span> <span class="nc">Context</span><span class="o">.</span><span class="na">create</span><span class="o">())</span> <span class="o">{</span>
             <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">context</span><span class="o">.</span><span class="na">eval</span><span class="o">(</span><span class="s">"python"</span><span class="o">,</span> <span class="s">"'Hello Python!'"</span><span class="o">).</span><span class="na">asString</span><span class="o">());</span>
         <span class="o">}</span>
     <span class="o">}</span>
 <span class="o">}</span>
</code></pre></div>    </div>
  </li>
  <li>Run the application with Gradle:
    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code> ./gradlew run
</code></pre></div>    </div>
    <p>The application prints “Hello Python!” to the console.</p>

    <blockquote>
      <p>Note: The performance of the GraalPy runtime depends on the JDK in which you embed it. For more information, see <a href="https://www.graalvm.org/latest/reference-manual/embed-languages/#runtime-optimization-support">Runtime Optimization Support</a>.</p>
    </blockquote>
  </li>
  <li>
    <p>Optionally, you can also use a third-party Python package.</p>

    <p>5.1. In <em>app/build.gradle</em>:</p>
    <ul>
      <li>add the graalpy-gradle-plugin to the <code>plugins</code> section:
        <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">id</span> <span class="s2">"org.graalvm.python"</span> version <span class="s2">"24.1.1"</span>
</code></pre></div>        </div>
      </li>
      <li>configure the GraalPy Gradle plugin:
        <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>graalPy <span class="o">{</span> 
 packages <span class="o">=</span> <span class="o">[</span><span class="s2">"termcolor==2.2"</span><span class="o">]</span>
<span class="o">}</span>
</code></pre></div>        </div>
      </li>
    </ul>

    <p>5.2. In <em>settings.gradle</em>, add the following <code>pluginManagement</code> configuration.</p>
    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>pluginManagement <span class="o">{</span>
   repositories <span class="o">{</span>
      gradlePluginPortal<span class="o">()</span>        
   <span class="o">}</span>
<span class="o">}</span>
</code></pre></div>    </div>

    <p>5.3. Update the file named <em>App.java</em> as follows:</p>
    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>   <span class="kn">package</span> <span class="nn">interop</span><span class="o">;</span>
   
   <span class="kn">import</span> <span class="nn">org.graalvm.polyglot.*</span><span class="o">;</span>
   <span class="kn">import</span> <span class="nn">org.graalvm.python.embedding.GraalPyResources</span><span class="o">;</span>
   
   <span class="kd">class</span> <span class="nc">App</span> <span class="o">{</span>
   <span class="o">...</span>
   <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
       <span class="k">try</span> <span class="o">(</span><span class="nc">Context</span> <span class="n">context</span> <span class="o">=</span> <span class="nc">GraalPyResources</span><span class="o">.</span><span class="na">createContext</span><span class="o">())</span> <span class="o">{</span>
           <span class="nc">String</span> <span class="n">src</span> <span class="o">=</span> <span class="sh">"""
           from termcolor import colored
           colored_text = colored("hello java", "red", attrs=["reverse", "blink"])
           print(colored_text)
           """</span><span class="o">;</span>
           <span class="n">context</span><span class="o">.</span><span class="na">eval</span><span class="o">(</span><span class="s">"python"</span><span class="o">,</span> <span class="n">src</span><span class="o">);</span>
       <span class="o">}</span>
   <span class="o">}</span>
</code></pre></div>    </div>
  </li>
</ol>

<p>See also <a href="#embedding-build-tools">Embedding Build Tools</a> for more information about the GraalPy Gradle Plugin.</p>

<h3 id="ant-cmake-makefile-or-other-build-systems-without-direct-support-for-maven-dependencies"><a href="#ant-cmake-makefile-or-other-build-systems-without-direct-support-for-maven-dependencies" class="anchor-link">Ant, CMake, Makefile or Other Build Systems Without Direct Support for Maven Dependencies</a></h3>

<p>Some (often older) projects may be using Ant, Makefiles, CMake, or other build systems that do not directly support Maven dependencies.
Projects such as <a href="https://ant.apache.org/ivy/history/master/tutorial/start.html">Apache Ivy™</a> enable such build systems to resolve Maven dependencies, but developers may have reasons not to use them.
GraalPy comes with a tool to obtain the required JAR files from Maven.</p>

<ol>
  <li>
    <p>Assuming there is some directory where third-party dependencies are stored for the project and that the build system is set up to put any JAR files there on the classpath, the project directory tree might look similar to this:</p>

    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code> ├───lib
 │   └─── ... <span class="k">*</span>.jar dependencies are here
 └───src
     └─── ... <span class="k">*</span>.java files and resources are here
</code></pre></div>    </div>
  </li>
  <li>
    <p><a href="#installing-graalpy">Install GraalPy</a> for your system and ensure you have <code>graalpy</code> on your <code>PATH</code>.
Open a command-line interface and enter your project directory.
Then, as appropriate for your system, run one of the following commands:</p>

    <p>In a POSIX shell:</p>
    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="nb">export </span><span class="nv">GRAALPY_HOME</span><span class="o">=</span><span class="si">$(</span>graalpy <span class="nt">-c</span> <span class="s1">'print(__graalpython__.home)'</span><span class="si">)</span>
 <span class="s2">"</span><span class="k">${</span><span class="nv">GRAALPY_HOME</span><span class="k">}</span><span class="s2">/libexec/graalpy-polyglot-get"</span> <span class="nt">-a</span> python <span class="nt">-o</span> lib <span class="nt">-v</span> <span class="s2">"24.1.0"</span>
</code></pre></div>    </div>

    <p>In PowerShell:</p>
    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="nv">$GRAALPY_HOME</span> <span class="o">=</span> graalpy <span class="nt">-c</span> <span class="s2">"print(__graalpython__.home)"</span>
 &amp; <span class="s2">"</span><span class="nv">$GRAALPY_HOME</span><span class="s2">/libexec/graalpy-polyglot-get"</span> <span class="nt">-a</span> python <span class="nt">-o</span> lib <span class="nt">-v</span> <span class="s2">"24.1.0"</span>
</code></pre></div>    </div>

    <p>These commands download all GraalPy dependencies into the <em>lib</em> directory.</p>
  </li>
  <li>
    <p>Provided that your build system is set up to pick up the JAR files from <em>lib</em>, the GraalPy embedding code below should work if put in an appropriate place in the project to run as the main class.</p>

    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="kn">import</span> <span class="nn">org.graalvm.polyglot.*</span><span class="o">;</span>

 <span class="kd">public</span> <span class="kd">class</span> <span class="nc">Hello</span> <span class="o">{</span>
     <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
         <span class="k">try</span> <span class="o">(</span><span class="kt">var</span> <span class="n">context</span> <span class="o">=</span> <span class="nc">Context</span><span class="o">.</span><span class="na">newBuilder</span><span class="o">().</span><span class="na">option</span><span class="o">(</span><span class="s">"engine.WarnInterpreterOnly"</span><span class="o">,</span> <span class="s">"false"</span><span class="o">).</span><span class="na">build</span><span class="o">())</span> <span class="o">{</span>
             <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">context</span><span class="o">.</span><span class="na">eval</span><span class="o">(</span><span class="s">"python"</span><span class="o">,</span> <span class="s">"'Hello Python!'"</span><span class="o">).</span><span class="na">asString</span><span class="o">());</span>
         <span class="o">}</span>
     <span class="o">}</span>
 <span class="o">}</span>
</code></pre></div>    </div>
  </li>
</ol>

<h3 id="testing-python-applications-and-packages-on-graalpy"><a href="#testing-python-applications-and-packages-on-graalpy" class="anchor-link">Testing Python Applications and Packages on GraalPy</a></h3>

<p>Go <a href="#testing-python-applications-and-packages-on-graalpy">here</a> to get a CPython compatible distribution of GraalPy to test Python applications and packages.</p>

<h5 id="related-documentation"><a href="#related-documentation" class="anchor-link">Related Documentation</a></h5>

<ul>
  <li><a href="#modern-python-for-the-jvm">Modern Python on the JVM</a></li>
  <li><a href="https://www.graalvm.org/latest/reference-manual/embed-languages/">Embedding Graal languages in Java</a></li>
</ul>

<h2 id="testing-python-applications-and-packages-on-graalpy"><a href="#testing-python-applications-and-packages-on-graalpy" class="anchor-link">Testing Python Applications and Packages on GraalPy</a></h2>

<h3 id="choosing-the-graalpy-runtime"><a href="#choosing-the-graalpy-runtime" class="anchor-link">Choosing the GraalPy Runtime</a></h3>

<p>GraalPy provides a Python 3.11 compliant runtime. 
A primary goal is to support PyTorch, SciPy, and their constituent libraries, as well as to work with other data science and machine learning libraries from the rich Python ecosystem.
GraalPy is distributed as an ahead-of-time compiled native executable, compact in size.</p>

<p>GraalPy provides the following capabilities:</p>

<ul>
  <li>CPython-compatible distribution. This is the most compatible option to test Python code on GraalPy, since it most closely resembles the structure of CPython distributions.</li>
  <li>Unique deployment mode for Python applications. Compile a Python application on GraalPy to <a href="#python-standalone-applications">a single native binary</a> that embeds all needed resources.</li>
  <li>Access to GraalVM’s language ecosystems and tools. GraalPy can run many standard Python tools as well as tools from the GraalVM ecosystem.</li>
</ul>

<h4 id="graalpy-distributions"><a href="#graalpy-distributions" class="anchor-link">GraalPy Distributions</a></h4>

<p>GraalPy is available as <strong>GraalPy built on Oracle GraalVM</strong> and <strong>GraalPy Community</strong>.</p>

<ul>
  <li>
    <p>GraalPy built on top of Oracle GraalVM provides the best experience: it comes with additional optimizations, is significantly faster and more memory-efficient. It is licensed under the <a href="https://www.oracle.com/downloads/licenses/graal-free-license.html">GraalVM Free Terms and Conditions (GFTC)</a> license, same as Oracle GraalVM, which permits use by any user including commercial and production use.
Redistribution is permitted as long as it is not for a fee.</p>
  </li>
  <li>
    <p>GraalPy Community is built on top of GraalVM Community Edition, and is fully open-source.</p>
  </li>
</ul>

<p>Two language runtime options are available for the Oracle and Community distributions of GraalPy:</p>

<ul>
  <li>Native
    <ul>
      <li>GraalPy is compiled ahead-of-time to a native executable.</li>
      <li>This means that you do not need a JVM to run GraalPy and it is compact in size.</li>
    </ul>
  </li>
  <li>JVM
    <ul>
      <li>You can easily exploit Java interoperability.</li>
      <li>Peak performance may be higher than the native option.</li>
    </ul>
  </li>
</ul>

<h4 id="graalpy-identification"><a href="#graalpy-identification" class="anchor-link">GraalPy Identification</a></h4>

<p>The four GraalPy runtimes are identified as follows, using the general pattern <em>graalpy(-community)(-jvm)-&lt;version&gt;-&lt;os&gt;-&lt;arch&gt;</em>:</p>

<table>
  <tr>
    <th>&nbsp;</th>
    <th>Oracle</th>
    <th>Community</th>
  </tr>
  <tr>
    <th>Native</th>
    <td>graalpy-&lt;version&gt;-&lt;os&gt;-&lt;arch&gt;</td>
    <td>graalpy-community-&lt;version&gt;-&lt;os&gt;-&lt;arch&gt;</td>
  </tr>
  <tr>
    <th>JVM</th>
    <td>graalpy-jvm-&lt;version&gt;-&lt;os&gt;-&lt;arch&gt;</td>
    <td>graalpy-community-jvm-&lt;version&gt;-&lt;os&gt;-&lt;arch&gt;</td>
  </tr>
</table>

<h4 id="comparison"><a href="#comparison" class="anchor-link">Comparison</a></h4>

<table>
  <thead>
    <tr>
      <th style="text-align: left">Runtime</th>
      <th style="text-align: left">Native (default)</th>
      <th style="text-align: left">JVM</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left">Time to start</td>
      <td style="text-align: left">faster</td>
      <td style="text-align: left">slower</td>
    </tr>
    <tr>
      <td style="text-align: left">Time to reach peak performance</td>
      <td style="text-align: left">faster</td>
      <td style="text-align: left">slower</td>
    </tr>
    <tr>
      <td style="text-align: left">Peak performance (also considering GC)</td>
      <td style="text-align: left">good</td>
      <td style="text-align: left">best</td>
    </tr>
    <tr>
      <td style="text-align: left">Java interoperability</td>
      <td style="text-align: left">needs configuration</td>
      <td style="text-align: left">works</td>
    </tr>
  </tbody>
</table>

<h3 id="installing-graalpy"><a href="#installing-graalpy" class="anchor-link">Installing GraalPy</a></h3>

<blockquote>
  <p>NOTE: There will be a delay between GraalPy release and its availability on Pyenv.</p>
</blockquote>

<h4 id="linux"><a href="#linux" class="anchor-link">Linux</a></h4>

<p>The easiest way to install GraalPy on Linux is to use <a href="https://github.com/pyenv/pyenv">Pyenv</a> (the Python version manager).
To install version 24.1.0 using Pyenv, run the following commands:</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>pyenv <span class="nb">install </span>graalpy-24.1.0
</code></pre></div></div>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>pyenv shell graalpy-24.1.0
</code></pre></div></div>
<blockquote>
  <p>Before running <code>pyenv install</code>, you may need to update <code>pyenv</code> to include the latest GraalPy versions.</p>
</blockquote>

<p>Alternatively, you can download a compressed GraalPy installation file from <a href="https://github.com/oracle/graalpython/releases">GitHub releases</a>.</p>

<ol>
  <li>Find the download that matches the pattern <em>graalpy-XX.Y.Z-linux-amd64.tar.gz</em> or <em>graalpy-XX.Y.Z-linux-aarch64.tar.gz</em> (depending on your platform) and download.</li>
  <li>Uncompress the file and update your <code>PATH</code> environment variable to include to the <em>graalpy-XX.Y.Z-linux-amd64/bin</em> (or <em>graalpy-XX.Y.Z-linux-aarch64/bin</em>) directory.</li>
</ol>

<h4 id="macos"><a href="#macos" class="anchor-link">macOS</a></h4>

<p>The easiest way to install GraalPy on macOS is to use <a href="https://github.com/pyenv/pyenv">Pyenv</a> (the Python version manager).
To install version 24.1.0 using Pyenv, run the following commands:</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>pyenv <span class="nb">install </span>graalpy-24.1.0
</code></pre></div></div>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>pyenv shell graalpy-24.1.0
</code></pre></div></div>
<blockquote>
  <p>Before running <code>pyenv install</code>, you may need to update <code>pyenv</code> to include the latest GraalPy versions.</p>
</blockquote>

<p>Alternatively, you can download a compressed GraalPy installation file from <a href="https://github.com/oracle/graalpython/releases">GitHub releases</a>.</p>

<ol>
  <li>Find the download that matches the pattern <em>graalpy-XX.Y.Z-macos-amd64.tar.gz</em> or <em>graalpy-XX.Y.Z-macos-aarch64.tar.gz</em> (depending on your platform) and download.</li>
  <li>Remove the quarantine attribute.
    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="nb">sudo </span>xattr <span class="nt">-r</span> <span class="nt">-d</span> com.apple.quarantine /path/to/graalpy
</code></pre></div>    </div>
    <p>For example:</p>
    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="nb">sudo </span>xattr <span class="nt">-r</span> <span class="nt">-d</span> com.apple.quarantine ~/.pyenv/versions/graalpy-24.1.0
</code></pre></div>    </div>
  </li>
  <li>Uncompress the file and update your <code>PATH</code> environment variable to include to the <em>graalpy-XX.Y.Z-macos-amd64/bin</em> (or <em>graalpy-XX.Y.Z-macos-aarch64/bin</em>) directory.</li>
</ol>

<h4 id="windows"><a href="#windows" class="anchor-link">Windows</a></h4>

<ol>
  <li>Find and download a compressed GraalPy installation file from <a href="https://github.com/oracle/graalpython/releases">GitHub releases</a> that matches the pattern <em>graalpy-XX.Y.Z-windows-amd64.tar.gz</em>.</li>
  <li>Uncompress the file and update your <code>PATH</code> variable to include to the <em>graalpy-XX.Y.Z-windows-amd64/bin</em> directory.</li>
</ol>

<h5 id="windows-limitations"><a href="#windows-limitations" class="anchor-link">Windows Limitations</a></h5>

<p>The Windows distribution of GraalPy has more limitations than its Linux or macOS counterpart, so not all features and packages may be available.</p>

<p>It has the following known issues:</p>
<ul>
  <li>JLine treats Windows as a dumb terminal, with no autocomplete and limited editing capabilities in the REPL</li>
  <li>Interactive <code>help()</code> in the REPL doesn’t work</li>
  <li>Inside a virtual environment:
    <ul>
      <li><em>graalpy.cmd</em> and <em>graalpy.exe</em> are broken</li>
      <li><em>pip.exe</em> cannot be used directly</li>
      <li><code>pip</code> has trouble with cache file loading, use <code>--no-cache-dir</code></li>
      <li>Only pure Python binary wheels can be installed, no native extensions or source builds</li>
      <li>To install a package, use <code>myvenv/Scripts/python.exe -m pip --no-cache-dir install &lt;pkg&gt;</code></li>
    </ul>
  </li>
  <li>Running from PowerShell works better than running from CMD, various scripts will fail on the latter</li>
</ul>

<h3 id="installing-packages"><a href="#installing-packages" class="anchor-link">Installing Packages</a></h3>

<p>The best way of using GraalPy is from a <a href="https://docs.python.org/3/library/venv.html">venv</a> virtual environment.
This generates wrapper scripts and makes the implementation usable from a shell as the standard Python interpreter.</p>

<ol>
  <li>Create a virtual environment with GraalPy by running the following command:
    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code> graalpy <span class="nt">-m</span> venv &lt;venv-dir&gt;
</code></pre></div>    </div>
    <p>For example:</p>
    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code> graalpy <span class="nt">-m</span> venv ~/.virtualenvs/graalpy-24.1.0
</code></pre></div>    </div>
  </li>
  <li>Activate the environment in your shell session:
    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="nb">source</span> &lt;venv-dir&gt;/bin/activate
</code></pre></div>    </div>
    <p>For example:</p>
    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="nb">source</span> ~/.virtualenvs/graalpy-24.1.0/bin/activate
</code></pre></div>    </div>
  </li>
</ol>

<p>Multiple executables are available in the virtual environment, including: <code>python</code>, <code>python3</code>, and <code>graalpy</code>.</p>

<blockquote>
  <p>Note: To deactivate the Python environment (and return to your shell), run <code>deactivate</code>.</p>
</blockquote>

<p>The <code>pip</code> package installer is available when using a virtual environment.
The GraalPy implementation of <code>pip</code> may choose package versions other than the latest in cases where it ships patches to make these work better.</p>

<h2 id="python-performance"><a href="#python-performance" class="anchor-link">Python Performance</a></h2>

<h3 id="execution-performance"><a href="#execution-performance" class="anchor-link">Execution Performance</a></h3>

<p>GraalPy uses the state-of-the-art just-in-time (JIT) compiler of GraalVM.
When JIT compiled, GraalPy runs Python code ~4x faster than CPython on the official <a href="https://pyperformance.readthedocs.io/">Python Performance Benchmark Suite</a>.
<img src="/python/assets/performance.svg" alt="" /></p>

<p>These benchmarks can be run by installing the <code>pyperformance</code> package and calling <code>pyperformance run</code> on each of CPython and GraalPy.
To get the Jython numbers we adapted the harness and benchmarks because of missing Python 3 support in Jython.
The speedup was then calculated by taking the pair-wise intersection of working benchmarks and calculating the geomean.</p>

<p>Without a JIT compiler, GraalPy currently executes pure Python code around ~4x slower than CPython.
This means that very short running scripts or scripts running without the Graal compiler on Oracle JDK or OpenJDK are expected to be slower.</p>

<p>Many Python packages from the machine learning or data science ecosystems contain C extension code.
This code benefits little from GraalPy’s JIT compilation and suffers from having to emulate CPython implementation details on GraalPy.
When many C extensions are involved, performance can vary a lot depending on the specific interactions of native and Python code.</p>

<h3 id="code-loading-performance-and-footprint"><a href="#code-loading-performance-and-footprint" class="anchor-link">Code Loading Performance and Footprint</a></h3>

<p>It takes time to parse Python code so when using GraalPy to embed another language in Python, observe the general advice for embedding Graal languages related to <a href="https://www.graalvm.org/latest/reference-manual/embed-languages/#code-caching-across-multiple-contexts">code caching</a>.
Furthermore, some Python libraries require loading a large amount of code on startup before they can do any work.
Due to the design of the Python language, incremental parsing is not possible and for some scripts, the parser may represent a significant fraction of runtime and memory.
To mitigate this, GraalPy can cache the bytecode generated during parsing in <em>.pyc</em> files, if appropriate file system access is configured.</p>

<h4 id="creating-and-managing-pyc-files"><a href="#creating-and-managing-pyc-files" class="anchor-link">Creating and Managing </a><em>.pyc</em> Files</h4>

<p>GraalPy automatically creates a <em>.pyc</em> file when there is an invalid or absent <em>.pyc</em> file that matches a corresponding <em>.py</em> file.</p>

<p>When GraalPy imports a Python source file (module) during an execution for the first time, it automatically creates a corresponding <em>.pyc</em> file.
If GraalPy imports the same module again, then it uses the existing <em>.pyc</em> file.
That means that there are no <em>.pyc</em> files for source files that were not yet executed (imported).
GraalPy creates <em>.pyc</em> files entirely through the <a href="https://www.graalvm.org/sdk/javadoc/org/graalvm/polyglot/io/FileSystem.html">FileSystem API</a>, so that a Java application with embedded Python code can manage file system access.</p>

<blockquote>
  <p>Note: GraalPy never deletes a <em>.pyc</em> file.</p>
</blockquote>

<p>Every time GraalPy subsequently executes a script, it reuses the existing <em>.pyc</em> file, or creates a new one.
GraalPy recreates a <em>.pyc</em> file if the timestamp or hashcode of the original source file is changed.
GraalPy generates the hashcode based only on the Python source file by calling <code>source.hashCode()</code>, which is the JDK hash code over the array of source file bytes, calculated with <code>java.util.Arrays.hashCode(byte[])</code>.</p>

<p>GraalPy also recreates <em>.pyc</em> files if a magic number in the Python parser is changed.
The magic number is hard-coded in the source of Python and can not be changed by the user (unless of course that user has access to the bytecode of Python).</p>

<p>The developers of GraalPy change the magic number when the bytecode format changes.
This is an implementation detail, so the magic number does not have to correspond to the version of GraalPy (as in CPython).
The magic number of <code>pyc</code> is a function of the actual Python runtime Java code that is running.
Changes to the magic number are communicated in the release notes so that developers or system administrators can delete old <em>.pyc</em> files when upgrading.</p>

<p>Note that if you use <em>.pyc</em> files, you must allow write-access to GraalPy at least when switching versions or modifying the original source code file.
Otherwise, the regeneration of source code files will fail and every import will have the overhead of accessing each old <em>.pyc</em> file, parsing the code, serializing it, and trying (and failing) to write out a new <em>.pyc</em> file.</p>

<p>GraalPy creates the following directory structure for <em>.pyc</em> files:</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>top_directory/
  __pycache__/
    sourceA.graalpy.pyc
    sourceB.graalpy.pyc
  sourceA.py
  sourceB.py
  sub_directory/
    __pycache__/
      sourceX.graalpy.pyc
    sourceX.py
</code></pre></div></div>

<p>By default, GraalPy creates the <em>__pycache__</em> directory on the same directory level as a source code file and in this directory all <em>.pyc</em> files from the same directory are stored.
This directory may store <em>.pyc</em> files created with different versions of Python (including, for example, CPython), so the user may see files ending in <em>.cpython3-6.pyc</em>, for example.</p>

<p><em>.pyc</em> files are largely managed automatically by GraalPy in a manner compatible with CPython.
GraalPy provides options similar to CPython to specify the location of t_.pyc_ files, and if they should be written at all, and both of these options can be changed by guest code.</p>

<p>The creation of <em>.pyc</em> files can be controlled in the <a href="https://docs.python.org/3/using/cmdline.html">same way as CPython</a>:</p>

<ul>
  <li>The GraalPy launcher (<code>graalpy</code>) reads the <code>PYTHONDONTWRITEBYTECODE</code>
environment variable. If this is set to a non-empty string, Python will not
try to create a <em>.pyc</em> file when importing a module.</li>
  <li>The launcher command line option <code>-B</code>, if given, has the same effect as the
above.</li>
  <li>Guest language code can change the attribute <code>dont_write_bytecode</code> of the
<code>sys</code> built-in module at runtime to change the behavior for subsequent
imports.</li>
  <li>The GraalPy launcher reads the <code>PYTHONPYCACHEPREFIX</code> environment variable. If set,
it creates the <em>__pycache__</em> directory at the path specified by the
prefix, and creates a mirror of the directory structure of the source tree 
on-demand to store the <em>.pyc</em> files.</li>
  <li>A guest language code can change the attribute <code>pycache_prefix</code> of the <code>sys</code>
module at runtime to change the location for subsequent imports.</li>
</ul>

<p>Because the developer cannot use environment variables or CPython options to communicate these options to GraalPy, these options are made available as language options:</p>

<ul>
  <li><code>python.DontWriteBytecodeFlag</code> - equivalent to <code>-B</code> or <code>PYTHONDONTWRITEBYTECODE</code></li>
  <li><code>python.PyCachePrefix</code> - equivalent to <code>PYTHONPYCACHEPREFIX</code></li>
</ul>

<p>Note that a Python context will not enable writing <em>.pyc</em> files by default.
The GraalPy launcher enables it by default, but if this is desired in the embedding use case, care should be taken to ensure that the <em>__pycache__</em> location is properly managed and the files in that location are secured against manipulation in the same way as the source code files (<em>.py</em>) from which they were derived.</p>

<p>Note also that to upgrade the application sources to Oracle GraalPy, old <em>.pyc</em> files must be removed by the developer as required.</p>

<h4 id="security-considerations"><a href="#security-considerations" class="anchor-link">Security Considerations</a></h4>

<p>GraalPy performs all file operations (obtaining the data, timestamps, and writing <em>.pyc</em> files) via the <a href="https://www.graalvm.org/sdk/javadoc/org/graalvm/polyglot/io/FileSystem.html">FileSystem API</a>.
Developers can modify all of these operations by means of custom (for example, read-only) <code>FileSystem</code> implementations.
The developer can also effectively disable the creation of <em>.pyc</em> files by disabling I/O permissions for GraalPy.</p>

<p>If <em>.pyc</em> files are not readable, their location is not writable.
If the <em>.pyc</em> files’ serialization data or magic numbers are corrupted in any way, the deserialization fails and GraalPy parses the <em>.py</em> source code file again.
This comes with a minor performance hit <em>only</em> for the parsing of modules, which should not be significant for most applications (provided the application performs actual work in addition to loading Python code).</p>

<h2 id="modern-python-for-the-jvm"><a href="#modern-python-for-the-jvm" class="anchor-link">Modern Python for the JVM</a></h2>

<p>For Python version 2 (now EOL), Jython is the <em>de facto</em> means of interfacing Python and Java.
Most existing Jython code that uses Java integration will be based on a stable Jython release—however, these are only available in Python 2.x versions.
GraalPy, in contrast, is compatible with Python 3.x and does not provide full compatibility with earlier 2.x versions of Jython.</p>

<p>To migrate code from Python 2 to Python 3, follow <a href="https://docs.python.org/3/howto/pyporting.html">the official guide from the Python community</a>.
Once your Jython code is compatible with Python 3, follow this guide to iron out other differences between GraalPy and Jython.</p>

<p>GraalPy’s first-class support for <a href="#interoperability">Java interoperability</a> makes using Java libraries from Python as easy as possible, with special affordances for Java code beyond the generic interoperability support for other Graal languages (languages implemented on the <a href="https://www.graalvm.org/latest/graalvm-as-a-platform/language-implementation-framework/">Truffle framework</a>).</p>

<p>Not all features of Jython are supported on GraalPy.
Some are supported, but disabled by default due to their negative impact on runtime performance.
During migration, you can enable these features using a command line option: <code>--python.EmulateJython</code>.
We recommend to move away from these features, however, to achieve optimal performance.</p>

<h3 id="migrating-jython-scripts"><a href="#migrating-jython-scripts" class="anchor-link">Migrating Jython Scripts</a></h3>

<blockquote>
  <p>To move plain Jython scripts from Jython to GraalPy, use a GraalPy JVM-based runtime.
(For more information, see available <a href="#testing-python-applications-and-packages-on-graalpy">GraalPy Distributions</a>).</p>
</blockquote>

<h4 id="importing-a-java-package"><a href="#importing-a-java-package" class="anchor-link">Importing a Java Package</a></h4>

<p>There are certain features of Jython’s Java integration that are enabled by default on GraalPy.
Here is an example:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="n">java.awt</span> <span class="k">as</span> <span class="n">awt</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">win</span> <span class="o">=</span> <span class="n">awt</span><span class="p">.</span><span class="nc">Frame</span><span class="p">()</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">win</span><span class="p">.</span><span class="nf">setSize</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">win</span><span class="p">.</span><span class="nf">setTitle</span><span class="p">(</span><span class="sh">"</span><span class="s">Hello from Python!</span><span class="sh">"</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">win</span><span class="p">.</span><span class="nf">getSize</span><span class="p">().</span><span class="nf">toString</span><span class="p">()</span>
<span class="sh">'</span><span class="s">java.awt.Dimension[width=200,height=200]</span><span class="sh">'</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">win</span><span class="p">.</span><span class="nf">show</span><span class="p">()</span>
</code></pre></div></div>

<p>This example produces the same result when run on both Jython and GraalPy.
However, when the example is run on GraalPy, only packages that are in the <code>java</code> namespace can be imported directly.
To import classes from packages outside the <code>java</code> namespace, use the <code>--python.EmulateJython</code> option.</p>

<blockquote>
  <p>Note: When embedding GraalPy in a modularized application, you may have to
add exports for the required modules according to JSR 376.</p>
</blockquote>

<p>Additionally, it is not possible to import Java packages as Python modules in all circumstances.
For example, this will work:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="n">java.lang</span> <span class="k">as</span> <span class="n">lang</span>
</code></pre></div></div>

<p>But, this will not work:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="n">javax.swing</span> <span class="k">as</span> <span class="n">swing</span>
<span class="kn">from</span> <span class="n">javax.swing</span> <span class="kn">import</span> <span class="o">*</span>
</code></pre></div></div>

<p>Instead, import one of the classes directly:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="n">javax.swing.Window</span> <span class="k">as</span> <span class="n">Window</span>
</code></pre></div></div>

<h4 id="basic-object-usage"><a href="#basic-object-usage" class="anchor-link">Basic Object Usage</a></h4>

<p>Constructing and working with Java objects and classes is achieved with conventional
Python syntax.
The methods of a Java object can also be retrieved and referenced as first class objects (bound to their instance), in the same way as Python methods. For example:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="n">java.util</span> <span class="kn">import</span> <span class="n">Random</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">rg</span> <span class="o">=</span> <span class="nc">Random</span><span class="p">(</span><span class="mi">99</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">rg</span><span class="p">.</span><span class="nf">nextInt</span><span class="p">()</span>
<span class="mi">1491444859</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">boundNextInt</span> <span class="o">=</span> <span class="n">rg</span><span class="p">.</span><span class="n">nextInt</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nf">boundNextInt</span><span class="p">()</span>
<span class="mi">1672896916</span>
</code></pre></div></div>

<h4 id="java-to-python-types-automatic-conversion"><a href="#java-to-python-types-automatic-conversion" class="anchor-link">Java-to-Python Types: Automatic Conversion</a></h4>

<p>Method overloads are resolved by matching the Python arguments in a best-effort manner to the available parameter types.
This approach is also taken when converting data.
The goal here is to make using Java from Python as smooth as possible.
The matching approach taken by GraalPy is similar to Jython, but GraalPy uses a more dynamic approach to matching—Python types emulating <code>int</code> or <code>float</code> are also converted to the appropriate Java types.
This enables you, for example, to use a Pandas frame as <code>double[][]</code> or NumPy array elements as <code>int[]</code> when the elements fit into those Java primitive types.</p>

<table>
  <thead>
    <tr>
      <th style="text-align: left">Java type</th>
      <th style="text-align: left">Python type</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left"><code>null</code></td>
      <td style="text-align: left"><code>None</code></td>
    </tr>
    <tr>
      <td style="text-align: left"><code>boolean</code></td>
      <td style="text-align: left"><code>bool</code></td>
    </tr>
    <tr>
      <td style="text-align: left"><code>byte</code>, <code>short</code>, <code>int</code>, <code>long</code></td>
      <td style="text-align: left"><code>int</code>, any object that has an <code>__int__</code> method</td>
    </tr>
    <tr>
      <td style="text-align: left"><code>float</code></td>
      <td style="text-align: left"><code>float</code>, any object that has a <code>__float__</code> method</td>
    </tr>
    <tr>
      <td style="text-align: left"><code>char</code></td>
      <td style="text-align: left"><code>str</code> of length 1</td>
    </tr>
    <tr>
      <td style="text-align: left"><code>java.lang.String</code></td>
      <td style="text-align: left"><code>str</code></td>
    </tr>
    <tr>
      <td style="text-align: left"><code>byte[]</code></td>
      <td style="text-align: left"><code>bytes</code>, <code>bytearray</code>, wrapped Java <code>array</code>, Python list with only the appropriate types</td>
    </tr>
    <tr>
      <td style="text-align: left">Java arrays</td>
      <td style="text-align: left">Wrapped Java <code>array</code> or Python <code>list</code> with only the appropriate types</td>
    </tr>
    <tr>
      <td style="text-align: left">Java objects</td>
      <td style="text-align: left">Wrapped Java object of the appropriate type</td>
    </tr>
    <tr>
      <td style="text-align: left"><code>java.lang.Object</code></td>
      <td style="text-align: left">Any object</td>
    </tr>
  </tbody>
</table>

<h4 id="special-jython-module-jarray"><a href="#special-jython-module-jarray" class="anchor-link">Special Jython Module: </a><code>jarray</code></h4>

<p>GraalPy implements the <code>jarray</code> module (to create primitive Java arrays) for compatibility.
This module is always available, since we have not found its presence to have a negative impact.
For example:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="n">jarray</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">jarray</span><span class="p">.</span><span class="nf">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="sh">'</span><span class="s">i</span><span class="sh">'</span><span class="p">)</span>
</code></pre></div></div>

<p>Note that its usage is equivalent to constructing the array type using the <code>java.type</code> function and then populating the array, as follows:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="n">java</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">java</span><span class="p">.</span><span class="nf">type</span><span class="p">(</span><span class="sh">"</span><span class="s">int[]</span><span class="sh">"</span><span class="p">)(</span><span class="mi">10</span><span class="p">)</span>
</code></pre></div></div>

<p>The code that creates a Java array can also use Python types.
However, implicitly, this may produce a copy of the array data, which can be deceptive when using a Java array as an output parameter:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;&gt;&gt;</span> <span class="n">i</span> <span class="o">=</span> <span class="n">java</span><span class="p">.</span><span class="n">io</span><span class="p">.</span><span class="nc">ByteArrayInputStream</span><span class="p">(</span><span class="sa">b</span><span class="sh">"</span><span class="s">foobar</span><span class="sh">"</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">buf</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">i</span><span class="p">.</span><span class="nf">read</span><span class="p">(</span><span class="n">buf</span><span class="p">)</span> <span class="c1"># buf is automatically converted to a byte[] array
</span><span class="mi">3</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">buf</span>
<span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="c1"># the converted byte[] array is lost
</span><span class="o">&gt;&gt;&gt;</span> <span class="n">jbuf</span> <span class="o">=</span> <span class="n">java</span><span class="p">.</span><span class="nf">type</span><span class="p">(</span><span class="sh">"</span><span class="s">byte[]</span><span class="sh">"</span><span class="p">)(</span><span class="mi">3</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">i</span><span class="p">.</span><span class="nf">read</span><span class="p">(</span><span class="n">jbuf</span><span class="p">)</span>
<span class="mi">3</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">jbuf</span>
<span class="p">[</span><span class="mi">98</span><span class="p">,</span> <span class="mi">97</span><span class="p">,</span> <span class="mi">122</span><span class="p">]</span>
</code></pre></div></div>

<h4 id="exceptions-from-java"><a href="#exceptions-from-java" class="anchor-link">Exceptions from Java</a></h4>

<p>You can catch Java exceptions as you would expect.
For example:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="n">java</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">v</span> <span class="o">=</span> <span class="n">java</span><span class="p">.</span><span class="n">util</span><span class="p">.</span><span class="nc">Vector</span><span class="p">()</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">try</span><span class="p">:</span>
<span class="p">...</span>    <span class="n">x</span> <span class="o">=</span> <span class="n">v</span><span class="p">.</span><span class="nf">elementAt</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<span class="p">...</span> <span class="k">except</span> <span class="n">java</span><span class="p">.</span><span class="n">lang</span><span class="p">.</span><span class="n">ArrayIndexOutOfBoundsException</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
<span class="p">...</span>    <span class="nf">print</span><span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="nf">getMessage</span><span class="p">())</span>
<span class="bp">...</span>
<span class="mi">7</span> <span class="o">&gt;=</span> <span class="mi">0</span>
</code></pre></div></div>

<h4 id="java-collections"><a href="#java-collections" class="anchor-link">Java Collections</a></h4>

<ul>
  <li>
    <p>Java arrays and collections that implement the <code>java.util.Collection</code> interface can be accessed using the <code>[]</code> syntax.
An empty collection is considered <code>false</code> in boolean conversions.
The length of a collection is exposed by the <code>len</code> built-in function.
For example:</p>

    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="n">java.util</span> <span class="kn">import</span> <span class="n">ArrayList</span>
  <span class="o">&gt;&gt;&gt;</span> <span class="n">l</span> <span class="o">=</span> <span class="nc">ArrayList</span><span class="p">()</span>
  <span class="o">&gt;&gt;&gt;</span> <span class="n">l</span><span class="p">.</span><span class="nf">add</span><span class="p">(</span><span class="sh">"</span><span class="s">foo</span><span class="sh">"</span><span class="p">)</span>
  <span class="bp">True</span>
  <span class="o">&gt;&gt;&gt;</span> <span class="n">l</span><span class="p">.</span><span class="nf">add</span><span class="p">(</span><span class="sh">"</span><span class="s">baz</span><span class="sh">"</span><span class="p">)</span>
  <span class="bp">True</span>
  <span class="o">&gt;&gt;&gt;</span> <span class="n">l</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
  <span class="sh">'</span><span class="s">foo</span><span class="sh">'</span>
  <span class="o">&gt;&gt;&gt;</span> <span class="n">l</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="sh">"</span><span class="s">bar</span><span class="sh">"</span>
  <span class="o">&gt;&gt;&gt;</span> <span class="k">del</span> <span class="n">l</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
  <span class="o">&gt;&gt;&gt;</span> <span class="nf">len</span><span class="p">(</span><span class="n">l</span><span class="p">)</span>
  <span class="mi">1</span>
  <span class="o">&gt;&gt;&gt;</span> <span class="nf">bool</span><span class="p">(</span><span class="n">l</span><span class="p">)</span>
  <span class="bp">True</span>
  <span class="o">&gt;&gt;&gt;</span> <span class="k">del</span> <span class="n">l</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
  <span class="o">&gt;&gt;&gt;</span> <span class="nf">bool</span><span class="p">(</span><span class="n">l</span><span class="p">)</span>
  <span class="bp">False</span>
</code></pre></div>    </div>
  </li>
  <li>
    <p>Java iterables that implement the <code>java.lang.Iterable</code> interface can be iterated over using a <code>for</code> loop or the <code>iter</code> built-in function and are accepted by all built-ins that expect an iterable.
For example:</p>

    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="o">&gt;&gt;&gt;</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">l</span><span class="p">]</span>
  <span class="p">[</span><span class="sh">'</span><span class="s">foo</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">bar</span><span class="sh">'</span><span class="p">]</span>
  <span class="o">&gt;&gt;&gt;</span> <span class="n">i</span> <span class="o">=</span> <span class="nf">iter</span><span class="p">(</span><span class="n">l</span><span class="p">)</span>
  <span class="o">&gt;&gt;&gt;</span> <span class="nf">next</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
  <span class="sh">'</span><span class="s">foo</span><span class="sh">'</span>
  <span class="o">&gt;&gt;&gt;</span> <span class="nf">next</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
  <span class="sh">'</span><span class="s">bar</span><span class="sh">'</span>
  <span class="o">&gt;&gt;&gt;</span> <span class="nf">next</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
  <span class="nc">Traceback </span><span class="p">(</span><span class="n">most</span> <span class="n">recent</span> <span class="n">call</span> <span class="n">last</span><span class="p">):</span>
  <span class="n">File</span> <span class="sh">"</span><span class="s">&lt;stdin&gt;</span><span class="sh">"</span><span class="p">,</span> <span class="n">line</span> <span class="mi">1</span><span class="p">,</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
  <span class="nb">StopIteration</span>
  <span class="o">&gt;&gt;&gt;</span> <span class="nf">set</span><span class="p">(</span><span class="n">l</span><span class="p">)</span>
  <span class="p">{</span><span class="sh">'</span><span class="s">foo</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">bar</span><span class="sh">'</span><span class="p">}</span>
</code></pre></div>    </div>
  </li>
  <li>
    <p>An iterator can be iterated as well. For example:</p>

    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="n">java.util</span> <span class="kn">import</span> <span class="n">ArrayList</span>
  <span class="o">&gt;&gt;&gt;</span> <span class="n">l</span> <span class="o">=</span> <span class="nc">ArrayList</span><span class="p">()</span>
  <span class="o">&gt;&gt;&gt;</span> <span class="n">l</span><span class="p">.</span><span class="nf">add</span><span class="p">(</span><span class="sh">"</span><span class="s">foo</span><span class="sh">"</span><span class="p">)</span>
  <span class="bp">True</span>
  <span class="o">&gt;&gt;&gt;</span> <span class="n">i</span> <span class="o">=</span> <span class="n">l</span><span class="p">.</span><span class="nf">iterator</span><span class="p">()</span>  <span class="c1"># Calls the Java iterator methods
</span>  <span class="o">&gt;&gt;&gt;</span> <span class="nf">next</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
  <span class="sh">'</span><span class="s">foo</span><span class="sh">'</span>
</code></pre></div>    </div>
  </li>
  <li>
    <p>Mapped collections that implement the <code>java.util.Map</code> interface can be accessed using the <code>[]</code> notation.
An empty map is considered <code>false</code> in boolean conversions. Iteration of a map yields its keys, consistent with <code>dict</code>.
For example:</p>

    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="n">java.util</span> <span class="kn">import</span> <span class="n">HashMap</span>
  <span class="o">&gt;&gt;&gt;</span> <span class="n">m</span> <span class="o">=</span> <span class="nc">HashMap</span><span class="p">()</span>
  <span class="o">&gt;&gt;&gt;</span> <span class="n">m</span><span class="p">[</span><span class="sh">'</span><span class="s">foo</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">5</span>
  <span class="o">&gt;&gt;&gt;</span> <span class="n">m</span><span class="p">[</span><span class="sh">'</span><span class="s">foo</span><span class="sh">'</span><span class="p">]</span>
  <span class="mi">5</span>
  <span class="o">&gt;&gt;&gt;</span> <span class="n">m</span><span class="p">[</span><span class="sh">'</span><span class="s">bar</span><span class="sh">'</span><span class="p">]</span>
  <span class="nc">Traceback </span><span class="p">(</span><span class="n">most</span> <span class="n">recent</span> <span class="n">call</span> <span class="n">last</span><span class="p">):</span>
  <span class="n">File</span> <span class="sh">"</span><span class="s">&lt;stdin&gt;</span><span class="sh">"</span><span class="p">,</span> <span class="n">line</span> <span class="mi">1</span><span class="p">,</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
  <span class="nb">KeyError</span><span class="p">:</span> <span class="n">bar</span>
  <span class="o">&gt;&gt;&gt;</span> <span class="p">[</span><span class="n">k</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">m</span><span class="p">]</span>
  <span class="p">[</span><span class="sh">'</span><span class="s">foo</span><span class="sh">'</span><span class="p">]</span>
  <span class="o">&gt;&gt;&gt;</span> <span class="nf">bool</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
  <span class="bp">True</span>
  <span class="o">&gt;&gt;&gt;</span> <span class="k">del</span> <span class="n">m</span><span class="p">[</span><span class="sh">'</span><span class="s">foo</span><span class="sh">'</span><span class="p">]</span>
  <span class="o">&gt;&gt;&gt;</span> <span class="nf">bool</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
  <span class="bp">False</span>
</code></pre></div>    </div>
  </li>
</ul>

<h4 id="inheritance-from-java"><a href="#inheritance-from-java" class="anchor-link">Inheritance from Java</a></h4>

<p>Inheriting from a Java class (or implementing a Java interface) is supported with some syntactical and significant behavioral differences from Jython.
To create a class that inherits from a Java class (or implements a Java interface), use the conventional Python <code>class</code> statement.
Declared methods override (implement) superclass (interface) methods when their names match.</p>

<p>It is important to understand that there is actually delegation happening here - when inheriting from Java, two classes are created, one in Java and one in Python.
These reference each other and any methods that are declared in Python that override or implement a Java method on the superclass are declared on the Java side as delegating to Python.
The created object does not behave like a Python object but instead in the same way as a foreign Java object.
The reason for this is that when you create an instance of your new class, you get a reference to the <em>Java</em> object.</p>

<p>To call Python methods that do <em>not</em> override or implement methods that already existed on the superclass, you need to use the special <code>this</code> attribute.
Once you are in a Python method, your <code>self</code> refers to the Python object, and to get back from a Python method to Java, use the special attribute <code>__super__</code>.
And since we do not expose static members on the instance side, if you need to call a static method from an instance on the Java side, use <code>getClass().static</code> to get to the meta-object holding the static members.</p>

<p>One important consequence of the two-object-schema here is that the <code>__init__</code> method on the Python object is actually called <em>before</em> the connection to the Java side is established.
So you cannot currently override construction of the Java object or run code during initialization that would affect the Java half of the combined structure.
You will have to create a factory method if you want to achieve this.</p>

<p>For example:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="n">atexit</span>
<span class="kn">from</span> <span class="n">java.util.logging</span> <span class="kn">import</span> <span class="n">Logger</span><span class="p">,</span> <span class="n">Handler</span>


<span class="k">class</span> <span class="nc">MyHandler</span><span class="p">(</span><span class="n">Handler</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="n">self</span><span class="p">.</span><span class="n">logged</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">def</span> <span class="nf">publish</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">record</span><span class="p">):</span>
        <span class="n">self</span><span class="p">.</span><span class="n">logged</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">record</span><span class="p">)</span>


<span class="n">logger</span> <span class="o">=</span> <span class="n">Logger</span><span class="p">.</span><span class="nf">getLogger</span><span class="p">(</span><span class="sh">"</span><span class="s">mylog</span><span class="sh">"</span><span class="p">)</span>
<span class="n">logger</span><span class="p">.</span><span class="nf">setUseParentHandlers</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
<span class="n">handler</span> <span class="o">=</span> <span class="nc">MyHandler</span><span class="p">()</span>
<span class="n">logger</span><span class="p">.</span><span class="nf">addHandler</span><span class="p">(</span><span class="n">handler</span><span class="p">)</span>
<span class="c1"># Make sure the handler is not used after the Python context has been closed
</span><span class="n">atexit</span><span class="p">.</span><span class="nf">register</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="n">logger</span><span class="p">.</span><span class="nf">removeHandler</span><span class="p">(</span><span class="n">handler</span><span class="p">))</span>

<span class="n">logger</span><span class="p">.</span><span class="nf">info</span><span class="p">(</span><span class="sh">"</span><span class="s">Hi</span><span class="sh">"</span><span class="p">)</span>
<span class="n">logger</span><span class="p">.</span><span class="nf">warning</span><span class="p">(</span><span class="sh">"</span><span class="s">Bye</span><span class="sh">"</span><span class="p">)</span>

<span class="c1"># The python attributes/methods of the object are accessed through 'this' attribute
</span><span class="k">for</span> <span class="n">record</span> <span class="ow">in</span> <span class="n">handler</span><span class="p">.</span><span class="n">this</span><span class="p">.</span><span class="n">logged</span><span class="p">:</span>
    <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">'</span><span class="s">Python captured message </span><span class="sh">"</span><span class="si">{</span><span class="n">record</span><span class="p">.</span><span class="nf">getMessage</span><span class="p">()</span><span class="si">}</span><span class="sh">"</span><span class="s"> at level </span><span class="si">{</span><span class="n">record</span><span class="p">.</span><span class="nf">getLevel</span><span class="p">().</span><span class="nf">getName</span><span class="p">()</span><span class="si">}</span><span class="sh">'</span><span class="p">)</span>
</code></pre></div></div>

<p>For more information about how the generated Java subclass behaves, see the <a href="https://www.graalvm.org/truffle/javadoc/com/oracle/truffle/api/TruffleLanguage.Env.html#createHostAdapter(java.lang.Object%5B%5D)">Truffle documentation</a>.</p>

<h3 id="embedding-python-into-java"><a href="#embedding-python-into-java" class="anchor-link">Embedding Python into Java</a></h3>

<p>The other way to use Jython was to embed it into a Java application. There were two options for such an embedding.</p>

<ol>
  <li>
    <p>Use the <code>PythonInterpreter</code> object that Jython provides.
Existing code using Jython in this manner depends directly on the Jython package (for example, in the Maven configuration), because the Java code has references to Jython internal classes.
These classes do not exist in GraalVM, and no equivalent classes are exposed.
To migrate from this usage, switch to the <a href="https://central.sonatype.com/artifact/org.graalvm.sdk/graal-sdk">GraalVM SDK</a>.
Using this SDK, no APIs particular to Python are exposed, everything is achieved via the GraalVM API, with maximum configurability of the Python runtime.
Refer to the <a href="#getting-started-with-graalpy-on-the-jvm">Getting Started</a> documentation for preparing a setup.</p>
  </li>
  <li>
    <p>Embed Jython in Java via <a href="https://www.jcp.org/en/jsr/detail?id=223">JSR 223</a> by using the classes of the the <code>javax.script</code> package, and, in particular, via the <code>ScriptEngine</code> class.
We do not recommend this approach, because the <code>ScriptEngine</code> APIs are not a clean fit for the options and capabilities of GraalPy.
However, to migrate existing code, we provide an example ScriptEngine implementation that you can inline into your project.
Refer to <a href="https://www.graalvm.org/latest/reference-manual/embed-languages/#compatibility-with-jsr-223-scriptengine">the reference manual for embedding</a> for details.</p>
  </li>
</ol>

<h2 id="native-executables-with-python"><a href="#native-executables-with-python" class="anchor-link">Native Executables with Python</a></h2>

<p>GraalPy supports GraalVM Native Image to generate native binaries of Java applications that use GraalPy.</p>

<h3 id="quickstart"><a href="#quickstart" class="anchor-link">Quickstart</a></h3>

<p>If you started with the <a href="#getting-started-with-graalpy-on-the-jvm">Maven archetype</a>, the generated <em>pom.xml</em> makes it easy to generate a native executable using the <a href="https://graalvm.github.io/native-build-tools/latest/maven-plugin.html">Maven plugin for Native Image building</a>.</p>

<p>To build the application, run:</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>mvn <span class="nt">-Pnative</span> package
</code></pre></div></div>
<p>The command packages the project and creates a native executable.</p>

<p>Take a look at the generated files <em>pom.xml</em> and <em>Main.java</em>.
They are documented to explain how Python resources are included in the resulting binary.
The generated project should be viewed as a starting point.
It includes the entire Python standard library, so the Python code can invoke all of the standard library code.
The resources can be manually pruned to reduce the included Python libraries to the necessary amount, reducing both the size of the package and the time to start up.
This Java example demonstrates some useful default options for the Python context, but other settings may be desirable to further control what the Python code is allowed to do.</p>

<h3 id="reducing-binary-size"><a href="#reducing-binary-size" class="anchor-link">Reducing Binary Size</a></h3>

<p>Python is a large language.
“Batteries included” has long been a core tenet of CPython.
As a compatible replacement, GraalPy includes most of those “batteries” as well.
This can result in significant increases in binary size when including GraalPy in a Java application.</p>

<p>Only you as the developer know your specific embedding scenario.
The defaults may include much more than needed for any specific application.
An embedded Python-in-Java application usually has more limited use cases for the Python interpreter than the full GraalPy distribution, and often you can know ahead of time whether certain features are needed.
Some features (for example, cryptographic algorithms or socket access) may even be undesirable to include in some cases.
Thus, when embedding GraalPy in a Java application, the binary size can be reduced and security improved by excluding components of the Python language.</p>

<h4 id="excluding-python-components"><a href="#excluding-python-components" class="anchor-link">Excluding Python Components</a></h4>

<p>GraalPy defines a few system properties that can be passed on the <code>native-image</code> command line to exclude aspects of the language.
The options can, when taken together, reduce the size of the executable by around 20%.
These are:</p>

<ul>
  <li><code>python.WithoutSSL=true</code> - This option removes the <code>ssl</code> module.
If no secure network access or certificate checking is required, this removes Java’s SSL classes and the BouncyCastle library.</li>
  <li><code>python.WithoutDigest=true</code> - This option removes the <code>_md5</code>, <code>_sha1</code>, <code>_sha256</code>, <code>_sha512</code>, <code>_sha3</code>, and <code>_hashlib</code> modules.
This removes the direct usages of <code>java.security.MessageDigest</code> and <code>javax.crypto.Mac</code> from GraalPy.</li>
  <li><code>python.WithoutPlatformAccess=true</code> - This removes the <code>signal</code> and <code>subprocess</code> modules, removes accesses to process properties such as the Unix UID and GID, or setting the Java default time zone.
This has no significant impact on binary size, but if these are unwanted capabilities that are dynamically disabled with context options anyway, they can also be removed ahead of time.</li>
  <li><code>python.WithoutCompressionLibraries=true</code> - This removes the <code>zlib</code>, <code>lzma</code>, <code>bzip2</code>, and <code>zipimporter</code> modules and related classes.
These modules have both native and pure Java implementations (the former for performance, the latter for better sandboxing); however, if they are not needed, they can be removed entirely.</li>
  <li><code>python.WithoutNativePosix=true</code> - The default <code>os</code> module backend is a pure Java implementation when GraalPy is embedded rather than run via its launcher.
The native POSIX backend of GraalPy is recommended only for 100% compatibility with CPython’s POSIX interfaces, and if not used, can be removed from the build with this option.</li>
  <li><code>python.WithoutJavaInet=true</code> - The Java implementation of Python’s <code>socket</code> module is based on Java’s networking classes.
If network access is denied for an embedding scenario, this option can reduce the binary size further.</li>
  <li><code>python.AutomaticAsyncActions=false</code> - Signal handling, Python weak reference callbacks, and cleaning up native resources is usually achieved automatically by spawning GraalPy daemon threads that submit safepoint actions to the Python main thread.
This uses an <code>ExecutorService</code> with a thread pool.
If you want to disallow such extra threads or avoid pulling in <code>ExecutorService</code> and related classes, then set this property to <code>false</code> and retrieve the <code>PollPythonAsyncActions</code> object from the context’s polyglot bindings.
This object is executable and can be used to trigger Python asynchronous actions at the locations you desire.</li>
  <li><code>python.WithoutJNI=true</code> - This option removes any code that uses JNI. As a consequence, you cannot use the HPy JNI backend and maybe other parts that rely on JNI.</li>
</ul>

<h4 id="removing-pre-initialized-python-heap"><a href="#removing-pre-initialized-python-heap" class="anchor-link">Removing Pre-initialized Python Heap</a></h4>

<p>Another useful option to reduce the size of the native executable is to omit a pre-initialized Python context from the executable.
By default, a default Python context is already pre-initialized and ready for immediate execution.
This can lead to slightly improved startup, at the cost of including a few thousand Python objects in the binary.
In embedded applications that use a custom polyglot engine to allow context sharing, the pre-initialized context cannot be used at all, and including those objects is wasted.
The pre-initialized heap can be omitted by passing the following to the <code>native-image</code> command:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">-Dimage-build-time</span>.PreinitializeContexts<span class="o">=</span>
</code></pre></div></div>

<h4 id="disabling-runtime-compilation-of-python-code"><a href="#disabling-runtime-compilation-of-python-code" class="anchor-link">Disabling Runtime Compilation of Python Code</a></h4>

<p>If binary size is significantly more important than execution speed (which may be the case if all Python scripts are expected to be short running, perform a lot of I/O, or scripts are rarely executed more than once), it may make sense to disable JIT compilation entirely.
Be aware that this may significantly impact your Python performance, so be sure to test the runtime behavior of your actual use cases when choosing to use this option.
This can be achieved by passing the following options:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">-Dtruffle</span>.TruffleRuntime<span class="o">=</span>com.oracle.truffle.api.impl.DefaultTruffleRuntime <span class="se">\</span>
<span class="nt">-Dpolyglot</span>.engine.WarnInterpreterOnly<span class="o">=</span><span class="nb">false</span>
</code></pre></div></div>

<h4 id="summary"><a href="#summary" class="anchor-link">Summary</a></h4>

<p>Combining all of these approaches can halve the size of the GraalPy binary.
Every embedded application is different and the code pulled in by the rest of the Java code also matters, so combinations of these options should be tried to determine which effect they have in a specific instance.</p>

<h3 id="shipping-python-packages"><a href="#shipping-python-packages" class="anchor-link">Shipping Python Packages</a></h3>

<p>Our Maven archetype by default is set up to include all needed Python files in the native binary itself, so the image is self-contained.</p>

<p>In custom embeddings, the Python standard library is copied next to the native image.
When moving the native image, the standard library folder needs to be kept next to it.</p>

<h2 id="python-standalone-applications"><a href="#python-standalone-applications" class="anchor-link">Python Standalone Applications</a></h2>

<p>GraalPy enables you to create a Python application or library as a native application or JAR file with no external dependencies.
The <a href="https://github.com/oracle/graal/tree/master/truffle">Truffle framework</a> on which GraalPy is built virtualizes all filesystem accesses, including those to the standard library and installed pure Python packages.
Packages that include native code can still circumvent this, however!</p>

<p>GraalPy includes a module named <code>standalone</code> to create a Python binary for Linux, macOS, and Windows. 
The modules bundles all your application’s resources into a single file.</p>

<blockquote>
  <p>Prerequisite: GraalPy distribution beginning with version 23.1.0. See <a href="https://github.com/oracle/graalpython/releases">GraalPy releases</a>.</p>
</blockquote>

<p>For example, if you want to produce a native executable from a Python file named <em>my_script.py</em> along with packages you have installed in a virtual environment named <em>my_venv</em>, run the following command:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>graalpy <span class="nt">-m</span> standalone native <span class="se">\</span>
      <span class="nt">--module</span> my_script.py <span class="se">\</span>
      <span class="nt">--output</span> my_binary <span class="se">\</span>
      <span class="nt">--venv</span> my_env
</code></pre></div></div>

<p>It produces a native <em>my_binary</em> file which includes your Python code, the GraalPy runtime, and the Python standard library in a single, self-contained executable.
Use <code>graalpy -m standalone native --help</code> for further options.</p>

<h4 id="security-considerations-of-python-standalone-applications"><a href="#security-considerations-of-python-standalone-applications" class="anchor-link">Security Considerations of Python Standalone Applications</a></h4>

<p>Creating a native executable or a JAR file that includes Python code could be seen as a mild form of obfuscation, but it does not protect your source code.
Python source code is not stored verbatim into the executable (only the GraalPy bytecode is stored), but bytecode is easy to convert back into Python source code.</p>

<h2 id="interoperability"><a href="#interoperability" class="anchor-link">Interoperability</a></h2>

<p>Besides being primarily recommended to use in your Java application, GraalPy can interoperate with other Graal languages (languages implemented on the <a href="https://www.graalvm.org/latest/graalvm-as-a-platform/language-implementation-framework/">Truffle framework</a>).
This means that you can use the objects and functions provided by those other languages directly from your Python scripts.</p>

<h3 id="interacting-with-java-from-python-scripts"><a href="#interacting-with-java-from-python-scripts" class="anchor-link">Interacting with Java from Python scripts</a></h3>

<p>Java is the host language of the JVM and runs the GraalPy interpreter itself.
To interoperate with Java from Python scripts, use the <code>java</code> module:</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="n">java</span>
<span class="n">BigInteger</span> <span class="o">=</span> <span class="n">java</span><span class="p">.</span><span class="nf">type</span><span class="p">(</span><span class="sh">"</span><span class="s">java.math.BigInteger</span><span class="sh">"</span><span class="p">)</span>
<span class="n">myBigInt</span> <span class="o">=</span> <span class="n">BigInteger</span><span class="p">.</span><span class="nf">valueOf</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="c1"># a public Java methods can just be called
</span><span class="n">myBigInt</span><span class="p">.</span><span class="nf">shiftLeft</span><span class="p">(</span><span class="mi">128</span><span class="p">)</span> <span class="c1"># returns a &lt;JavaObject[java.math.BigInteger] at ...&gt;
# Java method names that are keywords in Python must be accessed using `getattr`
</span><span class="nf">getattr</span><span class="p">(</span><span class="n">myBigInt</span><span class="p">,</span> <span class="sh">"</span><span class="s">not</span><span class="sh">"</span><span class="p">)()</span> <span class="c1"># returns a &lt;JavaObject[java.math.BigInteger] at ...&gt;
</span><span class="n">byteArray</span> <span class="o">=</span> <span class="n">myBigInt</span><span class="p">.</span><span class="nf">toByteArray</span><span class="p">()</span>
<span class="c1"># Java arrays can act like Python lists
</span><span class="k">assert</span> <span class="nf">len</span><span class="p">(</span><span class="n">byteArray</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">byteArray</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">42</span>
</code></pre></div></div>

<p>To import packages from the <code>java</code> namespace, you can also use the conventional Python import syntax:</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="n">java.util.ArrayList</span>
<span class="kn">from</span> <span class="n">java.util</span> <span class="kn">import</span> <span class="n">ArrayList</span>
<span class="k">assert</span> <span class="n">java</span><span class="p">.</span><span class="n">util</span><span class="p">.</span><span class="n">ArrayList</span> <span class="o">==</span> <span class="n">ArrayList</span>

<span class="n">al</span> <span class="o">=</span> <span class="nc">ArrayList</span><span class="p">()</span>
<span class="n">al</span><span class="p">.</span><span class="nf">add</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">al</span><span class="p">.</span><span class="nf">add</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
<span class="k">assert</span> <span class="nf">list</span><span class="p">(</span><span class="n">al</span><span class="p">)</span> <span class="o">==</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">12</span><span class="p">]</span>
</code></pre></div></div>

<p>In addition to the <code>type</code> built-in method, the <code>java</code> module exposes the following methods:</p>

<table>
  <thead>
    <tr>
      <th>Built-in</th>
      <th>Specification</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>instanceof(obj, class)</code></td>
      <td>returns <code>True</code> if <code>obj</code> is an instance of <code>class</code> (<code>class</code> must be a foreign object class)</td>
    </tr>
    <tr>
      <td><code>is_function(obj)</code></td>
      <td>returns <code>True</code> if <code>obj</code> is a Java host language function wrapped using interop</td>
    </tr>
    <tr>
      <td><code>is_object(obj)</code></td>
      <td>returns <code>True</code> if <code>obj</code> if the argument is Java host language object wrapped using interop</td>
    </tr>
    <tr>
      <td><code>is_symbol(obj)</code></td>
      <td>returns <code>True</code> if <code>obj</code> if the argument is a Java host symbol, representing the constructor and static members of a Java class, as obtained by <code>java.type</code></td>
    </tr>
  </tbody>
</table>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">ArrayList</span> <span class="o">=</span> <span class="n">java</span><span class="p">.</span><span class="nf">type</span><span class="p">(</span><span class="sh">'</span><span class="s">java.util.ArrayList</span><span class="sh">'</span><span class="p">)</span>
<span class="n">my_list</span> <span class="o">=</span> <span class="nc">ArrayList</span><span class="p">()</span>
<span class="k">assert</span> <span class="n">java</span><span class="p">.</span><span class="nf">is_symbol</span><span class="p">(</span><span class="n">ArrayList</span><span class="p">)</span>
<span class="k">assert</span> <span class="ow">not</span> <span class="n">java</span><span class="p">.</span><span class="nf">is_symbol</span><span class="p">(</span><span class="n">my_list</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">java</span><span class="p">.</span><span class="nf">is_object</span><span class="p">(</span><span class="n">ArrayList</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">java</span><span class="p">.</span><span class="nf">is_function</span><span class="p">(</span><span class="n">my_list</span><span class="p">.</span><span class="n">add</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">java</span><span class="p">.</span><span class="nf">instanceof</span><span class="p">(</span><span class="n">my_list</span><span class="p">,</span> <span class="n">ArrayList</span><span class="p">)</span>
</code></pre></div></div>

<p>See <a href="https://github.com/oracle/graal/blob/master/docs/reference-manual/polyglot-programming.md">Polyglot Programming</a> and <a href="https://github.com/oracle/graal/blob/master/docs/reference-manual/embedding/embed-languages.md">Embed Languages</a> for more information about interoperability with other programming languages.</p>

<h3 id="interacting-with-foreign-objects-from-python-scripts"><a href="#interacting-with-foreign-objects-from-python-scripts" class="anchor-link">Interacting with foreign objects from Python scripts</a></h3>

<p>Foreign objects are given a Python class corresponding to their interop traits:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="n">java.util</span> <span class="kn">import</span> <span class="n">ArrayList</span><span class="p">,</span> <span class="n">HashMap</span>
<span class="nf">type</span><span class="p">(</span><span class="nc">ArrayList</span><span class="p">()).</span><span class="nf">mro</span><span class="p">()</span> <span class="c1"># =&gt; [&lt;class 'polyglot.ForeignList'&gt;, &lt;class 'list'&gt;, &lt;class 'polyglot.ForeignObject'&gt;, &lt;class 'object'&gt;]
</span><span class="nf">type</span><span class="p">(</span><span class="nc">HashMap</span><span class="p">()).</span><span class="nf">mro</span><span class="p">()</span> <span class="c1"># =&gt; [&lt;class 'polyglot.ForeignDict'&gt;, &lt;class 'dict'&gt;, &lt;class 'polyglot.ForeignObject'&gt;, &lt;class 'object'&gt;]
</span></code></pre></div></div>

<p>This means all Python methods of these types are available on the corresponding foreign objects, which behave as close as possible as if they were Python objects:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="n">java.util</span> <span class="kn">import</span> <span class="n">ArrayList</span><span class="p">,</span> <span class="n">HashMap</span>
<span class="n">l</span> <span class="o">=</span> <span class="nc">ArrayList</span><span class="p">()</span>
<span class="n">l</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># l: [1]
</span><span class="n">l</span><span class="p">.</span><span class="nf">extend</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span> <span class="c1"># l: [1, 2, 3]
</span><span class="n">l</span><span class="p">.</span><span class="nf">add</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="c1"># l: [1, 2, 3, 4] # we can still call Java methods, this is calling ArrayList#add
</span><span class="n">l</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span> <span class="c1"># =&gt; [2, 3]
</span><span class="n">l</span><span class="p">.</span><span class="nf">pop</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># =&gt; 2; l: [1, 3, 4]
</span><span class="n">l</span><span class="p">.</span><span class="nf">insert</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="c1"># l: [1, 2, 3, 4]
</span><span class="n">l</span> <span class="o">==</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span> <span class="c1"># True
</span>
<span class="n">h</span> <span class="o">=</span> <span class="nc">HashMap</span><span class="p">()</span>
<span class="n">h</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span> <span class="c1"># h: {1: 2}
</span><span class="n">h</span><span class="p">.</span><span class="nf">setdefault</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span> <span class="c1"># h: {1: 2, 3: 4}
</span><span class="n">h</span> <span class="o">|=</span> <span class="p">{</span><span class="mi">3</span><span class="p">:</span> <span class="mi">6</span><span class="p">}</span> <span class="c1"># {1: 2, 3: 6}
</span><span class="n">h</span> <span class="o">==</span> <span class="p">{</span><span class="mi">1</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">6</span><span class="p">}</span> <span class="c1"># True
</span></code></pre></div></div>

<p>In case of a method defined both in Python and on the foreign object, the Python method wins.
To call the foreign method instead, use <code>super(type_owning_the_python_method, foreign_object).method(*args)</code>:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="n">java.util</span> <span class="kn">import</span> <span class="n">ArrayList</span>
<span class="n">l</span> <span class="o">=</span> <span class="nc">ArrayList</span><span class="p">()</span>
<span class="n">l</span><span class="p">.</span><span class="nf">extend</span><span class="p">([</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">])</span>
<span class="n">l</span><span class="p">.</span><span class="nf">remove</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span> <span class="c1"># Python list.remove
</span><span class="k">assert</span> <span class="n">l</span> <span class="o">==</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]</span>

<span class="nf">super</span><span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="n">l</span><span class="p">).</span><span class="nf">remove</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="c1"># ArrayList#remove(int index)
</span><span class="k">assert</span> <span class="n">l</span> <span class="o">==</span> <span class="p">[</span><span class="mi">6</span><span class="p">]</span>
</code></pre></div></div>

<p>See <a href="#interop-types-to-python">this section</a> for more interop traits and how they map to Python types.</p>

<h3 id="interacting-with-other-dynamic-languages-from-python-scripts"><a href="#interacting-with-other-dynamic-languages-from-python-scripts" class="anchor-link">Interacting with other dynamic languages from Python scripts</a></h3>

<p>More general, non-JVM specific interactions with other languages from Python scripts are achieved via the <em>polyglot</em> API.
This includes all interactions with dynamic languages supported via the <a href="https://www.graalvm.org/latest/graalvm-as-a-platform/language-implementation-framework/">Truffle framework</a>, including JavaScript and Ruby.</p>

<h4 id="installing-other-dynamic-languages"><a href="#installing-other-dynamic-languages" class="anchor-link">Installing other dynamic languages</a></h4>

<p>Other languages can be included by using their respective Maven dependencies in the same manner as GraalPy.
For example, if you have already configured a Maven project with GraalPy, add the following dependency to gain access to JavaScript:</p>
<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;dependency&gt;</span>
    <span class="nt">&lt;groupId&gt;</span>org.graalvm.polyglot<span class="nt">&lt;/groupId&gt;</span>
    <span class="nt">&lt;artifactId&gt;</span>js<span class="nt">&lt;/artifactId&gt;</span>
    <span class="nt">&lt;version&gt;</span>24.1.0<span class="nt">&lt;/version&gt;</span>
<span class="nt">&lt;/dependency&gt;</span>
</code></pre></div></div>

<aside>
  <p>For Python developers, other languages are only available for the GraalPy JVM distributions after using the <code>libexec/graalpy-polyglot-get</code> command from the distribution’s root directory.
To install JavaScript, for example:</p>
  <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>libexec/graalpy-polyglot-get js
</code></pre></div>  </div>
</aside>

<h4 id="examples"><a href="#examples" class="anchor-link">Examples</a></h4>

<ol>
  <li>Import the <code>polyglot</code> module to interact with other languages:
    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="n">polyglot</span>
</code></pre></div>    </div>
  </li>
  <li>Evaluate inlined code in another language:
    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">assert</span> <span class="n">polyglot</span><span class="p">.</span><span class="nf">eval</span><span class="p">(</span><span class="n">string</span><span class="o">=</span><span class="sh">"</span><span class="s">1 + 1</span><span class="sh">"</span><span class="p">,</span> <span class="n">language</span><span class="o">=</span><span class="sh">"</span><span class="s">js</span><span class="sh">"</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span>
</code></pre></div>    </div>
  </li>
  <li>Evaluate code from a file:
    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">with</span> <span class="nf">open</span><span class="p">(</span><span class="sh">"</span><span class="s">./my_js_file.js</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">w</span><span class="sh">"</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">f</span><span class="p">.</span><span class="nf">write</span><span class="p">(</span><span class="sh">"</span><span class="s">Polyglot.export(</span><span class="sh">'</span><span class="s">JSMath</span><span class="sh">'</span><span class="s">, Math)</span><span class="sh">"</span><span class="p">)</span>
<span class="n">polyglot</span><span class="p">.</span><span class="nf">eval</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="sh">"</span><span class="s">./my_js_file.js</span><span class="sh">"</span><span class="p">,</span> <span class="n">language</span><span class="o">=</span><span class="sh">"</span><span class="s">js</span><span class="sh">"</span><span class="p">)</span>
</code></pre></div>    </div>
  </li>
  <li>Import a glocal value from the polyglot scope:
    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">Math</span> <span class="o">=</span> <span class="n">polyglot</span><span class="p">.</span><span class="nf">import_value</span><span class="p">(</span><span class="sh">"</span><span class="s">JSMath</span><span class="sh">"</span><span class="p">)</span>
</code></pre></div>    </div>

    <p>This global value should then work as expected:</p>
    <ul>
      <li>Accessing attributes reads from the <em>polyglot members</em> namespace:
        <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">assert</span> <span class="n">Math</span><span class="p">.</span><span class="n">E</span> <span class="o">==</span> <span class="mf">2.718281828459045</span>
</code></pre></div>        </div>
      </li>
      <li>Calling a method on the result attempts to do a straight <code>invoke</code> and falls back to reading the member and trying to execute it.
        <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">assert</span> <span class="n">Math</span><span class="p">.</span><span class="nf">toString</span><span class="p">()</span> <span class="o">==</span> <span class="sh">"</span><span class="s">[object Math]</span><span class="sh">"</span>
</code></pre></div>        </div>
      </li>
      <li>Accessing items is supported both with strings and numbers.
        <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">assert</span> <span class="n">Math</span><span class="p">[</span><span class="sh">"</span><span class="s">PI</span><span class="sh">"</span><span class="p">]</span> <span class="o">==</span> <span class="mf">3.141592653589793</span>
</code></pre></div>        </div>
      </li>
    </ul>
  </li>
  <li>Use the JavaScript regular expression engine to match Python strings:
    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">js_re</span> <span class="o">=</span> <span class="n">polyglot</span><span class="p">.</span><span class="nf">eval</span><span class="p">(</span><span class="n">string</span><span class="o">=</span><span class="sh">"</span><span class="s">RegExp()</span><span class="sh">"</span><span class="p">,</span> <span class="n">language</span><span class="o">=</span><span class="sh">"</span><span class="s">js</span><span class="sh">"</span><span class="p">)</span>

<span class="n">pattern</span> <span class="o">=</span> <span class="n">js_re</span><span class="p">.</span><span class="nf">compile</span><span class="p">(</span><span class="sh">"</span><span class="s">.*(?:we have (?:a )?matching strings?(?:[!</span><span class="se">\\</span><span class="s">?] )?)(.*)</span><span class="sh">"</span><span class="p">)</span>

<span class="k">if</span> <span class="n">pattern</span><span class="p">.</span><span class="nf">exec</span><span class="p">(</span><span class="sh">"</span><span class="s">This string does not match</span><span class="sh">"</span><span class="p">):</span> <span class="k">raise</span> <span class="nc">SystemError</span><span class="p">(</span><span class="sh">"</span><span class="s">that shouldn</span><span class="sh">'</span><span class="s">t happen</span><span class="sh">"</span><span class="p">)</span>

<span class="n">md</span> <span class="o">=</span> <span class="n">pattern</span><span class="p">.</span><span class="nf">exec</span><span class="p">(</span><span class="sh">"</span><span class="s">Look, we have matching strings! This string was matched by Graal.js</span><span class="sh">"</span><span class="p">)</span>

<span class="k">assert</span> <span class="sh">"</span><span class="s">Graal.js</span><span class="sh">"</span> <span class="ow">in</span> <span class="n">md</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</code></pre></div>    </div>

    <p>This program matches Python strings using the JavaScript regular expression object. Python reads the captured group from the JavaScript result and checks for a substring in it.</p>
  </li>
</ol>

<h3 id="exporting-python-objects-to-other-languages"><a href="#exporting-python-objects-to-other-languages" class="anchor-link">Exporting Python Objects to other Languages</a></h3>

<p>The <code>polyglot</code> module can be used to expose Python objects to JVM languages and other Graal languages (languages implemented on the <a href="https://www.graalvm.org/latest/graalvm-as-a-platform/language-implementation-framework/">Truffle framework</a>).</p>

<ol>
  <li>You can export some object from Python to other languages so they can import it:
    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="n">ssl</span>
<span class="n">polyglot</span><span class="p">.</span><span class="nf">export_value</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="n">ssl</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="sh">"</span><span class="s">python_ssl</span><span class="sh">"</span><span class="p">)</span>
</code></pre></div>    </div>

    <p>Then use it in (for example) from JavaScript code:</p>
    <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">Polyglot</span><span class="p">.</span><span class="k">import</span><span class="p">(</span><span class="dl">'</span><span class="s1">python_ssl).get_server_certificate(["oracle.com", 443])
</span></code></pre></div>    </div>
  </li>
  <li>You can decorate a Python function to export it by name:
    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@polyglot.export_value</span>
<span class="k">def</span> <span class="nf">python_method</span><span class="p">():</span>
    <span class="k">return</span> <span class="sh">"</span><span class="s">Hello from Python!</span><span class="sh">"</span>
</code></pre></div>    </div>

    <p>Then use it (for example) from Java code:</p>
    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">org.graalvm.polyglot.*</span><span class="o">;</span>

<span class="kd">class</span> <span class="nc">Main</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">try</span> <span class="o">(</span><span class="kt">var</span> <span class="n">context</span> <span class="o">=</span> <span class="nc">Context</span><span class="o">.</span><span class="na">create</span><span class="o">())</span> <span class="o">{</span>
            <span class="n">context</span><span class="o">.</span><span class="na">eval</span><span class="o">(</span><span class="nc">Source</span><span class="o">.</span><span class="na">newBuilder</span><span class="o">(</span><span class="s">"python"</span><span class="o">,</span> <span class="s">"file:///python_script.py"</span><span class="o">).</span><span class="na">build</span><span class="o">());</span>

            <span class="nc">String</span> <span class="n">result</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span>
                <span class="nf">getPolyglotBindings</span><span class="o">().</span>
                <span class="n">getMember</span><span class="o">(</span><span class="s">"python_method"</span><span class="o">).</span>
                <span class="n">execute</span><span class="o">().</span>
                <span class="n">asString</span><span class="o">();</span>
            <span class="k">assert</span> <span class="n">result</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="s">"Hello from Python!"</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>
 <span class="o">}</span>
</code></pre></div>    </div>
  </li>
</ol>

<h3 id="mapping-types-between-python-and-other-languages"><a href="#mapping-types-between-python-and-other-languages" class="anchor-link">Mapping Types between Python and Other Languages</a></h3>

<p>The interop protocol defines different “types/traits” which can overlap in all kinds of ways and have restrictions on how they can interact with Python.</p>

<h4 id="interop-types-to-python"><a href="#interop-types-to-python" class="anchor-link">Interop Types to Python</a></h4>

<p>All foreign objects passed into Python have the Python type <code>polyglot.ForeignObject</code> or a subclass.</p>

<p>Types not listed in the table below have no special interpretation in Python.</p>

<table>
  <thead>
    <tr>
      <th style="text-align: left">Interop Type</th>
      <th style="text-align: left">Inherits from</th>
      <th style="text-align: left">Python Interpretation</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left"><code>null</code></td>
      <td style="text-align: left">ForeignNone, <code>NoneType</code></td>
      <td style="text-align: left"><code>null</code> is like <code>None</code>. Important to know: interop <code>null</code> values are all identical to <code>None</code>. JavaScript defines two “null-like” values; <code>undefined</code> and <code>null</code>, which are <em>not</em> identical, but when passed to Python, they are treated so.</td>
    </tr>
    <tr>
      <td style="text-align: left"><code>boolean</code></td>
      <td style="text-align: left">ForeignBoolean, ForeignNumber</td>
      <td style="text-align: left"><code>boolean</code> behaves like Python booleans, including the fact that in Python, all booleans are also integers (1 and 0 for true and false, respectively).</td>
    </tr>
    <tr>
      <td style="text-align: left"><code>number</code></td>
      <td style="text-align: left">ForeignNumber</td>
      <td style="text-align: left"><code>number</code> behaves like Python numbers. Python only has one integer and one floating point type, but ranges are imported in some places such as typed arrays.</td>
    </tr>
    <tr>
      <td style="text-align: left"><code>string</code></td>
      <td style="text-align: left">ForeignString, <code>str</code></td>
      <td style="text-align: left">Behaves in the same way as a Python string.</td>
    </tr>
    <tr>
      <td style="text-align: left"><code>buffer</code></td>
      <td style="text-align: left">ForeignObject</td>
      <td style="text-align: left">Buffers are also a concept in Python’s native API (albeit slightly different). Interop buffers are treated in the same was as Python buffers in some places (such as <code>memoryview</code>) to avoid copies of data.</td>
    </tr>
    <tr>
      <td style="text-align: left"><code>array</code></td>
      <td style="text-align: left">ForeignList, <code>list</code></td>
      <td style="text-align: left">An <code>array</code> behaves like a Python <code>list</code>.</td>
    </tr>
    <tr>
      <td style="text-align: left"><code>hash</code></td>
      <td style="text-align: left">ForeignDict, <code>dict</code></td>
      <td style="text-align: left">A <code>hash</code> behaves like a Python <code>dict</code>, with any “hashable” object as a key. “Hashable” follows Python semantics: generally every interop type with an identity is deemed “hashable”.</td>
    </tr>
    <tr>
      <td style="text-align: left"><code>members</code></td>
      <td style="text-align: left">ForeignObject</td>
      <td style="text-align: left">An object of type <code>members</code> can be read using conventional Python <code>.</code> notation or <code>getattr</code> and related functions.</td>
    </tr>
    <tr>
      <td style="text-align: left"><code>iterable</code></td>
      <td style="text-align: left">ForeignIterable</td>
      <td style="text-align: left">An <code>iterable</code> is treated in the same way as any Python object with an <code>__iter__</code> method. That is, it can be used in a loop and other places that accept Python iterables.</td>
    </tr>
    <tr>
      <td style="text-align: left"><code>iterator</code></td>
      <td style="text-align: left">ForeignIterator, <code>iterator</code></td>
      <td style="text-align: left">An <code>iterator</code> is treated in the same way as any Python object with a <code>__next__</code> method.</td>
    </tr>
    <tr>
      <td style="text-align: left"><code>exception</code></td>
      <td style="text-align: left">ForeignException, <code>BaseException</code></td>
      <td style="text-align: left">An <code>exception</code> can be caught in a generic <code>except</code> clause.</td>
    </tr>
    <tr>
      <td style="text-align: left"><code>MetaObject</code></td>
      <td style="text-align: left">ForeignAbstractClass</td>
      <td style="text-align: left">Meta objects can be used in subtype and <code>isinstance</code> checks.</td>
    </tr>
    <tr>
      <td style="text-align: left"><code>executable</code></td>
      <td style="text-align: left">ForeignExecutable</td>
      <td style="text-align: left">An <code>executable</code> object can be executed as a function, but never with keyword arguments.</td>
    </tr>
    <tr>
      <td style="text-align: left"><code>instantiable</code></td>
      <td style="text-align: left">ForeignInstantiable</td>
      <td style="text-align: left">An <code>instantiable</code> object can be called just like a Python type, but never with keyword arguments.</td>
    </tr>
  </tbody>
</table>

<p>Foreign numbers inherit from <code>polyglot.ForeignNumber</code> and not <code>int</code> or <code>float</code> because <code>InteropLibrary</code> has currently no way to differentiate integers and floats.
However:</p>
<ul>
  <li>When foreign numbers are represented as Java primitives <code>byte</code>, <code>short</code>, <code>int</code>, <code>long</code>, they are considered Python <code>int</code> objects.</li>
  <li>When foreign numbers are represented as Java primitives <code>float</code>, <code>double</code>, they are considered Python <code>float</code> objects.</li>
  <li>When foreign booleans re represented as Java primitives <code>boolean</code>, they are considered Python <code>bool</code> objects.</li>
</ul>

<h4 id="python-to-interop-types"><a href="#python-to-interop-types" class="anchor-link">Python to Interop Types</a></h4>

<table>
  <thead>
    <tr>
      <th style="text-align: left">Interop Type</th>
      <th style="text-align: left">Python Interpretation</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left"><code>null</code></td>
      <td style="text-align: left">Only <code>None</code>.</td>
    </tr>
    <tr>
      <td style="text-align: left"><code>boolean</code></td>
      <td style="text-align: left">Only subtypes of Python <code>bool</code>. Note that in contrast to Python semantics, Python <code>bool</code> is <em>never</em> also an interop number.</td>
    </tr>
    <tr>
      <td style="text-align: left"><code>number</code></td>
      <td style="text-align: left">Only subtypes of <code>int</code> and <code>float</code>.</td>
    </tr>
    <tr>
      <td style="text-align: left"><code>string</code></td>
      <td style="text-align: left">Only subtypes of <code>str</code>.</td>
    </tr>
    <tr>
      <td style="text-align: left"><code>array</code></td>
      <td style="text-align: left">Any object with <code>__getitem__</code> and <code>__len__</code> methods, but not if it also has <code>keys</code>, <code>values</code>, and <code>items</code> methods (in the same way that <code>dict</code> does.)</td>
    </tr>
    <tr>
      <td style="text-align: left"><code>hash</code></td>
      <td style="text-align: left">Only subtypes of <code>dict</code>.</td>
    </tr>
    <tr>
      <td style="text-align: left"><code>members</code></td>
      <td style="text-align: left">Any Python object. Note that the rules for readable/writable are a bit ad-hoc, since checking that is not part of the Python MOP.</td>
    </tr>
    <tr>
      <td style="text-align: left"><code>iterable</code></td>
      <td style="text-align: left">Any Python object that has <code>__iter__</code> or a <code>__getitem__</code> methods.</td>
    </tr>
    <tr>
      <td style="text-align: left"><code>iterator</code></td>
      <td style="text-align: left">Any Python object with a <code>__next__</code> method.</td>
    </tr>
    <tr>
      <td style="text-align: left"><code>exception</code></td>
      <td style="text-align: left">Any Python <code>BaseException</code> subtype.</td>
    </tr>
    <tr>
      <td style="text-align: left"><code>MetaObject</code></td>
      <td style="text-align: left">Any Python <code>type</code>.</td>
    </tr>
    <tr>
      <td style="text-align: left"><code>executable</code></td>
      <td style="text-align: left">Any Python object  with a <code>__call__</code> method.</td>
    </tr>
    <tr>
      <td style="text-align: left"><code>instantiable</code></td>
      <td style="text-align: left">Any Python <code>type</code>.</td>
    </tr>
  </tbody>
</table>

<h3 id="the-interoperability-extension-api"><a href="#the-interoperability-extension-api" class="anchor-link">The Interoperability Extension API</a></h3>

<p>It is possible to extend the interoperability protocol directly from Python via a simple API defined in the <code>polyglot</code> module. 
The purpose of this API is to enable custom / user defined types to take part in the interop ecosystem. 
This is particularly useful for external types which are not compatible by default with the interop protocol. 
An example in this sense are the <code>numpy</code> numeric types (for example, <code>numpy.int32</code>) which are not supported by default by the interop protocol.</p>

<h4 id="the-api"><a href="#the-api" class="anchor-link">The API</a></h4>

<table>
  <thead>
    <tr>
      <th style="text-align: left">Function</th>
      <th style="text-align: left">Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left">register_interop_behavior</td>
      <td style="text-align: left">Takes the receiver <strong>type</strong> as first argument. The remainder keyword arguments correspond to the respective interop messages. Not All interop messages are supported.</td>
    </tr>
    <tr>
      <td style="text-align: left">get_registered_interop_behavior</td>
      <td style="text-align: left">Takes the receiver <strong>type</strong> as first argument. Returns the list of extended interop messages for the given type.</td>
    </tr>
    <tr>
      <td style="text-align: left">@interop_behavior</td>
      <td style="text-align: left">Class decorator, takes the receiver <strong>type</strong> as only argument. The interop messages are extended via <strong>static</strong> methods defined in the decorated class (supplier).</td>
    </tr>
    <tr>
      <td style="text-align: left">register_interop_type</td>
      <td style="text-align: left">Takes a <code>foreign class</code> and <code>python class</code> as positional arguments and <code>allow_method_overwrites</code> as optional argument (default: <code>False</code>). Every instance of foreign class is then treated as an instance of the given python class.</td>
    </tr>
    <tr>
      <td style="text-align: left">@interop_type</td>
      <td style="text-align: left">Class decorator, takes the <code>foreign class</code> and optionally <code>allow_method_overwrites</code> as arguments. The instances of foreign class will be treated as an instance of the annotated python class.</td>
    </tr>
  </tbody>
</table>

<h4 id="usage-examples"><a href="#usage-examples" class="anchor-link">Usage Examples</a></h4>

<h5 id="interop-behavior"><a href="#interop-behavior" class="anchor-link">Interop Behavior</a></h5>

<p>A simple <code>register_interop_behavior</code> API is available to register interop behaviors for existing types:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="n">polyglot</span>
<span class="kn">import</span> <span class="n">numpy</span>

<span class="n">polyglot</span><span class="p">.</span><span class="nf">register_interop_behavior</span><span class="p">(</span><span class="n">numpy</span><span class="p">.</span><span class="n">int32</span><span class="p">,</span>
    <span class="n">is_number</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
    <span class="n">fitsInByte</span><span class="o">=</span><span class="k">lambda</span> <span class="n">v</span><span class="p">:</span> <span class="o">-</span><span class="mi">128</span> <span class="o">&lt;=</span> <span class="n">v</span> <span class="o">&lt;</span> <span class="mi">128</span><span class="p">,</span>
    <span class="n">fitsInShort</span><span class="o">=</span><span class="k">lambda</span> <span class="n">v</span><span class="p">:</span> <span class="o">-</span><span class="mh">0x8000</span> <span class="o">&lt;=</span> <span class="n">v</span> <span class="o">&lt;</span> <span class="mh">0x8000</span><span class="p">,</span>
    <span class="n">fitsInInt</span> <span class="o">=</span> <span class="bp">True</span><span class="p">,</span>
    <span class="n">fitsInLong</span> <span class="o">=</span> <span class="bp">True</span><span class="p">,</span>
    <span class="n">fitsInBigInteger</span> <span class="o">=</span> <span class="bp">True</span><span class="p">,</span>
    <span class="n">asByte</span> <span class="o">=</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">asShort</span> <span class="o">=</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">asInt</span> <span class="o">=</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">asLong</span> <span class="o">=</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">asBigInteger</span> <span class="o">=</span> <span class="nb">int</span><span class="p">,</span>
<span class="p">)</span>
</code></pre></div></div>

<p>The <code>@interop_behavior</code> decorator may be more convenient when declaring more behaviors.
Interop message extension is achieved via <strong>static</strong> methods of the decorated class.
The names of the static methods are identical to the keyword names expected by <code>register_interop_behavior</code>.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="n">polyglot</span> <span class="kn">import</span> <span class="n">interop_behavior</span>
<span class="kn">import</span> <span class="n">numpy</span>


<span class="nd">@interop_behavior</span><span class="p">(</span><span class="n">numpy</span><span class="p">.</span><span class="n">float64</span><span class="p">)</span>
<span class="k">class</span> <span class="nc">Int8InteropBehaviorSupplier</span><span class="p">:</span>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">is_number</span><span class="p">(</span><span class="n">_</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">True</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">fitsInDouble</span><span class="p">(</span><span class="n">_</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">True</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">asDouble</span><span class="p">(</span><span class="n">v</span><span class="p">):</span>
        <span class="k">return</span> <span class="nf">float</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
</code></pre></div></div>

<p>Both classes can then behave as expected when embedded:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">java.nio.file.Files</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.nio.file.Path</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.graalvm.polyglot.Context</span><span class="o">;</span>

<span class="kd">class</span> <span class="nc">Main</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">try</span> <span class="o">(</span><span class="kt">var</span> <span class="n">context</span> <span class="o">=</span> <span class="nc">Context</span><span class="o">.</span><span class="na">create</span><span class="o">())</span> <span class="o">{</span>
            <span class="n">context</span><span class="o">.</span><span class="na">eval</span><span class="o">(</span><span class="s">"python"</span><span class="o">,</span> <span class="nc">Files</span><span class="o">.</span><span class="na">readString</span><span class="o">(</span><span class="nc">Path</span><span class="o">.</span><span class="na">of</span><span class="o">(</span><span class="s">"path/to/interop/behavior/script.py"</span><span class="o">)));</span>
            <span class="k">assert</span> <span class="n">context</span><span class="o">.</span><span class="na">eval</span><span class="o">(</span><span class="s">"python"</span><span class="o">,</span> <span class="s">"numpy.float64(12)"</span><span class="o">).</span><span class="na">asDouble</span><span class="o">()</span> <span class="o">==</span> <span class="mf">12.0</span><span class="o">;</span>
            <span class="k">assert</span> <span class="n">context</span><span class="o">.</span><span class="na">eval</span><span class="o">(</span><span class="s">"python"</span><span class="o">,</span> <span class="s">"numpy.int32(12)"</span><span class="o">).</span><span class="na">asByte</span><span class="o">()</span> <span class="o">==</span> <span class="mi">12</span><span class="o">;</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>
<h5 id="interop-types"><a href="#interop-types" class="anchor-link">Interop Types</a></h5>

<p>The <code>register_interop_type</code> API allows the usage of python classes for foreign objects.
The class of such a foreign object will no longer be <code>polyglot.ForeignObject</code> or <code>polyglot.Foreign*</code>. 
Instead, it will be a generated class with the registered python classes and <code>polyglot.ForeignObject</code> as super class.
This allows custom mapping of foreign methods and attributes to Python’s magic methods or more idiomatic Python code.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">package</span> <span class="nn">org.example</span><span class="o">;</span>

<span class="kd">class</span> <span class="nc">MyJavaClass</span> <span class="o">{</span>
      <span class="kd">private</span> <span class="kt">int</span> <span class="n">x</span><span class="o">;</span>
      <span class="kd">private</span> <span class="kt">int</span> <span class="n">y</span><span class="o">;</span>
      
      <span class="kd">public</span> <span class="nf">MyJavaClass</span><span class="o">(</span><span class="kt">int</span> <span class="n">x</span><span class="o">,</span> <span class="kt">int</span> <span class="n">y</span><span class="o">)</span> <span class="o">{</span>
         <span class="k">this</span><span class="o">.</span><span class="na">x</span> <span class="o">=</span> <span class="n">x</span><span class="o">;</span>
         <span class="k">this</span><span class="o">.</span><span class="na">y</span> <span class="o">=</span> <span class="n">y</span><span class="o">;</span>
      <span class="o">}</span>

      <span class="kd">public</span> <span class="kt">int</span> <span class="nf">getX</span><span class="o">()</span> <span class="o">{</span>
         <span class="k">return</span> <span class="n">x</span><span class="o">;</span>
      <span class="o">}</span>

      <span class="kd">public</span> <span class="kt">int</span> <span class="nf">getY</span><span class="o">()</span> <span class="o">{</span>
         <span class="k">return</span> <span class="n">y</span><span class="o">;</span>
      <span class="o">}</span>
   <span class="o">}</span>
</code></pre></div></div>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">org.example.MyJavaClass</span><span class="o">;</span>
        
<span class="kd">class</span> <span class="nc">Main</span> <span class="o">{</span>

   <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
      <span class="nc">MyJavaClass</span> <span class="n">myJavaObject</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">MyJavaClass</span><span class="o">(</span><span class="mi">42</span><span class="o">,</span> <span class="mi">17</span><span class="o">);</span>
      <span class="k">try</span> <span class="o">(</span><span class="kt">var</span> <span class="n">context</span> <span class="o">=</span> <span class="nc">Context</span><span class="o">.</span><span class="na">create</span><span class="o">())</span> <span class="o">{</span>
         <span class="c1">// myJavaObject will be globally available in example.py as my_java_object</span>
         <span class="n">context</span><span class="o">.</span><span class="na">getBindings</span><span class="o">(</span><span class="s">"python"</span><span class="o">).</span><span class="na">putMember</span><span class="o">(</span><span class="s">"my_java_object"</span><span class="o">,</span> <span class="n">myJavaObject</span><span class="o">);</span>
         <span class="n">context</span><span class="o">.</span><span class="na">eval</span><span class="o">(</span><span class="nc">Source</span><span class="o">.</span><span class="na">newBuilder</span><span class="o">(</span><span class="s">"python"</span><span class="o">,</span> <span class="s">"example.py"</span><span class="o">));</span>
      <span class="o">}</span>
   <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># example.py
</span><span class="kn">import</span> <span class="n">java</span>
<span class="kn">from</span> <span class="n">polyglot</span> <span class="kn">import</span> <span class="n">register_interop_type</span>

<span class="nf">print</span><span class="p">(</span><span class="n">my_java_object</span><span class="p">.</span><span class="nf">getX</span><span class="p">())</span> <span class="c1"># 42
</span><span class="nf">print</span><span class="p">(</span><span class="nf">type</span><span class="p">(</span><span class="n">my_java_object</span><span class="p">))</span> <span class="c1"># &lt;class 'polyglot.ForeignObject'&gt;
</span>
<span class="k">class</span> <span class="nc">MyPythonClass</span><span class="p">:</span>
   <span class="k">def</span> <span class="nf">get_tuple</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
      <span class="nf">return </span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="nf">getX</span><span class="p">(),</span> <span class="n">self</span><span class="p">.</span><span class="nf">getY</span><span class="p">())</span>

<span class="n">foreign_class</span> <span class="o">=</span> <span class="n">java</span><span class="p">.</span><span class="nf">type</span><span class="p">(</span><span class="sh">"</span><span class="s">org.example.MyJavaClass</span><span class="sh">"</span><span class="p">)</span>

<span class="nf">register_interop_type</span><span class="p">(</span><span class="n">foreign_class</span><span class="p">,</span> <span class="n">MyPythonClass</span><span class="p">)</span>

<span class="nf">print</span><span class="p">(</span><span class="n">my_java_object</span><span class="p">.</span><span class="nf">get_tuple</span><span class="p">())</span> <span class="c1"># (42, 17)
</span><span class="nf">print</span><span class="p">(</span><span class="nf">type</span><span class="p">(</span><span class="n">my_java_object</span><span class="p">))</span> <span class="c1"># &lt;class 'polyglot.Java_org.example.MyJavaClass_generated'&gt;
</span><span class="nf">print</span><span class="p">(</span><span class="nf">type</span><span class="p">(</span><span class="n">my_java_object</span><span class="p">).</span><span class="nf">mro</span><span class="p">())</span> <span class="c1"># [polyglot.Java_org.example.MyJavaClass_generated, MyPythonClass, polyglot.ForeignObject, object]
</span>
<span class="k">class</span> <span class="nc">MyPythonClassTwo</span><span class="p">:</span>
   <span class="k">def</span> <span class="nf">get_tuple</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
      <span class="nf">return </span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="nf">getY</span><span class="p">(),</span> <span class="n">self</span><span class="p">.</span><span class="nf">getX</span><span class="p">())</span>
   
   <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
      <span class="k">return</span> <span class="sa">f</span><span class="sh">"</span><span class="s">MyJavaInstance(x=</span><span class="si">{</span><span class="n">self</span><span class="p">.</span><span class="nf">getX</span><span class="p">()</span><span class="si">}</span><span class="s">, y=</span><span class="si">{</span><span class="n">self</span><span class="p">.</span><span class="nf">getY</span><span class="p">()</span><span class="si">}</span><span class="sh">"</span>

<span class="c1"># If 'allow_method_overwrites=True' is not given, this would lead to an error due to the method conflict of 'get_tuple'  
</span><span class="nf">register_interop_type</span><span class="p">(</span><span class="n">foreign_class</span><span class="p">,</span> <span class="n">MyPythonClassTwo</span><span class="p">,</span> <span class="n">allow_method_overwrites</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

<span class="c1"># A newly registered class will be before already registered classes in the mro.
# It allows overwriting methods from already registered classes with the flag 'allow_method_overwrites=True'
</span><span class="nf">print</span><span class="p">(</span><span class="nf">type</span><span class="p">(</span><span class="n">my_java_object</span><span class="p">).</span><span class="nf">mro</span><span class="p">())</span> <span class="c1"># [generated_class, MyPythonClassTwo, MyPythonClass, polyglot.ForeignObject, object]
</span>
<span class="nf">print</span><span class="p">(</span><span class="n">my_java_object</span><span class="p">.</span><span class="nf">get_tuple</span><span class="p">())</span> <span class="c1"># (17, 42)
</span><span class="nf">print</span><span class="p">(</span><span class="n">my_java_object</span><span class="p">)</span> <span class="c1"># MyJavaInstance(x=42, y=17)
</span></code></pre></div></div>

<p>Registering classes may be more convenient with <code>@interop_type</code>:</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="n">java</span>
<span class="kn">from</span> <span class="n">polyglot</span> <span class="kn">import</span> <span class="n">interop_type</span>

<span class="n">foreign_class</span> <span class="o">=</span> <span class="n">java</span><span class="p">.</span><span class="nf">type</span><span class="p">(</span><span class="sh">"</span><span class="s">org.example.MyJavaClass</span><span class="sh">"</span><span class="p">)</span>

<span class="nd">@interop_type</span><span class="p">(</span><span class="n">foreign_class</span><span class="p">)</span>
<span class="k">class</span> <span class="nc">MyPythonClass</span><span class="p">:</span>
   <span class="k">def</span> <span class="nf">get_tuple</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
      <span class="nf">return </span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="nf">getX</span><span class="p">(),</span> <span class="n">self</span><span class="p">.</span><span class="nf">getY</span><span class="p">())</span>
</code></pre></div></div>

<h4 id="supported-messages"><a href="#supported-messages" class="anchor-link">Supported messages</a></h4>

<p>The majority (with some exceptions) of the interop messages are supported by the interop behavior extension API, as shown in the table below.<br />
The naming convention for the <code>register_interop_behavior</code> keyword arguments follows the <em>snake_case</em> naming convention, i.e. the interop <code>fitsInLong</code> message 
becomes <code>fits_in_long</code> and so on. Each message can be extended with a <strong>pure python function</strong> (default keyword arguments, free vars and cell vars are not allowed) or a <strong>boolean constant</strong>. 
The table below describes the supported interop messages:</p>

<table>
  <thead>
    <tr>
      <th style="text-align: left">Message</th>
      <th style="text-align: left">Extension argument name</th>
      <th>Expected return type</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left">isBoolean</td>
      <td style="text-align: left">is_boolean</td>
      <td>bool</td>
    </tr>
    <tr>
      <td style="text-align: left">isDate</td>
      <td style="text-align: left">is_date</td>
      <td>bool</td>
    </tr>
    <tr>
      <td style="text-align: left">isDuration</td>
      <td style="text-align: left">is_duration</td>
      <td>bool</td>
    </tr>
    <tr>
      <td style="text-align: left">isIterator</td>
      <td style="text-align: left">is_iterator</td>
      <td>bool</td>
    </tr>
    <tr>
      <td style="text-align: left">isNumber</td>
      <td style="text-align: left">is_number</td>
      <td>bool</td>
    </tr>
    <tr>
      <td style="text-align: left">isString</td>
      <td style="text-align: left">is_string</td>
      <td>bool</td>
    </tr>
    <tr>
      <td style="text-align: left">isTime</td>
      <td style="text-align: left">is_time</td>
      <td>bool</td>
    </tr>
    <tr>
      <td style="text-align: left">isTimeZone</td>
      <td style="text-align: left">is_time_zone</td>
      <td>bool</td>
    </tr>
    <tr>
      <td style="text-align: left">isExecutable</td>
      <td style="text-align: left">is_executable</td>
      <td>bool</td>
    </tr>
    <tr>
      <td style="text-align: left">fitsInBigInteger</td>
      <td style="text-align: left">fits_in_big_integer</td>
      <td>bool</td>
    </tr>
    <tr>
      <td style="text-align: left">fitsInByte</td>
      <td style="text-align: left">fits_in_byte</td>
      <td>bool</td>
    </tr>
    <tr>
      <td style="text-align: left">fitsInDouble</td>
      <td style="text-align: left">fits_in_double</td>
      <td>bool</td>
    </tr>
    <tr>
      <td style="text-align: left">fitsInFloat</td>
      <td style="text-align: left">fits_in_float</td>
      <td>bool</td>
    </tr>
    <tr>
      <td style="text-align: left">fitsInInt</td>
      <td style="text-align: left">fits_in_int</td>
      <td>bool</td>
    </tr>
    <tr>
      <td style="text-align: left">fitsInLong</td>
      <td style="text-align: left">fits_in_long</td>
      <td>bool</td>
    </tr>
    <tr>
      <td style="text-align: left">fitsInShort</td>
      <td style="text-align: left">fits_in_short</td>
      <td>bool</td>
    </tr>
    <tr>
      <td style="text-align: left">asBigInteger</td>
      <td style="text-align: left">as_big_integer</td>
      <td>int</td>
    </tr>
    <tr>
      <td style="text-align: left">asBoolean</td>
      <td style="text-align: left">as_boolean</td>
      <td>bool</td>
    </tr>
    <tr>
      <td style="text-align: left">asByte</td>
      <td style="text-align: left">as_byte</td>
      <td>int</td>
    </tr>
    <tr>
      <td style="text-align: left">asDate</td>
      <td style="text-align: left">as_date</td>
      <td>3-tuple with the following elements: (<code>year</code>: int, <code>month</code>: int, <code>day</code>: int)</td>
    </tr>
    <tr>
      <td style="text-align: left">asDouble</td>
      <td style="text-align: left">as_double</td>
      <td>float</td>
    </tr>
    <tr>
      <td style="text-align: left">asDuration</td>
      <td style="text-align: left">as_duration</td>
      <td>2-tuple with the following elements: (<code>seconds</code>: long, <code>nano_adjustment</code>: long)</td>
    </tr>
    <tr>
      <td style="text-align: left">asFloat</td>
      <td style="text-align: left">as_float</td>
      <td>float</td>
    </tr>
    <tr>
      <td style="text-align: left">asInt</td>
      <td style="text-align: left">as_int</td>
      <td>int</td>
    </tr>
    <tr>
      <td style="text-align: left">asLong</td>
      <td style="text-align: left">as_long</td>
      <td>int</td>
    </tr>
    <tr>
      <td style="text-align: left">asShort</td>
      <td style="text-align: left">as_short</td>
      <td>int</td>
    </tr>
    <tr>
      <td style="text-align: left">asString</td>
      <td style="text-align: left">as_string</td>
      <td>str</td>
    </tr>
    <tr>
      <td style="text-align: left">asTime</td>
      <td style="text-align: left">as_time</td>
      <td>4-tuple with the following elements:  (<code>hour</code>: int, <code>minute</code>: int, <code>second</code>: int, <code>microsecond</code>: int)</td>
    </tr>
    <tr>
      <td style="text-align: left">asTimeZone</td>
      <td style="text-align: left">as_time_zone</td>
      <td>a string (the timezone) or int (utc delta in seconds)</td>
    </tr>
    <tr>
      <td style="text-align: left">execute</td>
      <td style="text-align: left">execute</td>
      <td>object</td>
    </tr>
    <tr>
      <td style="text-align: left">readArrayElement</td>
      <td style="text-align: left">read_array_element</td>
      <td>object</td>
    </tr>
    <tr>
      <td style="text-align: left">getArraySize</td>
      <td style="text-align: left">get_array_size</td>
      <td>int</td>
    </tr>
    <tr>
      <td style="text-align: left">hasArrayElements</td>
      <td style="text-align: left">has_array_elements</td>
      <td>bool</td>
    </tr>
    <tr>
      <td style="text-align: left">isArrayElementReadable</td>
      <td style="text-align: left">is_array_element_readable</td>
      <td>bool</td>
    </tr>
    <tr>
      <td style="text-align: left">isArrayElementModifiable</td>
      <td style="text-align: left">is_array_element_modifiable</td>
      <td>bool</td>
    </tr>
    <tr>
      <td style="text-align: left">isArrayElementInsertable</td>
      <td style="text-align: left">is_array_element_insertable</td>
      <td>bool</td>
    </tr>
    <tr>
      <td style="text-align: left">isArrayElementRemovable</td>
      <td style="text-align: left">is_array_element_removable</td>
      <td>bool</td>
    </tr>
    <tr>
      <td style="text-align: left">removeArrayElement</td>
      <td style="text-align: left">remove_array_element</td>
      <td>NoneType</td>
    </tr>
    <tr>
      <td style="text-align: left">writeArrayElement</td>
      <td style="text-align: left">write_array_element</td>
      <td>NoneType</td>
    </tr>
    <tr>
      <td style="text-align: left">hasIterator</td>
      <td style="text-align: left">has_iterator</td>
      <td>bool</td>
    </tr>
    <tr>
      <td style="text-align: left">hasIteratorNextElement</td>
      <td style="text-align: left">has_iterator_next_element</td>
      <td>bool</td>
    </tr>
    <tr>
      <td style="text-align: left">getIterator</td>
      <td style="text-align: left">get_iterator</td>
      <td>a python iterator</td>
    </tr>
    <tr>
      <td style="text-align: left">getIteratorNextElement</td>
      <td style="text-align: left">get_iterator_next_element</td>
      <td>object</td>
    </tr>
    <tr>
      <td style="text-align: left">hasHashEntries</td>
      <td style="text-align: left">has_hash_entries</td>
      <td>bool</td>
    </tr>
    <tr>
      <td style="text-align: left">getHashEntriesIterator</td>
      <td style="text-align: left">get_hash_entries_iterator</td>
      <td>a python iterator</td>
    </tr>
    <tr>
      <td style="text-align: left">getHashKeysIterator</td>
      <td style="text-align: left">get_hash_keys_iterator</td>
      <td>a python iterator</td>
    </tr>
    <tr>
      <td style="text-align: left">getHashSize</td>
      <td style="text-align: left">get_hash_size</td>
      <td>int</td>
    </tr>
    <tr>
      <td style="text-align: left">getHashValuesIterator</td>
      <td style="text-align: left">get_hash_values_iterator</td>
      <td>a python iterator</td>
    </tr>
    <tr>
      <td style="text-align: left">isHashEntryReadable</td>
      <td style="text-align: left">is_hash_entry_readable</td>
      <td>bool</td>
    </tr>
    <tr>
      <td style="text-align: left">isHashEntryModifiable</td>
      <td style="text-align: left">is_hash_entry_modifiable</td>
      <td>bool</td>
    </tr>
    <tr>
      <td style="text-align: left">isHashEntryInsertable</td>
      <td style="text-align: left">is_hash_entry_insertable</td>
      <td>bool</td>
    </tr>
    <tr>
      <td style="text-align: left">isHashEntryRemovable</td>
      <td style="text-align: left">is_hash_entry_removable</td>
      <td>bool</td>
    </tr>
    <tr>
      <td style="text-align: left">readHashValue</td>
      <td style="text-align: left">read_hash_value</td>
      <td>object</td>
    </tr>
    <tr>
      <td style="text-align: left">writeHashEntry</td>
      <td style="text-align: left">write_hash_entry</td>
      <td>NoneType</td>
    </tr>
    <tr>
      <td style="text-align: left">removeHashEntry</td>
      <td style="text-align: left">remove_hash_entry</td>
      <td>NoneType</td>
    </tr>
  </tbody>
</table>

<h2 id="embedding-build-tools"><a href="#embedding-build-tools" class="anchor-link">Embedding Build Tools</a></h2>

<p>The GraalPy <strong>Maven</strong> and <strong>Gradle</strong> plugins provide functionality to manage Python related resources
required for embedding Python code in Java-based applications:</p>
<ul>
  <li><em>Python application files</em> provided by the user, for example, Python sources which are part of the project.</li>
  <li><em>Third-party Python packages</em> installed by the plugin during the build according to the plugin configuration.</li>
</ul>

<p>Apart from physically managing and deploying those files, it is also necessary to make them available in Python at runtime by configuring the <strong>GraalPy Context</strong> in your Java code accordingly.
The <a href="https://github.com/oracle/graalpython/blob/master/graalpython/org.graalvm.python.embedding/src/org/graalvm/python/embedding/utils/GraalPyResources.java">GraalPyResources</a> API provides factory methods to create a Context preconfigured for accessing Python, embedding relevant resources with a <strong>Virtual Filesystem</strong> or from a dedicated <strong>external directory</strong>.</p>

<h3 id="deployment"><a href="#deployment" class="anchor-link">Deployment</a></h3>

<p>There are two modes how to deploy the resources: as Java resources using the Virtual Filesystem to access them in Python, or as an external directory.</p>

<h4 id="virtual-filesystem"><a href="#virtual-filesystem" class="anchor-link">Virtual Filesystem</a></h4>

<p>The Python related resources are embedded in the application file, either in JAR or Native Image generated
executable, as standard Java resources.
The GraalPy Virtual Filesystem internally accesses the resource files as standard Java resources and makes them available to Python code running in GraalPy.
This is transparent to the Python code, which can use standard Python IO to access those files.</p>

<p>Java resource files in a Maven or Gradle project are typically located in dedicated resources directories, such as <code>src/main/resources</code>.
Moreover, there can be multiple resources directories and Maven or Gradle usually merges them.</p>

<p>User can choose relative Java resources path that will be made accessible in Python through the virtual filesystem,
by default it is <code>org.graalvm.python.vfs</code>. All resources subdirectories with this path are merged during build and mapped to a configurable Virtual Filesystem mount point at the Python side, by default <code>/graalpy_vfs</code>.
For example, a Python file with the real filesystem path <code>${project_resources_directory}/org.graalvm.python.vfs/src/foo/bar.py</code> will be accessible as <code>/graalpy_vfs/src/foo/bar.py</code> in Python.</p>

<p>Use the following <a href="https://github.com/oracle/graalpython/blob/master/graalpython/org.graalvm.python.embedding/src/org/graalvm/python/embedding/utils/GraalPyResources.java">GraalPyResources</a>
factory methods to create GraalPy Context preconfigured for the use of the Virtual Filesystem:</p>
<ul>
  <li><code>GraalPyResources.createContext()</code></li>
  <li><code>GraalPyResources.contextBuilder()</code></li>
  <li><code>GraalPyResources.contextBuilder(VirtualFileSystem)</code></li>
</ul>

<h5 id="java-resource-path"><a href="#java-resource-path" class="anchor-link">Java Resource Path</a></h5>
<p>Particularly when developing reusable libraries, it is recommended to use custom unique Java resources path for your
virtual filesystem to avoid conflicts with other libraries on the classpath or module path that may also use the
Virtual Filesystem. The recommended path is:</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>GRAALPY-VFS/<span class="k">${</span><span class="nv">project</span><span class="p">.groupId</span><span class="k">}</span>/<span class="k">${</span><span class="nv">project</span><span class="p">.artifactId</span><span class="k">}</span>
</code></pre></div></div>

<p>The Java resources path must be configured in the Maven and Gradle plugins and must be also set to the same value
at runtime using the <code>VirtualFileSystem$Builder#resourceDirectory</code> API.</p>

<p><em>Note regarding Java module system: resources in named modules are subject to the encapsulation rules specified by
<a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Module.html#getResourceAsStream(java.lang.String)">Module.getResourceAsStream</a>.
This is also the case of the default virtual filesystem location.
When a resources directory is not a valid Java package name, such as the recommended “GRAALPY-VFS”, the resources are not subject to the encapsulation rules and do not require additional module system configuration.</em></p>

<h4 id="external-directory"><a href="#external-directory" class="anchor-link">External Directory</a></h4>

<p>As an alternative to Java resources with the Virtual Filesystem, it is also possible to configure the Maven or Gradle plugin to manage the contents of an external directory, which will <strong>not be embedded</strong> as a Java resource into the resulting application.
A user is then responsible for the deployment of such directory.
Python code will access the files directly from the real filesystem.</p>

<p>Use the following <a href="https://github.com/oracle/graalpython/blob/master/graalpython/org.graalvm.python.embedding/src/org/graalvm/python/embedding/utils/GraalPyResources.java">GraalPyResources</a> factory methods to create GraalPy Context preconfigured for the use of an external directory:</p>
<ul>
  <li><code>GraalPyResources.createContextBuilder(Path)</code></li>
</ul>

<h3 id="conventions"><a href="#conventions" class="anchor-link">Conventions</a></h3>

<p>The factory methods in <a href="https://github.com/oracle/graalpython/blob/master/graalpython/org.graalvm.python.embedding/src/org/graalvm/python/embedding/utils/GraalPyResources.java">GraalPyResources</a> rely on the following conventions, where the <code>${root}</code> is either an external directory, or a Virtual System mount point on the Python side and Java resources directories, such as <code>${project_resources_directory}/org.graalvm.python.vfs</code>, on the real filesystem:</p>
<ul>
  <li><code>${root}/src</code>: used for Python application files. This directory will be configured as the default search path for Python module files (equivalent to <code>PYTHONPATH</code> environment variable).</li>
  <li><code>${root}/venv</code>: used for the Python virtual environment holding installed third-party Python packages.
The Context will be configured as if it is executed from this virtual environment. Notably packages installed in this
virtual environment will be automatically available for importing.</li>
</ul>

<p>The Maven or Gradle plugin will fully manage the contents of the <code>venv</code> subdirectory.
Any manual change will be overridden by the plugin during the build.</p>
<ul>
  <li><code>${root}/venv</code>: the plugin creates a virtual environment and installs required packages according to the plugin configuration in <em>pom.xml</em> or <em>build.gradle</em>.</li>
</ul>

<p>The <em>src</em> subdirectory is left to be manually populated by the user with custom Python scripts or modules.</p>

<p>To manage third-party Python packages, a <a href="https://docs.python.org/3.11/tutorial/venv.html">Python virtual environment</a> is used behind the scenes.
Whether deployed in a virtual filesystem or an external directory, its contents are managed by the plugin based on the Python packages
specified in the plugin configuration.</p>

<h3 id="python-dependency-management"><a href="#python-dependency-management" class="anchor-link">Python Dependency Management</a></h3>

<p>The list of third-party Python packages to be downloaded and installed can be specified in Maven or Gradle plugin configuration. Unfortunately,
Python does not enforce strict versioning of dependencies, which can result in problems if a third-party package or one of its transitive
dependencies is unexpectedly updated to a newer version, leading to unforeseen behavior.</p>

<p>It is regarded as good practice to always specify a Python package with its exact version. In simpler scenarios, where only a few packages 
are required, specifying the exact version of each package in the plugin configuration, 
along with their transitive dependencies, might be sufficient. However, this method is often impractical,
as manually managing the entire dependency tree can quickly become overwhelming.</p>

<h4 id="locking-dependencies"><a href="#locking-dependencies" class="anchor-link">Locking Dependencies</a></h4>

<p>For these cases, we <strong>highly recommend locking</strong> all Python dependencies whenever there is a change 
in the list of required packages for a project. The GraalPy plugins provide an action to do so, 
and as a result, a GraalPy lock file will be created, listing all required Python packages with their specific versions 
based on the packages defined in the plugin configuration and their dependencies. Subsequent GraalPy plugin executions 
will then use this file exclusively to install all packages with guaranteed versions.</p>

<p>The default location of the lock file is in the project root, and since it serves as input for generating resources, 
it should be stored alongside other project files in a version control system.</p>

<p>For information on the specific Maven or Gradle lock packages actions, please refer to the plugin descriptions below in this document.</p>

<h3 id="graalpy-maven-plugin"><a href="#graalpy-maven-plugin" class="anchor-link">GraalPy Maven Plugin</a></h3>

<h4 id="maven-plugin-configuration"><a href="#maven-plugin-configuration" class="anchor-link">Maven Plugin Configuration</a></h4>

<p>Add the plugin configuration in the <code>configuration</code> block of <code>graalpy-maven-plugin</code> in the <em>pom.xml</em> file:</p>
<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;plugin&gt;</span>
    <span class="nt">&lt;groupId&gt;</span>org.graalvm.python<span class="nt">&lt;/groupId&gt;</span>
    <span class="nt">&lt;artifactId&gt;</span>graalpy-maven-plugin<span class="nt">&lt;/artifactId&gt;</span>
    ...
    <span class="nt">&lt;configuration&gt;</span>
        ...
    <span class="nt">&lt;/configuration&gt;</span>
    ...
<span class="nt">&lt;/plugin&gt;</span>
</code></pre></div></div>
<ul>
  <li>The <strong>packages</strong> element declares a list of third-party Python packages to be downloaded and installed by the plugin.
The Python packages and their versions are specified as if used with <code>pip</code>:
    <div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;configuration&gt;</span>
    <span class="nt">&lt;packages&gt;</span>
        <span class="nt">&lt;package&gt;</span>termcolor==2.2<span class="nt">&lt;/package&gt;</span>
        ...
    <span class="nt">&lt;/packages&gt;</span>
    ...
<span class="nt">&lt;/configuration&gt;</span>
</code></pre></div>    </div>
  </li>
  <li>The <strong>graalPyLockFile</strong> element can specify an alternative path to a GraalPy lock file. 
Default value is <code>${basedir}/graalpy.lock</code>.
    <div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;configuration&gt;</span>
    <span class="nt">&lt;graalPyLockFile&gt;</span>${basedir}/graalpy.lock<span class="nt">&lt;/graalPyLockFile&gt;</span>
    ...
<span class="nt">&lt;/configuration&gt;</span>
</code></pre></div>    </div>
  </li>
  <li>The <strong>resourceDirectory</strong> element can specify the relative <a href="#java-resource-path">Java resource path</a>.
Remember to use <code>VirtualFileSystem$Builder#resourceDirectory</code> when configuring the <code>VirtualFileSystem</code> in Java.
    <div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;resourceDirectory&gt;</span>GRAALPY-VFS/${project.groupId}/${project.artifactId}<span class="nt">&lt;/resourceDirectory&gt;</span>
</code></pre></div>    </div>
  </li>
  <li>If the <strong>externalDirectory</strong> element is specified, then the given directory is used as an <a href="#external-directory">external directory</a> and no Java resources are embedded.
Remember to use the appropriate <code>GraalPyResources</code> API to create the Context. This element and <strong>resourceDirectory</strong> are mutually exclusive.
    <div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;configuration&gt;</span>
    <span class="nt">&lt;externalDirectory&gt;</span>${basedir}/python-resources<span class="nt">&lt;/externalDirectory&gt;</span>
    ...
<span class="nt">&lt;/configuration&gt;</span>
</code></pre></div>    </div>
  </li>
</ul>

<h4 id="locking-python-packages"><a href="#locking-python-packages" class="anchor-link">Locking Python Packages</a></h4>
<p>To lock the dependency tree of the specified Python packages, execute the GraalPy plugin goal <code>org.graalvm.python:graalpy-maven-plugin:lock-packages</code>.</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>mvn org.graalvm.python:graalpy-maven-plugin:lock-packages
</code></pre></div></div>
<p><em>Note that the action will override the existing lock file.</em></p>

<p>For more information on managing Python packages, please refer to the descriptions of 
the <code>graalPyLockFile</code> and <code>packages</code> fields in the <a href="#maven-plugin-configuration">plugin configuration</a>, as well as the <a href="#python-dependency-management">Python Dependency Management</a> section 
above in this document.</p>

<h3 id="graalpy-gradle-plugin"><a href="#graalpy-gradle-plugin" class="anchor-link">GraalPy Gradle Plugin</a></h3>

<h4 id="gradle-plugin-configuration"><a href="#gradle-plugin-configuration" class="anchor-link">Gradle Plugin Configuration</a></h4>
<p>The plugin must be added to the plugins section in the <em>build.gradle</em> file.
The <strong>version</strong> property defines which version of GraalPy to use.</p>
<div class="language-groovy highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">plugins</span> <span class="o">{</span>
    <span class="c1">// other plugins ...</span>
    <span class="n">id</span> <span class="s1">'org.graalvm.python'</span> <span class="n">version</span> <span class="s1">'24.2.0'</span>
<span class="o">}</span>
</code></pre></div></div>

<p>The plugin automatically injects these dependencies of the same version as the plugin version:</p>
<ul>
  <li><code>org.graalvm.python:python</code></li>
  <li><code>org.graalvm.python:python-embedding</code></li>
</ul>

<p>The plugin can be configured in the <code>graalPy</code> block:</p>

<ul>
  <li>The <strong>packages</strong> element declares a list of third-party Python packages to be downloaded and installed by the plugin.
The Python packages and their versions are specified as if used with <code>pip</code>.
    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>graalPy <span class="o">{</span>
  packages <span class="o">=</span> <span class="o">[</span><span class="s2">"termcolor==2.2"</span><span class="o">]</span>
  ...
<span class="o">}</span>
</code></pre></div>    </div>
  </li>
  <li>The <strong>graalPyLockFile</strong> element can specify an alternative path to a GraalPy lock file.
Default value is <code>$rootDir/graalpy.lock</code>.
    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>graalPy <span class="o">{</span>
  graalPyLockFile <span class="o">=</span> file<span class="o">(</span><span class="s2">"</span><span class="nv">$rootDir</span><span class="s2">/graalpy.lock"</span><span class="o">)</span>
  ...
<span class="o">}</span>
</code></pre></div>    </div>
  </li>
  <li>The <strong>resourceDirectory</strong> element can specify the relative <a href="#java-resource-path">Java resource path</a>.
Remember to use <code>VirtualFileSystem$Builder#resourceDirectory</code> when configuring the <code>VirtualFileSystem</code> in Java.
    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>resourceDirectory <span class="o">=</span> <span class="s2">"GRAALPY-VFS/my.group.id/artifact.id"</span>
</code></pre></div>    </div>
  </li>
  <li>If the <strong>externalDirectory</strong> element is specified, then the given directory is used as an <a href="#external-directory">external directory</a> and no Java resources are embedded.
Remember to use the appropriate <code>GraalPyResources</code> API to create the Context.
    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>graalPy <span class="o">{</span>
  externalDirectory <span class="o">=</span> file<span class="o">(</span><span class="s2">"</span><span class="nv">$rootDir</span><span class="s2">/python-resources"</span><span class="o">)</span>
  ...
<span class="o">}</span>
</code></pre></div>    </div>
  </li>
  <li>Boolean flag <strong>community</strong> switches the automatically injected
dependency <code>org.graalvm.python:python</code> to the community build: <code>org.graalvm.python:python-community</code>.
    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>graalPy <span class="o">{</span>
  community <span class="o">=</span> <span class="nb">true</span>
  ...
<span class="o">}</span>
</code></pre></div>    </div>
    <h4 id="locking-python-packages-1"><a href="#locking-python-packages-1" class="anchor-link">Locking Python Packages</a></h4>
    <p>To lock the dependency tree of the specified Python packages, execute the GraalPy plugin task <code>graalPyLockPackages</code>.</p>
    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>gradle graalPyLockPackages
</code></pre></div>    </div>
    <p><em>Note that the action will override the existing lock file.</em></p>
  </li>
</ul>

<p>For more information on managing Python packages, please refer to the descriptions of
the <code>graalPyLockFile</code> and <code>packages</code> fields in the <a href="#gradle-plugin-configuration">plugin configuration</a>, as well as the <a href="#python-dependency-management">Python Dependency Management</a> sections
in this document.</p>

<h3 id="related-documentation"><a href="#related-documentation" class="anchor-link">Related Documentation</a></h3>

<ul>
  <li><a href="https://www.graalvm.org/reference-manual/embed-languages/">Embedding Graal languages in Java</a></li>
  <li><a href="#permissions-for-python-embeddings">Permissions for Python Embeddings</a></li>
</ul>

<h2 id="permissions-for-python-embeddings"><a href="#permissions-for-python-embeddings" class="anchor-link">Permissions for Python Embeddings</a></h2>

<h3 id="access-control-and-security-limits-for-python-scripts"><a href="#access-control-and-security-limits-for-python-scripts" class="anchor-link">Access Control and Security Limits for Python Scripts</a></h3>

<p>Embedding GraalPy into Java works with the <a href="https://www.graalvm.org/latest/reference-manual/embed-languages/#controlling-access-to-host-functions">GraalVM Polyglot Sandbox</a>.</p>

<h3 id="pythons-posix-interface"><a href="#pythons-posix-interface" class="anchor-link">Python</a>’s POSIX Interface</h3>

<p>The way the operating system interface is exposed to Python scripts is GraalPy-specific.
By default all access is routed through Java interfaces, but some packages rely on details of POSIX APIs and require direct native access.</p>

<p>Graal languages (those implemented on the <a href="https://www.graalvm.org/latest/graalvm-as-a-platform/language-implementation-framework/">Truffle framework</a>) usually implement system-related functions using the <a href="https://github.com/oracle/graal/blob/master/truffle/docs/README.md">Truffle abstraction layer</a>, which is OS independent and provides extension points for the users when embedding GraalPy or other Graal languages into Java applications.
See, for example, the <a href="https://www.graalvm.org/truffle/javadoc/org/graalvm/polyglot/io/FileSystem.html">Truffle FileSystem service-provider</a>.</p>

<p>The standard Python library also provides an OS abstraction, but exposes lower level interfaces. For example, the <code>os</code> module directly exposes some POSIX functions.
On non-POSIX platforms, this interface is emulated to a degree.</p>

<p>GraalPy provides two alternative implementations (each referred to as a “backend”) of system-related functionality offered by built-in Python modules such as <code>os</code>.
The <code>PosixModuleBackend</code> option determines which backend is used: valid values are <code>native</code> and <code>java</code>.</p>

<h4 id="native-backend"><a href="#native-backend" class="anchor-link">Native Backend</a></h4>

<p>This backend directly calls the POSIX API in mostly the same way as CPython (the reference Python implementation).</p>

<p>This approach is the most compatible with CPython and provides bare access to the underlying OS interface without an intermediate  emulation layer.</p>

<p>By default, this implementation bypasses the Truffle abstraction layer, and therefore it is not sandboxed and does not support custom implementations of <a href="https://www.graalvm.org/truffle/javadoc/org/graalvm/polyglot/io/FileSystem.html">Truffle FileSystem service-provider</a>, and other Polyglot API providers related to system interfaces.</p>

<p>The native backend is chosen by default when GraalPy is started via the <code>graalpy</code> or any other Python related launcher.</p>

<h5 id="limitations-of-the-native-backend"><a href="#limitations-of-the-native-backend" class="anchor-link">Limitations of the Native Backend</a></h5>

<p>Known limitations are:</p>

<ul>
  <li><code>os.fork</code> is not supported</li>
  <li><code>_posixsubprocess.fork_exec</code> does not support the <code>preexec_fn</code> parameter</li>
</ul>

<h4 id="java-backend"><a href="#java-backend" class="anchor-link">Java Backend</a></h4>

<p>This backend uses the <a href="https://github.com/oracle/graal/blob/master/truffle/docs/README.md">Truffle abstraction layer</a> and therefore supports custom Polyglot API providers related to system interfaces and sandboxing.
Because this abstraction is POSIX agnostic, it does not expose all the necessary functionality. Some functionality is emulated, and some functionality is unsupported.</p>

<p>The Java backend is the default when GraalPy is run via the <code>Context</code> API, that is, <a href="https://github.com/oracle/graal/blob/master/docs/reference-manual/embedding/embed-languages.md">embedded in Java applications</a>.</p>

<h5 id="limitations-of-the-java-backend"><a href="#limitations-of-the-java-backend" class="anchor-link">Limitations of the Java Backend</a></h5>

<p>GraalPy can log information about known incompatibility of functions executed at runtime, which includes the OS interface-related functions.
To turn on this logging, use the command-line option <code>--log.python.compatibility.level=FINE</code> (or other desired logging level).</p>

<p>Known limitations of the Java backend are:</p>

<ul>
  <li>Its state is disconnected from the actual OS state, which applies especially to:
    <ul>
      <li><em>file descriptors</em>: Python-level file descriptors are not usable in native code.</li>
      <li><em>current working directory</em>: is initialized to the current working
directory at the startup, but is then maintained separately. So, for example, <code>chdir</code> in Python
does not change the actual current working directory of the process.</li>
      <li><em>umask</em>: has the same limitation as that of the current working directory, but it is always initialized
to <code>0022</code> regardless of the actual system value at startup.</li>
    </ul>
  </li>
  <li>Resolution of file access/modification times depends on the JDK.
The best the Java backend can guarantee is seconds resolution.</li>
  <li><code>os.access</code> and any other functionality based on <code>faccessat</code> POSIX function does not support:
    <ul>
      <li>effective IDs.</li>
      <li><code>follow_symlinks=False</code> unless the mode is only <code>F_OK</code>.</li>
    </ul>
  </li>
</ul>

<h3 id="python-native-extensions"><a href="#python-native-extensions" class="anchor-link">Python Native Extensions</a></h3>

<p>Python native extensions run by default as native binaries, with full access to the underlying system.
See <a href="#embedding-limitations">Embedding limitations</a></p>

<p>The context permissions needed to run native extensions are:</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">.</span><span class="na">allowIO</span><span class="o">(</span><span class="nc">IOAccess</span><span class="o">.</span><span class="na">ALL</span><span class="o">)</span>
<span class="o">.</span><span class="na">allowCreateThread</span><span class="o">(</span><span class="kc">true</span><span class="o">)</span>
<span class="o">.</span><span class="na">allowNativeAccess</span><span class="o">(</span><span class="kc">true</span><span class="o">)</span>
</code></pre></div></div>

<h2 id="tooling-support-for-python"><a href="#tooling-support-for-python" class="anchor-link">Tooling Support for Python</a></h2>

<h3 id="debugging"><a href="#debugging" class="anchor-link">Debugging</a></h3>

<p>GraalPy provides the standard Python debugger <code>pdb</code>.
Refer to the official <a href="https://docs.python.org/3/library/pdb.html">PDB documentation</a> for usage.
The built-in <code>breakpoint()</code> function uses <code>pdb</code> by default.</p>

<p>GraalPy also comes with built-in support for graphical debugging through Chrome’s developer tools.
To enable the debugger, pass the <code>--inspect</code> command-line option.
You can inspect variables, set watch expressions, interactively evaluate code snippets, and so on.</p>

<ol>
  <li>Run a Python script using the command-line option <code>--inspect</code>:
    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code> graalpy <span class="nt">--inspect</span> my_script.py
</code></pre></div>    </div>
  </li>
  <li>You should see output similar to:
    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code> Debugger listening on ws://127.0.0.1:9229/VrhCaY7wR5tIqy2zLsdFr3f7ixY3QB6kVQ0S54_SOMo
 For <span class="nb">help</span>, see: https://www.graalvm.org/tools/chrome-debugger
 E.g. <span class="k">in </span>Chrome open: devtools://devtools/bundled/js_app.html?ws<span class="o">=</span>127.0.0.1:9229/VrhCaY7wR5tIqy2zLsdFr3f7ixY3QB6kVQ0S54_SOMo
</code></pre></div>    </div>
  </li>
  <li>
    <p>Open your Chrome browser and enter the URL provided. 
Now you can inspect the stack, variables, evaluate variables, and selected expressions in a tooltip, and so on. For example:</p>

    <p><img src="/python/assets/Chrome_Inspector.png" alt="Chrome Inspector" /></p>
  </li>
</ol>

<h3 id="profiling"><a href="#profiling" class="anchor-link">Profiling</a></h3>

<p>GraalPy provides three main profiling capabilities: a CPU sampler, a CPU tracer, and a memory tracer.
These are described below. (For details, use the <code>graalpy --help:tools</code> command.)</p>

<h3 id="cpu-sampler"><a href="#cpu-sampler" class="anchor-link">CPU Sampler</a></h3>

<p>Use the <code>--cpusampler</code> command-line option to take a CPU sample. For example:</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>graalpy <span class="nt">--cpusampler</span> my_script.py
</code></pre></div></div>

<p>You should see output similar to:</p>

<details>
  <summary>CPU Sampler Output (Click to expand)</summary>
  <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">--------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
Sampling Histogram. Recorded 564 samples with period 10ms. Missed 235 samples.
  Self Time: Time spent on the top of the stack.
  Total Time: Time spent somewhere on the stack.
<span class="nt">--------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
Thread[main,5,main]
 Name                                                                       <span class="o">||</span>             Total Time    <span class="o">||</span>              Self Time    <span class="o">||</span> Location            
<span class="nt">--------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
 parse_starttag                                                             <span class="o">||</span>             1090ms  19.3% <span class="o">||</span>              570ms  10.1% <span class="o">||</span> &lt;install-dir&gt;/lib/python3.10/html/parser.py~300-347:11658-13539
 match                                                                      <span class="o">||</span>              190ms   3.4% <span class="o">||</span>              190ms   3.4% <span class="o">||</span> &lt;venv-dir&gt;/lib/python3.10/site-packages/soupsieve/css_parser.py~320-323:9862-10026
 _replace_cdata_list_attribute_values                                       <span class="o">||</span>              190ms   3.4% <span class="o">||</span>              190ms   3.4% <span class="o">||</span> &lt;venv-dir&gt;/lib/python3.10/site-packages/bs4/builder/__init__.py~295-331:11245-13031
 goahead                                                                    <span class="o">||</span>             1430ms  25.4% <span class="o">||</span>              150ms   2.7% <span class="o">||</span> &lt;install-dir&gt;/lib/python3.10/html/parser.py~133-250:4711-9678
 check_for_whole_start_tag                                                  <span class="o">||</span>              130ms   2.3% <span class="o">||</span>              130ms   2.3% <span class="o">||</span> &lt;install-dir&gt;/lib/python3.10/html/parser.py~351-382:13647-14758
 &lt;module&gt;                                                                   <span class="o">||</span>              800ms  14.2% <span class="o">||</span>              130ms   2.3% <span class="o">||</span> &lt;venv-dir&gt;/lib/python3.10/site-packages/soupsieve/css_parser.py~1-1296:0-47061
 ...
<span class="nt">--------------------------------------------------------------------------------------------------------------------------------------------------------------</span>
</code></pre></div>  </div>
</details>

<h3 id="cpu-tracer"><a href="#cpu-tracer" class="anchor-link">CPU Tracer</a></h3>

<p>Use the <code>--cputracer --cputracer.TraceStatements</code> command-line options to trace CPU usage. For example:</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>graalpy <span class="nt">--cputracer</span> <span class="nt">--cputracer</span>.TraceStatements my_script.py
</code></pre></div></div>

<p>You should see output similar to:</p>

<details>
  <summary>CPU Tracer Output (Click to Expand)</summary>
  <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">--------------------------------------------------------------------------------------------------------------------</span>
Tracing Histogram. Counted a total of 1135 element executions.
  Total Count: Number of <span class="nb">times </span>the element was executed and percentage of total executions.
  Interpreted Count: Number of <span class="nb">times </span>the element was interpreted and percentage of total executions of this element.
  Compiled Count: Number of <span class="nb">times </span>the compiled element was executed and percentage of total executions of this element.
<span class="nt">--------------------------------------------------------------------------------------------------------------------</span>
 Name                                |          Total Count |    Interpreted Count |       Compiled Count | Location
<span class="nt">--------------------------------------------------------------------------------------------------------------------</span>
 get_newfunc_typeid                  |           110   9.7% |           110 100.0% |             0   0.0% | capi.c~596:0
 PyTruffle_PopulateType              |           110   9.7% |           110 100.0% |             0   0.0% | capi.c~721:0
 PyTruffle_AllocMemory               |            86   7.6% |            86 100.0% |             0   0.0% | obmalloc.c~77:0
 PyTruffle_AllocateType              |            66   5.8% |            66 100.0% |             0   0.0% | capi.c~874:0
 PyMem_RawMalloc                     |            66   5.8% |            66 100.0% |             0   0.0% | obmalloc.c~170:0
 initialize_type_structure           |            50   4.4% |            50 100.0% |             0   0.0% | capi.c~181:0
 _Py_TYPE                            |            45   4.0% |            45 100.0% |             0   0.0% | object_shared.c~55:0
 PyType_GetFlags                     |            41   3.6% |            41 100.0% |             0   0.0% | typeobject_shared.c~44:0
 get_tp_name                         |            37   3.3% |            37 100.0% |             0   0.0% | capi.c~507:0
 ...    
<span class="nt">--------------------------------------------------------------------------------------------------------------------</span>
</code></pre></div>  </div>
</details>

<h5 id="memory-tracer"><a href="#memory-tracer" class="anchor-link">Memory Tracer</a></h5>

<p>Use the <code>--memtracer --memtracer.TraceStatements</code> command-line options to trace memory usage. For example:</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>graalpy <span class="nt">--experimental-options</span> <span class="nt">--memtracer</span> <span class="nt">--memtracer</span>.TraceStatements my_script.py
</code></pre></div></div>

<p>You should see output similar to:</p>

<details>
  <summary>Memory Tracer Output (Click to Expand)</summary>
  <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">----------------------------------------------------------------------------</span>
 Location Histogram with Allocation Counts. Recorded a total of 565 allocations.
   Total Count: Number of allocations during the execution of this element.
   Self Count: Number of allocations <span class="k">in </span>this element alone <span class="o">(</span>excluding sub calls<span class="o">)</span><span class="nb">.</span>
<span class="nt">----------------------------------------------------------------------------</span>
 Name                         |      Self Count |     Total Count | Location
<span class="nt">----------------------------------------------------------------------------</span>
 PyTruffle_PopulateType       |      440  77.9% |      440  77.9% | capi.c~721:0
 PyType_Ready                 |       61  10.8% |       68  12.0% | typeobject.c~463:0
 _PyObject_MakeTpCall         |       20   3.5% |       24   4.2% | object.c~155:0
 PyUnicode_FromString         |       11   1.9% |       11   1.9% | capi.c~2161:0
 PyErr_NewException           |       11   1.9% |       11   1.9% | capi.c~1537:0
 _PyUnicode_AsASCIIString     |        6   1.1% |        6   1.1% | capi.c~2281:0
 PyDict_New                   |        4   0.7% |        4   0.7% | capi.c~1505:0
 PyTuple_New                  |        4   0.7% |        4   0.7% | capi.c~2097:0
 PyUnicode_FromStringAndSize  |        3   0.5% |        3   0.5% | unicodeobject.c~171:0
 ...
<span class="nt">----------------------------------------------------------------------------</span>
</code></pre></div>  </div>
</details>

<h3 id="coverage"><a href="#coverage" class="anchor-link">Coverage</a></h3>

<p>GraalPy provides its own implementation of the <a href="https://pypi.org/project/coverage/">Coverage.py tool</a> to measure code coverage of Python programs.
Enable it using the <code>--coverage</code> command-line option, as shown below.
(For details, use the <code>graalpy --help:tools</code> command.)</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>graalpy <span class="nt">--coverage</span> my_script.py
</code></pre></div></div>
<p>You should see output similar to:</p>

<details>
  <summary>CPU Sampler Output (Click to expand)</summary>
  <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">------------------------------------------------------------------------------------------------------------------------------------------------</span>
Code coverage histogram.
  Shows what percent of each element was covered during execution
<span class="nt">------------------------------------------------------------------------------------------------------------------------------------------------</span>
 Path                                                                          |  Statements |    Lines |    Roots
<span class="nt">------------------------------------------------------------------------------------------------------------------------------------------------</span>
 &lt;venv-dir&gt;/lib/python3.10/site-packages/_distutils_hack/__init__.py           |       0.00% |    0.00% |    0.00%
 &lt;venv-dir&gt;/lib/python3.10/site-packages/bs4/__init__.py                       |      56.10% |   56.14% |   55.26%
 &lt;venv-dir&gt;/lib/python3.10/site-packages/bs4/builder/__init__.py               |      79.12% |   78.84% |   50.00%
 &lt;venv-dir&gt;/lib/python3.10/site-packages/bs4/builder/_html5lib.py              |       2.41% |    2.46% |    2.38%
 &lt;venv-dir&gt;/lib/python3.10/site-packages/bs4/builder/_htmlparser.py            |      69.08% |   68.67% |   83.33%
 &lt;venv-dir&gt;/lib/python3.10/site-packages/bs4/builder/_lxml.py                  |       3.72% |    3.78% |    4.00%
 &lt;venv-dir&gt;/lib/python3.10/site-packages/bs4/css.py                            |      32.73% |   31.48% |   15.38%
 &lt;venv-dir&gt;/lib/python3.10/site-packages/bs4/dammit.py                         |      65.46% |   65.29% |   24.14%
 &lt;venv-dir&gt;/lib/python3.10/site-packages/bs4/element.py                        |      44.15% |   43.13% |   31.08%
 &lt;venv-dir&gt;/lib/python3.10/site-packages/bs4/formatter.py                      |      73.49% |   74.36% |   66.67%
 &lt;venv-dir&gt;/lib/python3.10/site-packages/certifi/__init__.py                   |     100.00% |  100.00% |  100.00%
 &lt;venv-dir&gt;/lib/python3.10/site-packages/certifi/core.py                       |      33.33% |   33.33% |   25.00%
 &lt;venv-dir&gt;/lib/python3.10/site-packages/charset_normalizer/__init__.py        |     100.00% |  100.00% |  100.00%
 &lt;venv-dir&gt;/lib/python3.10/site-packages/charset_normalizer/api.py             |      11.87% |   11.94% |   16.67%
 &lt;venv-dir&gt;/lib/python3.10/site-packages/charset_normalizer/assets/__init__.py |     100.00% |  100.00% |  100.00%
 &lt;venv-dir&gt;/lib/python3.10/site-packages/charset_normalizer/cd.py              |      12.81% |   13.54% |    4.35%
 &lt;venv-dir&gt;/lib/python3.10/site-packages/charset_normalizer/constant.py        |     100.00% |  100.00% |  100.00%
 &lt;venv-dir&gt;/lib/python3.10/site-packages/charset_normalizer/legacy.py          |      25.00% |   25.00% |   50.00%
 &lt;venv-dir&gt;/lib/python3.10/site-packages/charset_normalizer/md.py              |      22.05% |   20.37% |   17.24%
 &lt;venv-dir&gt;/lib/python3.10/site-packages/charset_normalizer/models.py          |      38.46% |   38.50% |    9.30%
 &lt;venv-dir&gt;/lib/python3.10/site-packages/charset_normalizer/utils.py           |      26.79% |   26.89% |    3.33%
 &lt;venv-dir&gt;/lib/python3.10/site-packages/charset_normalizer/version.py         |     100.00% |  100.00% |  100.00%
 &lt;venv-dir&gt;/lib/python3.10/site-packages/idna/__init__.py                      |     100.00% |  100.00% |  100.00%
 &lt;install-dir&gt;/lib/python3.10/collections/abc.py                               |     100.00% |  100.00% |  100.00%
 &lt;install-dir&gt;/lib/python3.10/contextlib.py                                    |      40.80% |   37.99% |   31.71%
 &lt;install-dir&gt;/lib/python3.10/copy.py                                          |      36.36% |   36.41% |   21.43%
 &lt;install-dir&gt;/lib/python3.10/copyreg.py                                       |       3.20% |    3.20% |    7.69%
 &lt;install-dir&gt;/lib/python3.10/csv.py                                           |      25.17% |   23.91% |   25.00%
 &lt;install-dir&gt;/lib/python3.10/datetime.py                                      |      30.32% |   30.01% |   14.74%
 &lt;install-dir&gt;/lib/python3.10/email/__init__.py                                |      42.86% |   42.86% |   20.00%
 &lt;install-dir&gt;/lib/python3.10/email/_encoded_words.py                          |      35.11% |   34.44% |   14.29%
 &lt;install-dir&gt;/lib/python3.10/email/_parseaddr.py                              |      12.64% |   12.15% |   10.71%
 &lt;install-dir&gt;/lib/python3.10/email/_policybase.py                             |      55.22% |   54.69% |   39.29%
 &lt;install-dir&gt;/lib/python3.10/email/base64mime.py                              |      35.00% |   35.00% |   20.00%
 &lt;install-dir&gt;/lib/python3.10/typing.py                                        |      49.86% |   48.93% |   34.60%
 &lt;install-dir&gt;/lib/python3.10/urllib/__init__.py                               |     100.00% |  100.00% |  100.00%
 &lt;install-dir&gt;/lib/python3.10/warnings.py                                      |      21.29% |   20.77% |   25.00%
 &lt;install-dir&gt;/lib/python3.10/weakref.py                                       |      37.93% |   36.78% |   23.68%
 &lt;install-dir&gt;/lib/python3.10/zipfile.py                                       |      17.86% |   17.23% |   11.03%
 &lt;src-dir&gt;/my_script.py                                                        |     100.00% |  100.00% |  100.00%
<span class="nt">------------------------------------------------------------------------------------------------------------------------------------------------</span>
</code></pre></div>  </div>
</details>

<h3 id="trace"><a href="#trace" class="anchor-link">Trace</a></h3>

<p>The standard Python <code>trace</code> module is also provided.</p>
<blockquote>
  <p>Note: This works in the same way as CPython.
The programmatic API also works, with some limitations: it does not currently track calls, only line counts and called functions.</p>
</blockquote>

<p>For example, running this command:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>graalpy <span class="nt">-m</span> trace <span class="nt">-c</span> <span class="nt">-s</span> text_styler.py Welcome to GraalPy!
</code></pre></div></div>

<p>You should see output similar to:</p>

<details>
  <summary>CPU Tracer Output (Click to Expand)</summary>
  <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>_       __     __                             __     
| |     / /__  / /________  ____ ___  ___     / /_____
| | /| / / _ <span class="se">\/</span> / ___/ __ <span class="se">\/</span> __ <span class="sb">`</span>__ <span class="se">\/</span> _ <span class="se">\ </span>  / __/ __ <span class="se">\</span>
| |/ |/ /  __/ / /__/ /_/ / / / / / /  __/  / /_/ /_/ /
|__/|__/<span class="se">\_</span>__/_/<span class="se">\_</span>__/<span class="se">\_</span>___/_/ /_/ /_/<span class="se">\_</span>__/   <span class="se">\_</span>_/<span class="se">\_</span>___/
                                                        
   ______                 ______        __
  / ____/________ _____ _/ / __ <span class="se">\_</span>_  __/ /
 / / __/ ___/ __ <span class="sb">`</span>/ __ <span class="sb">`</span>/ / /_/ / / / / /
/ /_/ / /  / /_/ / /_/ / / ____/ /_/ /_/ 
<span class="se">\_</span>___/_/   <span class="se">\_</span>_,_/<span class="se">\_</span>_,_/_/_/    <span class="se">\_</span>_, <span class="o">(</span>_<span class="o">)</span>  
                              /____/     
 
lines   cov%   module   <span class="o">(</span>path<span class="o">)</span>
    9   100%   __about__   <span class="o">(</span>&lt;venv-dir&gt;/lib/python3.10/site-packages/pkg_resources/_vendor/packaging/__about__.py<span class="o">)</span>
   51   100%   __future__   <span class="o">(</span>&lt;install-dir&gt;/lib/python3.10/__future__.py<span class="o">)</span>
    1   100%   __init__   <span class="o">(</span>&lt;venv-dir&gt;/lib/python3.10/site-packages/pyfiglet/fonts/__init__.py<span class="o">)</span>
   27   100%   _adapters   <span class="o">(</span>&lt;install-dir&gt;/lib/python3.10/importlib/_adapters.py<span class="o">)</span>
   25   100%   _common   <span class="o">(</span>&lt;install-dir&gt;/lib/python3.10/importlib/_common.py<span class="o">)</span>
   44   100%   _manylinux   <span class="o">(</span>&lt;venv-dir&gt;/lib/python3.10/site-packages/pkg_resources/_vendor/packaging/_manylinux.py<span class="o">)</span>
   20   100%   _musllinux   <span class="o">(</span>&lt;venv-dir&gt;/lib/python3.10/site-packages/pkg_resources/_vendor/packaging/_musllinux.py<span class="o">)</span>
   66   100%   _osx_support   <span class="o">(</span>&lt;install-dir&gt;/lib/python3.10/_osx_support.py<span class="o">)</span>
   43   100%   _parseaddr   <span class="o">(</span>&lt;install-dir&gt;/lib/python3.10/email/_parseaddr.py<span class="o">)</span>
   62   100%   _policybase   <span class="o">(</span>&lt;install-dir&gt;/lib/python3.10/email/_policybase.py<span class="o">)</span>
   20   100%   _structures   <span class="o">(</span>&lt;venv-dir&gt;/lib/python3.10/site-packages/pkg_resources/_vendor/packaging/_structures.py<span class="o">)</span>
  105   100%   abc   <span class="o">(</span>&lt;install-dir&gt;/lib/python3.10/importlib/abc.py<span class="o">)</span>
   18   100%   actions   <span class="o">(</span>&lt;venv-dir&gt;/lib/python3.10/site-packages/pkg_resources/_vendor/pyparsing/actions.py<span class="o">)</span>
   41   100%   appdirs   <span class="o">(</span>&lt;venv-dir&gt;/lib/python3.10/site-packages/pkg_resources/_vendor/appdirs.py<span class="o">)</span>
   59   100%   <span class="nb">base64</span>   <span class="o">(</span>&lt;install-dir&gt;/lib/python3.10/base64.py<span class="o">)</span>
   14   100%   base64mime   <span class="o">(</span>&lt;install-dir&gt;/lib/python3.10/email/base64mime.py<span class="o">)</span>
   11   100%   bisect   <span class="o">(</span>&lt;install-dir&gt;/lib/python3.10/bisect.py<span class="o">)</span>
  124   100%   calendar   <span class="o">(</span>&lt;install-dir&gt;/lib/python3.10/calendar.py<span class="o">)</span>
   94   100%   charset   <span class="o">(</span>&lt;install-dir&gt;/lib/python3.10/email/charset.py<span class="o">)</span>
  122   100%   common   <span class="o">(</span>&lt;venv-dir&gt;/lib/python3.10/site-packages/pkg_resources/_vendor/pyparsing/common.py<span class="o">)</span>
   40   100%   context   <span class="o">(</span>&lt;venv-dir&gt;/lib/python3.10/site-packages/pkg_resources/_vendor/jaraco/context.py<span class="o">)</span>
    3   100%   contextlib   <span class="o">(</span>&lt;install-dir&gt;/lib/python3.10/contextlib.py<span class="o">)</span>
   91   100%   copy   <span class="o">(</span>&lt;install-dir&gt;/lib/python3.10/copy.py<span class="o">)</span>
 1497   100%   core   <span class="o">(</span>&lt;venv-dir&gt;/lib/python3.10/site-packages/pkg_resources/_vendor/pyparsing/core.py<span class="o">)</span>
  108   100%   dataclasses   <span class="o">(</span>&lt;install-dir&gt;/lib/python3.10/dataclasses.py<span class="o">)</span>
   31   100%   datetime   <span class="o">(</span>&lt;install-dir&gt;/lib/python3.10/datetime.py<span class="o">)</span>
    9   100%   encoders   <span class="o">(</span>&lt;install-dir&gt;/lib/python3.10/email/encoders.py<span class="o">)</span>
 2493   100%   entities   <span class="o">(</span>&lt;install-dir&gt;/lib/python3.10/html/entities.py<span class="o">)</span>
   58   100%   errors   <span class="o">(</span>&lt;install-dir&gt;/lib/python3.10/email/errors.py<span class="o">)</span>
   49   100%   exceptions   <span class="o">(</span>&lt;venv-dir&gt;/lib/python3.10/site-packages/pkg_resources/_vendor/pyparsing/exceptions.py<span class="o">)</span>
    5   100%   expat   <span class="o">(</span>&lt;install-dir&gt;/lib/python3.10/xml/parsers/expat.py<span class="o">)</span>
   41   100%   feedparser   <span class="o">(</span>&lt;install-dir&gt;/lib/python3.10/email/feedparser.py<span class="o">)</span>
   45   100%   functools   <span class="o">(</span>&lt;venv-dir&gt;/lib/python3.10/site-packages/pkg_resources/_vendor/jaraco/functools.py<span class="o">)</span>
   69   100%   gettext   <span class="o">(</span>&lt;install-dir&gt;/lib/python3.10/gettext.py<span class="o">)</span>
   56   100%   header   <span class="o">(</span>&lt;install-dir&gt;/lib/python3.10/email/header.py<span class="o">)</span>
  162   100%   helpers   <span class="o">(</span>&lt;venv-dir&gt;/lib/python3.10/site-packages/pkg_resources/_vendor/pyparsing/helpers.py<span class="o">)</span>
    1   100%   inspect   <span class="o">(</span>&lt;install-dir&gt;/lib/python3.10/inspect.py<span class="o">)</span>
   47   100%   linecache   <span class="o">(</span>&lt;install-dir&gt;/lib/python3.10/linecache.py<span class="o">)</span>
   95   100%   markers   <span class="o">(</span>&lt;venv-dir&gt;/lib/python3.10/site-packages/pkg_resources/_vendor/packaging/markers.py<span class="o">)</span>
  192   100%   more   <span class="o">(</span>&lt;venv-dir&gt;/lib/python3.10/site-packages/pkg_resources/_vendor/more_itertools/more.py<span class="o">)</span>
  204   100%   optparse   <span class="o">(</span>&lt;install-dir&gt;/lib/python3.10/optparse.py<span class="o">)</span>
   14   100%   os   <span class="o">(</span>&lt;install-dir&gt;/lib/python3.10/os.py<span class="o">)</span>
  167   100%   parse   <span class="o">(</span>&lt;install-dir&gt;/lib/python3.10/urllib/parse.py<span class="o">)</span>
   19   100%   parser   <span class="o">(</span>&lt;install-dir&gt;/lib/python3.10/email/parser.py<span class="o">)</span>
  242   100%   pathlib   <span class="o">(</span>&lt;install-dir&gt;/lib/python3.10/pathlib.py<span class="o">)</span>
   66   100%   pkgutil   <span class="o">(</span>&lt;install-dir&gt;/lib/python3.10/pkgutil.py<span class="o">)</span>
  137   100%   platform   <span class="o">(</span>&lt;install-dir&gt;/lib/python3.10/platform.py<span class="o">)</span>
  102   100%   plistlib   <span class="o">(</span>&lt;install-dir&gt;/lib/python3.10/plistlib.py<span class="o">)</span>
   79   100%   pprint   <span class="o">(</span>&lt;install-dir&gt;/lib/python3.10/pprint.py<span class="o">)</span>
   54   100%   queue   <span class="o">(</span>&lt;install-dir&gt;/lib/python3.10/queue.py<span class="o">)</span>
   21   100%   quopri   <span class="o">(</span>&lt;install-dir&gt;/lib/python3.10/quopri.py<span class="o">)</span>
   32   100%   quoprimime   <span class="o">(</span>&lt;install-dir&gt;/lib/python3.10/email/quoprimime.py<span class="o">)</span>
  101   100%   random   <span class="o">(</span>&lt;install-dir&gt;/lib/python3.10/random.py<span class="o">)</span>
   43   100%   recipes   <span class="o">(</span>&lt;venv-dir&gt;/lib/python3.10/site-packages/pkg_resources/_vendor/more_itertools/recipes.py<span class="o">)</span>
   51   100%   requirements   <span class="o">(</span>&lt;venv-dir&gt;/lib/python3.10/site-packages/pkg_resources/_vendor/packaging/requirements.py<span class="o">)</span>
   46   100%   resources   <span class="o">(</span>&lt;install-dir&gt;/lib/python3.10/importlib/resources.py<span class="o">)</span>
  155   100%   results   <span class="o">(</span>&lt;venv-dir&gt;/lib/python3.10/site-packages/pkg_resources/_vendor/pyparsing/results.py<span class="o">)</span>
   79   100%   selectors   <span class="o">(</span>&lt;install-dir&gt;/lib/python3.10/selectors.py<span class="o">)</span>
   30   100%   signal   <span class="o">(</span>&lt;install-dir&gt;/lib/python3.10/signal.py<span class="o">)</span>
   94   100%   socket   <span class="o">(</span>&lt;install-dir&gt;/lib/python3.10/socket.py<span class="o">)</span>
  143   100%   specifiers   <span class="o">(</span>&lt;venv-dir&gt;/lib/python3.10/site-packages/pkg_resources/_vendor/packaging/specifiers.py<span class="o">)</span>
   50   100%   string   <span class="o">(</span>&lt;install-dir&gt;/lib/python3.10/string.py<span class="o">)</span>
  118   100%   subprocess   <span class="o">(</span>&lt;install-dir&gt;/lib/python3.10/subprocess.py<span class="o">)</span>
   96   100%   sysconfig   <span class="o">(</span>&lt;install-dir&gt;/lib/python3.10/sysconfig.py<span class="o">)</span>
   67   100%   tags   <span class="o">(</span>&lt;venv-dir&gt;/lib/python3.10/site-packages/pkg_resources/_vendor/packaging/tags.py<span class="o">)</span>
  119   100%   tempfile   <span class="o">(</span>&lt;install-dir&gt;/lib/python3.10/tempfile.py<span class="o">)</span>
   35   100%   testing   <span class="o">(</span>&lt;venv-dir&gt;/lib/python3.10/site-packages/pkg_resources/_vendor/pyparsing/testing.py<span class="o">)</span>
    7   100%   text_styler   <span class="o">(</span>&lt;src-dir&gt;/text_styler.py<span class="o">)</span>
   51   100%   textwrap   <span class="o">(</span>&lt;install-dir&gt;/lib/python3.10/textwrap.py<span class="o">)</span>
    2   100%   threading   <span class="o">(</span>&lt;install-dir&gt;/lib/python3.10/threading.py<span class="o">)</span>
   32   100%   tokenize   <span class="o">(</span>&lt;install-dir&gt;/lib/python3.10/tokenize.py<span class="o">)</span>
   43   100%   traceback   <span class="o">(</span>&lt;install-dir&gt;/lib/python3.10/traceback.py<span class="o">)</span>
  703   100%   typing   <span class="o">(</span>&lt;install-dir&gt;/lib/python3.10/typing.py<span class="o">)</span>
  238   100%   unicode   <span class="o">(</span>&lt;venv-dir&gt;/lib/python3.10/site-packages/pkg_resources/_vendor/pyparsing/unicode.py<span class="o">)</span>
   76   100%   util   <span class="o">(</span>&lt;venv-dir&gt;/lib/python3.10/site-packages/pkg_resources/_vendor/pyparsing/util.py<span class="o">)</span>
   20   100%   utils   <span class="o">(</span>&lt;venv-dir&gt;/lib/python3.10/site-packages/pkg_resources/_vendor/packaging/utils.py<span class="o">)</span>
    1   100%   version   <span class="o">(</span>&lt;venv-dir&gt;/lib/python3.10/site-packages/pyfiglet/version.py<span class="o">)</span>
   16   100%   warnings   <span class="o">(</span>&lt;install-dir&gt;/lib/python3.10/warnings.py<span class="o">)</span>
  127   100%   weakref   <span class="o">(</span>&lt;install-dir&gt;/lib/python3.10/weakref.py<span class="o">)</span>
  432   100%   zipfile   <span class="o">(</span>&lt;install-dir&gt;/lib/python3.10/zipfile.py<span class="o">)</span>
</code></pre></div>  </div>
</details>

<h3 id="using-pycharm-with-graalpy"><a href="#using-pycharm-with-graalpy" class="anchor-link">Using PyCharm with GraalPy</a></h3>

<p>You can use GraalPy in PyCharm to create a virtual environment, install packages, and develop and run your Python application.</p>

<ol>
  <li>
    <p>Install <code>graalpy</code>. (For more information, see <a href="#testing-python-applications-and-packages-on-graalpy">Installing GraalPy</a>.)</p>
  </li>
  <li>
    <p>Install PyCharm. (For more information, see <a href="https://www.jetbrains.com/help/pycharm/installation-guide.html">Install PyCharm</a>.)</p>
  </li>
  <li>
    <p>Create, or open, a Python project.
(For more information, see <a href="https://www.jetbrains.com/help/pycharm/creating-empty-project.html">Create a Python project</a>, or <a href="https://www.jetbrains.com/help/pycharm/open-projects.html">Open, reopen, and close projects</a>, respectively.)</p>
  </li>
  <li>
    <p>Create a new <code>venv</code> virtual environment for your Python project.
(For more information, see <a href="https://www.jetbrains.com/help/pycharm/creating-virtual-environment.html#python_create_virtual_env">Create a virtualenv environment</a>.)</p>
  </li>
  <li>
    <p>Install packages by following the PyCharm instructions.
(For more information, see <a href="https://www.jetbrains.com/help/pycharm/installing-uninstalling-and-upgrading-packages.html">Install, uninstall, and upgrade packages</a>.)</p>
  </li>
  <li>
    <p>Use the PyCharm menu items to <a href="https://www.jetbrains.com/help/pycharm/running-applications.html">run your Python application</a>. 
Alternatively, use the terminal emulator to run the <code>graalpy</code> command.</p>
  </li>
</ol>

<h3 id="using-visual-studio-code-with-graalpy"><a href="#using-visual-studio-code-with-graalpy" class="anchor-link">Using Visual Studio Code with GraalPy</a></h3>

<p>You can use GraalPy in Visual Studio (VS) Code to create a virtual environment, install packages, and develop and run your Python application.</p>

<ol>
  <li>
    <p>Install <code>graalpy</code>. (For more information, see <a href="#testing-python-applications-and-packages-on-graalpy">Installing GraalPy</a>.)</p>
  </li>
  <li>
    <p>Install VS Code and the Python Extension, following the instructions here: <a href="https://code.visualstudio.com/docs/python/python-tutorial#_prerequisites">Install Visual Studio Code and the Python Extension</a>.</p>
  </li>
  <li>
    <p>Create, or open, a Python file.</p>
  </li>
  <li>
    <p>Create a new <em>venv</em> virtual environment for your Python project.
(For more information, see <a href="https://code.visualstudio.com/docs/python/environments#_creating-environments">Creating environments</a>.)</p>
  </li>
  <li>
    <p>Install packages by following the VS Code instructions.
(For more information, see <a href="https://code.visualstudio.com/docs/python/python-tutorial#_install-and-use-packages">Install and use packages</a>.)</p>
  </li>
  <li>
    <p>Use the VS Code menu items to run your Python application. (For more information, see <a href="https://code.visualstudio.com/docs/python/python-tutorial#_run-python-code">Run Hello World</a>.)
Alternatively, use a VS Code terminal emulator to run the <code>graalpy</code> command.</p>
  </li>
  <li>
    <p>You cannot use VS Code to debug your Python application.
Instead, open a VS Code terminal emulator and follow these instructions: <a href="#debugging">Debugging a Python Application</a>.</p>
  </li>
</ol>


      </div>
      <div role="button" class="menu-btn menu-btn--sidebar js-show-sidebar" title="sweet hamburger">
        <div class="hamburger">
          <div class="inner"></div>
        </div>
      </div>
    </div>
  </div>
</article>

<script>
  document.addEventListener("DOMContentLoaded", function() {
      var tocContainer = document.querySelector('.toc');
      var contentWrapper = document.querySelector('#content-wrapper');

      if (tocContainer && contentWrapper) {
          var headings = contentWrapper.querySelectorAll('h1, h2, h3');

          if (headings.length > 0) {
              var ul = document.createElement('ul');

              headings.forEach(function (heading) {
                  var li = document.createElement('li');
                  var a = document.createElement('a');
                  a.href = '#' + heading.id;
                  a.textContent = heading.textContent;

                  li.classList.add(heading.tagName.toLowerCase());

                  li.style.listStyleType = 'none';

                  li.appendChild(a);
                  ul.appendChild(li);
              });

              tocContainer.appendChild(ul);
          } else {
              tocContainer.innerHTML = '<p>No table of contents available.</p>';
          }
      }
  });
</script>
    </main>
    <footer class="footer footer__mobile">
  <div class="container">
    <div class="row footer-content">
      <div class="footer__logo">
        <div class="rubber-footer">
          <img src='/python/assets/logo.svg' alt="project logo">
        </div>
      </div>
      <div class="footer__columns">
        <div class="footer__columns-item">
          <h6 class="title-footer">Open Source</h6>
          <ul class="footer-list">
            <li class="footer-list__item"><a target="_blank" href="https://github.com/oracle/graalpython">Project Repository</a></li>
            <li class="footer-list__item"><a target="_blank" href="https://github.com/graalvm/graal-languages-demos/">Demos and Guides</a></li>
            <li class="footer-list__item"><a target="_blank" href="https://github.com/oracle/graalpython/blob/master/CONTRIBUTING.md">Contributing</a></li>
          </ul>
        </div>
        <div class="footer__columns-item">
          <h6 class="title-footer">Help</h6>
          <ul class="footer-list">
            <li class="footer-list__item"><a target="_blank" href="https://github.com/oracle/graalpython/issues">File an issue</a></li>
            <li class="footer-list__item"><a target="_blank" href="https://www.graalvm.org/slack-invitation/">GraalVM Slack</a></li>
            <li class="footer-list__item"><a target="_blank" href="https://github.com/oracle/graalpython/blob/master/LICENSE.txt">License</a></li>
          </ul>
        </div>
      </div>
    </div>
    <div class="col-12 col-sm-12 col-md-12 col-lg-12">
      <div class="row">
        <div class="col-sm-12">
          <p class="copyright">
            Copyright © 2025. All rights reserved.
        </div>
      </div>
    </div>
  </div>
</footer>

    <script src='/python/assets/js/main.js'></script>
    <script src='/python/assets/js/sidebar.js'></script>
  </body>
</html>
